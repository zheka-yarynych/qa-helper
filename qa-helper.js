// ==UserScript==
// @name         QA Helper
// @namespace    https://github.com/zheka-yarynych/qa-helper
// @version      0.12.0
// @description  QA Report Helper
// @author       zheka-yarynych
// @match        https://cdportal-qa-codebase-php82.gdm4qapub.link/admin_panel/reports/aggregated/*
// @match        https://cdportal-qa-codebase-php82.gdm4qapub.link/admin_panel/reports/smartlink/*
// @match        https://cldportal-us-east-1-prod-rel-1.cdtbox.rocks/admin_panel/reports/aggregated/*
// @match        https://cldportal-us-east-1-prod-rel-1.cdtbox.rocks/admin_panel/reports/smartlink/*
// @match        http://mcd/admin_panel/reports/aggregated/*
// @match        http://mcd/admin_panel/reports/smartlink/*
// @match        https://partners.clickdealer.com/admin_panel/reports/aggregated/*
// @match        https://partners.clickdealer.com/admin_panel/reports/smartlink/*
// @updateURL    https://raw.githubusercontent.com/zheka-yarynych/qa-helper/main/qa-helper.js
// @downloadURL  https://raw.githubusercontent.com/zheka-yarynych/qa-helper/main/qa-helper.js
// @run-at       document-idle
// @grant        GM_addStyle
// @grant        GM_setClipboard
// @grant        GM_getValue
// @grant        GM_setValue
// ==/UserScript==

(()=>{var Qt=Object.defineProperty;var k=(e,t)=>()=>(e&&(t=e(e=0)),t);var tt=(e,t)=>{for(var a in t)Qt(e,a,{get:t[a],enumerable:!0})};var Q,Ee,le=k(()=>{Q="QA_RPT_LAST_PAYLOAD",Ee="QA_HELPER_LAYOUT"});function ie(e){l.lastPayload=e;try{e?localStorage.setItem(Q,JSON.stringify(e)):localStorage.removeItem(Q)}catch(t){console.warn("[QA Helper] Failed to persist data in localStorage",t)}}function ce(){try{let e=localStorage.getItem(Q);return e?JSON.parse(e):null}catch(e){return console.warn("[QA Helper] Failed to read data from localStorage",e),null}}function ot(){try{localStorage.removeItem(Q)}catch(e){console.warn("[QA Helper] Failed to clear localStorage",e)}l.lastPayload=null}var l,M=k(()=>{le();l={lastPayload:null,lastRequestInfo:null,lastDropdownRequest:null,displayMode:"json",isLoadingAll:!1,cancelLoadingAll:!1,columnsFilterConfig:null,compareTableData:[],compareDropdownData:[],compareSelectedColumn:"",compareShowOnlyDiff:!1,compareFilterText:"",tabsRegistry:new Map,tabsOrder:[]}});function de(e,t,a={}){if(!e||!t)return;let o,r,n,s,c,i,u=!1,d=a.onMove||(()=>{}),p=a.onEnd||(()=>{});t.addEventListener("mousedown",m=>{if(m.button!==0||m.target?.closest(".qa-window-controls"))return;u=!0;let b=e.getBoundingClientRect();o=m.clientX,r=m.clientY,n=b.top,s=b.left,c=Math.max(6,window.innerWidth-b.width-6),i=Math.max(6,window.innerHeight-b.height-6),e.style.transform="none",e.style.left=`${b.left}px`,e.style.top=`${b.top}px`,e.style.right="",e.style.transition="none",m.preventDefault()}),window.addEventListener("mousemove",m=>{if(!u)return;let b=m.clientX-o,x=m.clientY-r,g=Math.max(6,Math.min(i,n+x)),h=Math.max(6,Math.min(c,s+b));e.style.top=`${g}px`,e.style.left=`${h}px`,d({top:g,left:h})}),window.addEventListener("mouseup",()=>{if(!u)return;u=!1,e.style.transition="";let m=parseFloat(e.style.top||"0"),b=parseFloat(e.style.left||"0");p({top:m,left:b})})}var ze=k(()=>{});function V(){return Array.isArray(l.tabsOrder)||(l.tabsOrder=[]),l.tabsOrder}function Vt(){let e=Array.from(document.querySelectorAll(".qa-tab")),t=V(),a=new Map(e.map(r=>[r.dataset.elementId,r])),o=[];return t.forEach(r=>{a.get(r)&&(o.push(r),a.delete(r))}),a.forEach((r,n)=>{o.push(n)}),l.tabsOrder=o,o}function Le(e){let t=V();l.tabsOrder=t.filter(a=>a!==e)}function nt(e,t={}){let o=V().filter(r=>r!==e);t.insertAtStart?o.unshift(e):o.push(e),l.tabsOrder=o}function Gt(){return Vt().map(t=>document.querySelector(`.qa-tab[data-element-id="${t}"]`)).filter(Boolean)}function U(){let e=Gt();if(!e.length)return;let t=ue;e.forEach((a,o)=>{let n=a.getBoundingClientRect().height||a.offsetHeight||lt;if(a.dataset.qaDragging==="1"){o===0?t=ue+n+pe:t+=n+pe;return}o===0?(a.style.top=`${ue}px`,t=ue+n+pe):(a.style.top=`${t}px`,t+=n+pe),a.style.transition=""})}function Xt(e,t){let a=V().filter(r=>r!==t);if(!a.length)return 0;let o=0;return a.forEach(r=>{let n=document.querySelector(`.qa-tab[data-element-id="${r}"]`);if(!n)return;let s=n.getBoundingClientRect(),c=s.top+s.height/2;e>c&&(o+=1)}),o}function Kt(){if(!y)return;let{tab:e,elementId:t,hasMoved:a}=y,o=y.lastClientY??y.startClientY,r=Xt(o,t),n=V().filter(s=>s!==t);n.splice(r,0,t),l.tabsOrder=n,delete e.dataset.qaDragging,a&&(e.dataset.qaJustDragged="1"),e.classList.remove("qa-tab--dragging"),e.style.transition="",e.style.top="",y=null,U(),a&&requestAnimationFrame(()=>{delete e.dataset.qaJustDragged})}function Zt(e){if(!y)return;y.lastClientY=e.clientY,y.hasMoved||Math.abs(y.startClientY-e.clientY)>2&&(y.hasMoved=!0);let t=e.clientY-y.offsetY,a=Math.max(rt,window.innerHeight-y.height-Ut),o=Math.max(rt,Math.min(a,t));y.tab.style.top=`${o}px`}function st(e){!e||e.dataset.qaDragInit==="1"||(e.dataset.qaDragInit="1",e.addEventListener("mousedown",t=>{if(t.button!==0||t.target?.closest(".qa-tab-close"))return;y=null;let a=e.getBoundingClientRect();y={tab:e,elementId:e.dataset.elementId,offsetY:t.clientY-a.top,height:a.height||lt,startClientY:t.clientY,lastClientY:t.clientY,hasMoved:!1},e.dataset.qaDragging="1",e.classList.add("qa-tab--dragging"),e.style.transition="none",e.style.top=`${a.top}px`,t.preventDefault()}))}function C(e,t,a,o={}){let r=document.getElementById(e);if(!r)return;let n=l.tabsRegistry.get(e),s=o.insertAtStart===!0;if(n&&n.tabEl){if(n.tabEl.isConnected){s&&(nt(e,{insertAtStart:!0}),U()),st(n.tabEl),n.tabEl.classList.remove("qa-tab-pulse"),requestAnimationFrame(()=>{n.tabEl.classList.add("qa-tab-pulse")}),n.tabEl.addEventListener("animationend",()=>n.tabEl.classList.remove("qa-tab-pulse"),{once:!0});return}l.tabsRegistry.delete(e),Le(e)}let c=r.getBoundingClientRect();r.dataset.qaSavedTop=r.style.top||`${c.top}px`,r.dataset.qaSavedRight=r.style.right||"",r.dataset.qaSavedLeft=r.style.left||"",r.classList.remove("qa-modal-visible"),r.style.display="none";let i=document.createElement("div");i.className="qa-tab",i.dataset.elementId=e;let u=document.createElement("span");u.className="label",u.textContent=t;let d=document.createElement("button");d.type="button",d.className="qa-tab-close",d.setAttribute("aria-label","Close tab"),d.textContent="\u2715",i.append(u,d),document.body.appendChild(i),nt(e,{insertAtStart:s}),st(i),U();let p=()=>{r.dataset.qaSavedTop&&(r.style.top=r.dataset.qaSavedTop),r.dataset.qaSavedRight?r.style.right=r.dataset.qaSavedRight:r.style.right="",r.dataset.qaSavedLeft?r.style.left=r.dataset.qaSavedLeft:r.style.left="",r.style.display="",i.remove(),l.tabsRegistry.delete(e),Le(e),U(),typeof a=="function"&&a()};i.addEventListener("click",()=>{i.dataset.qaDragging!=="1"&&i.dataset.qaJustDragged!=="1"&&p()}),d.addEventListener("click",m=>{m.stopPropagation(),i.remove(),l.tabsRegistry.delete(e),delete r.dataset.qaSavedTop,delete r.dataset.qaSavedRight,delete r.dataset.qaSavedLeft,r.classList.remove("qa-modal-visible"),r.style.display="none",Le(e),U(),typeof o.onClose=="function"&&o.onClose()}),l.tabsRegistry.set(e,{tabEl:i,restore:p})}function v(e){let t=l.tabsRegistry.get(e);t&&t.restore()}var pe,ue,lt,rt,Ut,y,_=k(()=>{M();pe=12,ue=0,lt=88,rt=6,Ut=6,y=null;window.addEventListener("mousemove",e=>{y&&Zt(e)});window.addEventListener("mouseup",e=>{y&&(y.lastClientY=e.clientY,Kt())})});function ea(e){if(!e)return[];let t=[{position:"n",cursor:"ns-resize"},{position:"s",cursor:"ns-resize"},{position:"e",cursor:"ew-resize"},{position:"w",cursor:"ew-resize"},{position:"ne",cursor:"nesw-resize"},{position:"nw",cursor:"nwse-resize"},{position:"se",cursor:"nwse-resize"},{position:"sw",cursor:"nesw-resize"}],a=[];for(let{position:o,cursor:r}of t){let n=document.createElement("div");n.className=`qa-resize-handle resize-${o}`,n.style.cursor=r,n.dataset.position=o,e.appendChild(n),a.push(n)}return a}function it(e,t={}){if(!e)return;let{minWidth:a=520,minHeight:o=320,maxWidth:r=()=>window.innerWidth-40,maxHeight:n=()=>window.innerHeight-40,onResize:s=()=>{},onEnd:c=()=>{}}=t,i=!1,u=0,d=0,p=0,m=0,b=0,x=0,g=null,h="";ea(e).forEach(q=>{q.addEventListener("mousedown",w=>{w.button===0&&(w.preventDefault(),w.stopPropagation(),g=e.getBoundingClientRect(),i=!0,u=w.clientX,d=w.clientY,p=g.width,m=g.height,b=g.top,x=g.left,h=q.dataset.position||"",document.body.style.userSelect="none",document.body.style.cursor=q.style.cursor)})}),window.addEventListener("mousemove",q=>{if(!i)return;let w=q.clientX-u,Y=q.clientY-d,ae=typeof r=="function"?r({startRect:g,container:e}):r,et=typeof n=="function"?n({startRect:g,container:e}):n,oe=p,re=m,ne=b,se=x;if(h.includes("e")&&(oe=Math.min(Math.max(p+w,a),ae)),h.includes("w")){let B=p-w;B>=a&&B<=ae&&(oe=B,se=x+w)}if(h.includes("s")&&(re=Math.min(Math.max(m+Y,o),et)),h.includes("n")){let B=m-Y;B>=o&&B<=et&&(re=B,ne=b+Y)}e.style.width=`${oe}px`,e.style.height=`${re}px`,ne!==b&&(e.style.top=`${ne}px`),se!==x&&(e.style.left=`${se}px`),s({width:oe,height:re,top:ne,left:se})}),window.addEventListener("mouseup",()=>{if(!i)return;i=!1,h="",document.body.style.userSelect="",document.body.style.cursor="";let q=parseFloat(e.style.width||`${p}`),w=parseFloat(e.style.height||`${m}`),Y=parseFloat(e.style.top||`${b}`),ae=parseFloat(e.style.left||`${x}`);c({width:q,height:w,top:Y,left:ae})})}var ct=k(()=>{});function Fe(){if(j)return j;try{let e=localStorage.getItem(Ee);if(e){let t=JSON.parse(e);if(t&&typeof t=="object")return j=t,j}}catch(e){console.warn("[QA Helper] Failed to read layout from localStorage",e)}return j={},j}function dt(e){j=e;try{localStorage.setItem(Ee,JSON.stringify(e))}catch(t){console.warn("[QA Helper] Failed to save layout to localStorage",t)}}function pt(e){if(!e)return null;let a=Fe()[e];return!a||typeof a!="object"?null:{...a}}function ut(e,t){if(!e||!t)return;let a={...Fe()},o=a[e]&&typeof a[e]=="object"?a[e]:{};a[e]={...o,...t},dt(a)}function ft(e){if(!e)return;let t={...Fe()};t[e]&&(delete t[e],dt(t))}var j,mt=k(()=>{le();j=null});function fe(e,t){let a=Number.parseFloat(e);return Number.isFinite(a)?a:t}function ta(e,t){return t?typeof t=="string"?document.getElementById(t)||e?.querySelector(t)||null:t:null}function me(e,t,a){return typeof e=="function"?e(a):Number.isFinite(e)?e:t(a)}var Te,Ie,E,G=k(()=>{ze();ct();mt();Te=class{constructor(t=1500){this.baseZIndex=t,this.modals=new Set}register(t){t&&(this.modals.add(t),t.style.zIndex||(t.style.zIndex=String(this.baseZIndex+this.modals.size)))}bringToFront(t){if(!t)return;let a=this.baseZIndex;this.modals.forEach(r=>{let n=parseInt(r.style.zIndex||"0",10);n>a&&(a=n)}),!(parseInt(t.style.zIndex||"0",10)>=a)&&(t.style.zIndex=String(a+1))}reset(){this.modals.clear()}},Ie=new Te;E=class{constructor(t={}){let{id:a,layoutId:o,minWidth:r=520,minHeight:n=320,maxWidth:s,maxHeight:c,baseWidth:i=960,minScale:u=11/13,scaleVariable:d="--qa-scale",viewportMargin:p=20,onResize:m,onResizeEnd:b,onDefaultLayout:x}=t;this.id=a,this.layoutId=o,this.minWidth=r,this.minHeight=n,this.maxWidthOption=s,this.maxHeightOption=c,this.baseWidthFallback=i,this.minScale=u,this.scaleVariable=d,this.viewportMargin=p,this.onResize=typeof m=="function"?m:null,this.onResizeEnd=typeof b=="function"?b:null,this.onDefaultLayout=typeof x=="function"?x:null,this.modal=null,this.dragHandle=null,this.cachedBaseWidth=0}get element(){return this.modal?this.modal:(this.id&&(this.modal=document.getElementById(this.id)),this.modal)}attach(t,a={}){if(this.modal=t||this.element,!this.modal)return;let{dragHandle:o}=a;this.dragHandle=ta(this.modal,o),this.applyLayout(),this.setupDragging(),this.setupResizing(),this.setupFocus()}setupDragging(){!this.modal||!this.dragHandle||de(this.modal,this.dragHandle,{onEnd:({top:t,left:a})=>{this.persistLayout({top:t,left:a})}})}setupResizing(){if(!this.modal)return;let t=({startRect:o})=>{let r=o?.left??fe(this.modal.style.left,0);return Math.max(this.minWidth,window.innerWidth-r-this.viewportMargin)},a=({startRect:o})=>{let r=o?.top??fe(this.modal.style.top,0);return Math.max(this.minHeight,window.innerHeight-r-this.viewportMargin)};it(this.modal,{minWidth:this.minWidth,minHeight:this.minHeight,maxWidth:o=>me(this.maxWidthOption,t,o),maxHeight:o=>me(this.maxHeightOption,a,o),onResize:({width:o,height:r,top:n,left:s})=>{this.updateScale(o),this.onResize&&this.onResize({width:o,height:r,top:n,left:s})},onEnd:({width:o,height:r,top:n,left:s})=>{this.updateScale(o),this.persistLayout({width:o,height:r,top:n,left:s}),this.onResizeEnd&&this.onResizeEnd({width:o,height:r,top:n,left:s})}})}setupFocus(){this.modal&&(this.modal.addEventListener("mousedown",()=>{this.focus()}),Ie.register(this.modal))}focus(){let t=this.element;t&&(Ie.register(t),Ie.bringToFront(t))}computeBaseWidth(){if(this.cachedBaseWidth)return this.cachedBaseWidth;let t=this.element;if(!t)return this.baseWidthFallback;let a=t.getBoundingClientRect();return this.cachedBaseWidth=a?.width||this.baseWidthFallback,this.cachedBaseWidth}updateScale(t){let a=this.element;if(!a)return;let o=a.getBoundingClientRect(),r=t||o.width,n=this.computeBaseWidth(),s=Math.max(this.minScale,Math.min(1,r/n));a.style.setProperty(this.scaleVariable,s.toFixed(3))}applyLayout(){let t=this.element;if(!t)return;let a=this.layoutId?pt(this.layoutId):null,o=t.getBoundingClientRect();if(t.style.right="",!a){this.onDefaultLayout&&this.onDefaultLayout(t),this.updateScale();return}if(Number.isFinite(a.left)&&(t.style.left=`${a.left}px`,t.style.transform="none"),Number.isFinite(a.top)&&(t.style.top=`${a.top}px`),Number.isFinite(a.width)){let r=this.resolveLayoutLimit("maxWidth",o,a.left),n=Math.min(a.width,r);t.style.width=`${n}px`,this.updateScale(n)}else this.updateScale();if(Number.isFinite(a.height)){let r=this.resolveLayoutLimit("maxHeight",o,a.top),n=Math.min(a.height,r);t.style.height=`${n}px`}}resolveLayoutLimit(t,a,o){let r={startRect:a,container:this.element};return t==="maxWidth"?me(this.maxWidthOption,()=>{let n=Number.isFinite(o)?o:a?.left??0;return Math.max(this.minWidth,window.innerWidth-n-this.viewportMargin)},r):me(this.maxHeightOption,()=>{let n=Number.isFinite(o)?o:a?.top??0;return Math.max(this.minHeight,window.innerHeight-n-this.viewportMargin)},r)}persistLayout(t={}){if(!this.layoutId)return;let a={};Number.isFinite(t.width)&&(a.width=t.width),Number.isFinite(t.height)&&(a.height=t.height),Number.isFinite(t.top)&&(a.top=t.top),Number.isFinite(t.left)&&(a.left=t.left),Object.keys(a).length&&ut(this.layoutId,a)}saveCurrentLayout(){let t=this.element;if(!t)return;let a=t.getBoundingClientRect(),o=fe(t.style.top,a.top),r=fe(t.style.left,a.left);this.persistLayout({width:a.width,height:a.height,top:o,left:r})}resetLayout(){let t=this.element;t&&(this.layoutId&&ft(this.layoutId),t.style.left="",t.style.top="",t.style.width="",t.style.height="",t.style.right="",t.style.transform="",this.cachedBaseWidth=0,this.applyLayout(),this.focus())}}});function aa(e=""){return e.replace(/("(?:\\u[\da-fA-F]{4}|\\[^u]|[^\\"])*"(?:\s*:)?|\b(?:true|false|null)\b|-?\d+(?:\.\d+)?(?:[eE][+\-]?\d+)?)/g,t=>t.startsWith('"')?`<span class="${t.endsWith(":")?"json-key":"json-string"}">${t}</span>`:t==="true"||t==="false"?`<span class="json-bool">${t}</span>`:t==="null"?`<span class="json-null">${t}</span>`:`<span class="json-number">${t}</span>`)}function R(e){let t=JSON.stringify(e??{},null,2)??"{}";return`<pre class="list json-viewer">${aa(t)}</pre>`}var be=k(()=>{});var ht={};tt(ht,{applyFiltersSnapshot:()=>ia,getCurrentFiltersSnapshot:()=>xt,getSavedFiltersSnapshot:()=>la,openFilters:()=>Re,refreshFiltersIfExists:()=>Oe,saveCurrentFiltersSnapshot:()=>sa});function ra(){try{let e=GM_getValue(bt);return e?JSON.parse(e):null}catch(e){return console.log("[QA Helper] Failed to load filters snapshot:",e),null}}function je(){return Be||(Ae=ra(),Be=!0),Ae}function gt(e){Ae=e,Be=!0;try{GM_setValue(bt,JSON.stringify(e))}catch(t){throw console.log("[QA Helper] Failed to save filters snapshot:",t),t}}function J(){let e=document.getElementById("qa-filters-apply"),t=!!je();e&&(e.disabled=!t),window.dispatchEvent(new CustomEvent("qaFiltersSnapshotChanged",{detail:{hasSnapshot:t}}))}function Me(e){let t=document.getElementById("aggregatedReportFilterForm");if(!t){f("Filters form not found");return}let{filters:a={},periods:o={}}=e;if(Object.entries(a).forEach(([n,s])=>{let c=t.querySelector(`[name="${n}"]`);if(c)if(c.type==="checkbox")c.checked=s===!0||s==="true"||s==="1"||s===1;else if(c.tagName==="SELECT")if(typeof jQuery<"u"){let i=jQuery(c);if(i.hasClass("select2-ajaxified-list")||i.hasClass("select2-ajaxified")){let u=i.data("entity");if(u){let d={fields:{},searchFields:{id:s},searchValue:s};jQuery.ajax({url:"/admin_panel/affiliates/getDropDownList/"+u+"/",type:"POST",dataType:"json",data:d,success:function(p){if(p&&p.length>0){let m=p[0];i.find('option:not([value=""])').remove();let b=new Option(m.name||m.id,m.id,!0,!0);i.append(b),i.trigger("change.select2"),i.val(m.id).trigger("change.select2")}},error:function(p){console.log("[QA Helper] AJAX error for "+u+":",p),c.value=s,i.trigger("change.select2")}})}else c.value=s,i.trigger("change.select2")}else c.value=s,i.trigger("chosen:updated"),i.trigger("change.select2")}else c.value=s;else c.value=s}),o.current){let n=document.querySelector("input[name=daterangepicker_start]"),s=document.querySelector("input[name=daterangepicker_end]");n&&o.current.start&&(n.value=o.current.start),s&&o.current.end&&(s.value=o.current.end)}if(o.comparison){let n=document.querySelector("input[name=daterangepicker_compare_start]"),s=document.querySelector("input[name=daterangepicker_compare_end]"),c=document.querySelector("input[name=enable_compare]");c&&(c.checked=!0),n&&o.comparison.start&&(n.value=o.comparison.start),s&&o.comparison.end&&(s.value=o.comparison.end)}typeof jQuery<"u"&&jQuery(t).trigger("change");let r=t.querySelector(".btn-apply");r&&r.click()}function ge(){let e=document.getElementById("aggregatedReportFilterForm");if(!e)return f("Filters form not found"),null;let t={};return e.querySelectorAll("[name]").forEach(o=>{let r=o.name;if(!r)return;let n=null,s=!1,c=null;if(o.type==="checkbox")s=o.checked,s&&(n=o.value||!0);else if(o.tagName==="SELECT"){let i=o.querySelector("option");i&&(c=i.value),n=o.value,s=n!==""&&n!==null&&n!=="0"&&n!==0&&n!==c}else(o.type==="text"||o.type==="hidden")&&(n=o.value,s=n!==""&&n!==null&&n!=="0"&&n!==0);s&&(t[r]?(Array.isArray(t[r])||(t[r]=[t[r]]),t[r].push(n)):t[r]=n)}),t}function xe(){let e={},t=document.querySelector("input[name=daterangepicker_start]"),a=document.querySelector("input[name=daterangepicker_end]");if((t?.value||a?.value)&&(e.current={start:t?.value||null,end:a?.value||null}),document.querySelector("input[name=enable_compare]")?.checked){let r=document.querySelector("input[name=daterangepicker_compare_start]"),n=document.querySelector("input[name=daterangepicker_compare_end]");(r?.value||n?.value)&&(e.comparison={start:r?.value||null,end:n?.value||null})}return e}function na(){if(document.getElementById("qa-filters-modal"))return;let e=document.createElement("div");e.id="qa-filters-modal",e.className="card qa-modal qa-modal-visible",e.innerHTML='<div class="hd" id="qa-filters-drag"><span class="title">Current filters</span> <span class="grow"></span><div class="qa-window-controls"><button type="button" class="qa-window-btn qa-window-btn--close" id="qa-filters-close" title="Close" aria-label="Close" data-icon="\xD7"></button> <button type="button" class="qa-window-btn qa-window-btn--reset" id="qa-filters-reset" title="Reset layout" aria-label="Reset layout" data-icon="\u21BA"></button> <button type="button" class="qa-window-btn qa-window-btn--collapse" id="qa-filters-collapse" title="Collapse" aria-label="Collapse" data-icon="\u2013"></button></div></div><div class="filters-tools"><div class="filters-actions"><button class="btn-action" id="qa-filters-refresh" title="Refresh filters snapshot"><span class="icon"><i class="fa fa-refresh"></i></span> <span class="label">Refresh preview</span></button> <button class="btn-action" id="qa-filters-copy-json" title="Copy current filters as JSON"><span class="icon">\u{1F4CB}</span> <span class="label">Copy state JSON</span></button> <button class="btn-action primary" id="qa-filters-save" title="Save current filters to storage"><span class="icon"><i class="fa fa-save"></i></span> <span class="label">Save state</span></button> <button class="btn-action primary" id="qa-filters-apply" title="Apply saved filters from storage" disabled><span class="icon"><i class="fa fa-check"></i></span> <span class="label">Apply state</span></button> <button class="btn-action" id="qa-filters-apply-json" title="Apply filters from JSON"><span class="icon">\u{1F4C4}</span> <span class="label">Apply state JSON</span></button></div></div><div class="body" id="qa-filters-body"><div class="filter-content"></div></div>',document.body.appendChild(e),z.attach(e,{dragHandle:"qa-filters-drag"}),document.getElementById("qa-filters-refresh")?.addEventListener("click",()=>{O(),f("\u2705 Filters preview refreshed")}),document.getElementById("qa-filters-copy-json")?.addEventListener("click",()=>{let a=ge(),o=xe(),r={filters:a||{},periods:o||{}};GM_setClipboard(JSON.stringify(r,null,2),"text"),f("\u2705 Filters JSON copied")}),document.getElementById("qa-filters-save")?.addEventListener("click",()=>{let a=ge(),o=xe(),r={filters:a||{},periods:o||{},timestamp:new Date().toISOString()};console.log("[QA Helper] Saving filters snapshot:",r),gt(r),f("\u2705 Filters state saved"),J()}),document.getElementById("qa-filters-apply")?.addEventListener("click",()=>{let a=je();if(!a){f("\u274C No saved filters state"),alert("\u274C No saved filters state. Save it first.");return}Me(a),O(),f("\u2705 Filters state applied")}),document.getElementById("qa-filters-apply-json")?.addEventListener("click",()=>{let a=document.createElement("div");a.className="qa-json-modal",a.innerHTML='<div class="qa-json-modal-title">\u{1F4CB} Paste filters state JSON:</div><textarea id="qa-paste-json-area"></textarea><div class="qa-json-modal-buttons"><button id="qa-paste-json-ok" class="btn-ok">Apply</button> <button id="qa-paste-json-cancel" class="btn-cancel">Cancel</button></div>',document.body.appendChild(a);let o=document.getElementById("qa-paste-json-area");o.focus(),document.getElementById("qa-paste-json-ok")?.addEventListener("click",()=>{let r=o.value.trim();a.remove(),t(r)}),document.getElementById("qa-paste-json-cancel")?.addEventListener("click",()=>{a.remove(),f("\u274C Cancelled")})});function t(a){if(!a){f("\u274C No data to load");return}try{let o=JSON.parse(a);if(!o.filters||typeof o.filters!="object"){alert('\u274C Invalid format. Expected an object with "filters".'),f("\u274C Invalid snapshot format");return}Me(o),O(),f("\u2705 Filters applied from JSON"),J()}catch(o){f(`\u274C JSON parsing error: ${o.message}`),alert(`\u274C Failed to parse JSON:
${o.message}`)}}document.getElementById("qa-filters-close")?.addEventListener("click",()=>{z.saveCurrentLayout(),e.remove()}),document.getElementById("qa-filters-reset")?.addEventListener("click",()=>{z.resetLayout(),O(),J()}),document.getElementById("qa-filters-collapse")?.addEventListener("click",()=>{z.saveCurrentLayout(),C("qa-filters-modal","Current filters",()=>{e.classList.add("qa-modal-visible"),z.applyLayout(),z.focus(),J()}),e.classList.remove("qa-modal-visible")}),z.applyLayout(),O(),J()}function O(){let e=document.getElementById("qa-filters-modal");if(!e)return;let t=ge(),a=xe(),o={filters:t||{},periods:a||{}},r=e.querySelector(".filter-content");r&&(r.innerHTML=R(o))}function Re(){na(),v("qa-filters-modal");let e=document.getElementById("qa-filters-modal");e&&(e.style.display="",z.focus())}function Oe(){document.getElementById("qa-filters-modal")&&O()}function xt(){let e=ge(),t=xe();return{filters:e||{},periods:t||{}}}function sa(){let e=xt();return gt({...e,timestamp:new Date().toISOString()}),J(),e}function la(){return je()}function ia(e){return e?(Me(e),O(),!0):!1}var oa,bt,z,Ae,Be,He=k(()=>{_();G();W();be();oa="qa-filters-modal",bt="QA_FILTERS_SNAPSHOT",z=new E({id:"qa-filters-modal",layoutId:oa,minWidth:520,minHeight:320});Ae=null,Be=!1});var wt={};tt(wt,{applyCustomizeState:()=>ma,getCurrentCustomizeState:()=>qt,getSavedCustomizeState:()=>fa,openCustomize:()=>Pe,refreshCustomizeIfExists:()=>$e,saveCurrentCustomizeState:()=>ua,triggerCustomizeApply:()=>ba});function he(){let e={columns:[],grouping:[],filters:{}},t=document.querySelector(".dropdown-menu-view-settings");if(!t)return console.log("[QA Helper] dropdown-menu-view-settings not found"),e;let a=t.querySelector("#customFiltersBlock");a&&a.querySelectorAll('input[type="checkbox"]:checked').forEach(n=>{let s=n.getAttribute("data-source"),c=n.getAttribute("data-title");s&&(e.filters[s]=da(c||s))});let o=t.querySelector("#customGroupingsBlock");o&&o.querySelectorAll('input[type="checkbox"]:checked').forEach(n=>{let s=n.getAttribute("data-source");s&&e.grouping.push(s)});let r=t.querySelector("#customListColumnsSortable");return r&&r.querySelectorAll('input[type="checkbox"]:checked').forEach(n=>{let s=n.getAttribute("data-source");s&&e.columns.push(s)}),console.log("[QA Helper] Saving customize settings:",e),e}function da(e){if(!e)return"";let t=document.createElement("div");return t.innerHTML=e,t.textContent||t.innerText||""}function De(e,t={}){if(!e)return;let a=document.querySelector(".dropdown-menu-view-settings");if(!a){console.log("[QA Helper] dropdown-menu-view-settings not found");return}let{skipApply:o=!1,silent:r=!1}=t,n=a.querySelector("#customFiltersBlock");n&&e.filters&&n.querySelectorAll('input[type="checkbox"]').forEach(d=>{let p=d.getAttribute("data-source");d.checked=!!(p&&e.filters[p])});let s=a.querySelector("#customGroupingsBlock");s&&e.grouping&&Array.isArray(e.grouping)&&s.querySelectorAll('input[type="checkbox"]').forEach(d=>{let p=d.getAttribute("data-source");d.checked=!!(p&&e.grouping.includes(p))});let c=a.querySelector("#customListColumnsSortable");c&&e.columns&&Array.isArray(e.columns)&&c.querySelectorAll('input[type="checkbox"]').forEach(d=>{let p=d.getAttribute("data-source");d.checked=!!(p&&e.columns.includes(p))});let i=a.querySelector("#applyCustomization");i&&!o&&i.click(),r||f("\u2705 Customize settings applied")}function Ne(){try{let e=GM_getValue("QA_CUSTOMIZE_SETTINGS");return e?JSON.parse(e):null}catch(e){return console.log("[QA Helper] Failed to load customize settings:",e),null}}function yt(e){try{GM_setValue("QA_CUSTOMIZE_SETTINGS",JSON.stringify(e))}catch(t){throw console.log("[QA Helper] Failed to save customize settings:",t),t}}function F(){let e=document.getElementById("qa-customize-apply"),t=!!Ne();e&&(e.disabled=!t),window.dispatchEvent(new CustomEvent("qaCustomizeSnapshotChanged",{detail:{hasState:t}}))}function pa(){if(document.getElementById("qa-customize-modal"))return;let e=document.createElement("div");e.id="qa-customize-modal",e.className="card qa-modal qa-modal-visible",e.innerHTML='<div class="hd" id="qa-customize-drag"><span class="title">Current customize</span> <span class="grow"></span><div class="qa-window-controls"><button type="button" class="qa-window-btn qa-window-btn--close" id="qa-customize-close" title="Close" aria-label="Close" data-icon="\xD7"></button> <button type="button" class="qa-window-btn qa-window-btn--reset" id="qa-customize-reset" title="Reset layout" aria-label="Reset layout" data-icon="\u21BA"></button> <button type="button" class="qa-window-btn qa-window-btn--collapse" id="qa-customize-collapse" title="Collapse" aria-label="Collapse" data-icon="\u2013"></button></div></div><div class="customize-tools"><div class="customize-actions"><button class="btn-action" id="qa-customize-refresh" title="Refresh customize snapshot"><span class="icon"><i class="fa fa-refresh"></i></span> <span class="label">Refresh preview</span></button> <button class="btn-action" id="qa-customize-copy-json" title="Copy current customize as JSON"><span class="icon">\u{1F4CB}</span> <span class="label">Copy state JSON</span></button> <button class="btn-action primary" id="qa-customize-save" title="Save current customize to storage"><span class="icon"><i class="fa fa-save"></i></span> <span class="label">Save state</span></button> <button class="btn-action primary" id="qa-customize-apply" title="Apply saved customize from storage" disabled><span class="icon"><i class="fa fa-check"></i></span> <span class="label">Apply state</span></button> <button class="btn-action" id="qa-customize-apply-json" title="Apply customize from JSON"><span class="icon">\u{1F4C4}</span> <span class="label">Apply state JSON</span></button></div></div><div class="body" id="qa-customize-body"><div class="customize-content"></div></div>',document.body.appendChild(e),L.attach(e,{dragHandle:"qa-customize-drag"}),document.getElementById("qa-customize-refresh")?.addEventListener("click",()=>{H(),f("\u2705 Customize preview refreshed")}),document.getElementById("qa-customize-copy-json")?.addEventListener("click",()=>{let a=he();GM_setClipboard(JSON.stringify(a,null,2),"text"),f("\u2705 Customize JSON copied")}),document.getElementById("qa-customize-save")?.addEventListener("click",()=>{let a=he();yt(a),f("\u2705 Customize state saved"),F()}),document.getElementById("qa-customize-apply")?.addEventListener("click",()=>{let a=Ne();if(!a){f("\u274C No saved customize state"),alert("\u274C No saved customize state. Save it first.");return}De(a),H(),f("\u2705 Customize state applied")}),document.getElementById("qa-customize-apply-json")?.addEventListener("click",()=>{let a=document.createElement("div");a.className="qa-json-modal",a.innerHTML='<div class="qa-json-modal-title">\u{1F4CB} Paste customize state JSON:</div><textarea id="qa-paste-customize-json-area"></textarea><div class="qa-json-modal-buttons"><button id="qa-paste-customize-json-ok" class="btn-ok">Apply</button> <button id="qa-paste-customize-json-cancel" class="btn-cancel">Cancel</button></div>',document.body.appendChild(a);let o=document.getElementById("qa-paste-customize-json-area");o.focus(),document.getElementById("qa-paste-customize-json-ok")?.addEventListener("click",()=>{let r=o.value.trim();a.remove(),t(r)}),document.getElementById("qa-paste-customize-json-cancel")?.addEventListener("click",()=>{a.remove(),f("\u274C Cancelled")})});function t(a){if(!a){f("\u274C No data to load");return}try{let o=JSON.parse(a);if(!o.columns||typeof o.columns!="object"){alert('\u274C Invalid format. Expected an object with "columns".'),f("\u274C Invalid customize format");return}De(o),H(),f("\u2705 Customize applied from JSON"),F()}catch(o){f(`\u274C JSON parsing error: ${o.message}`),alert(`\u274C Failed to parse JSON:
${o.message}`)}}document.getElementById("qa-customize-close")?.addEventListener("click",()=>{L.saveCurrentLayout(),e.remove()}),document.getElementById("qa-customize-reset")?.addEventListener("click",()=>{L.resetLayout(),H(),F()}),document.getElementById("qa-customize-collapse")?.addEventListener("click",()=>{L.saveCurrentLayout(),C("qa-customize-modal","Current customize",()=>{e.classList.add("qa-modal-visible"),L.applyLayout(),L.focus(),F()}),e.classList.remove("qa-modal-visible")}),L.applyLayout(),H(),F()}function H(){let e=document.getElementById("qa-customize-modal");if(!e)return;let t=he(),a=e.querySelector(".customize-content");a&&(a.innerHTML=R(t))}function Pe(){pa(),v("qa-customize-modal");let e=document.getElementById("qa-customize-modal");e&&(e.style.display="",L.focus()),F()}function $e(){document.getElementById("qa-customize-modal")&&(H(),F())}function qt(){return he()}function ua(){let e=qt();return yt(e),F(),e}function fa(){return Ne()}function ma(e,t={}){return e?(De(e,t),H(),!0):!1}function ba(){let e=document.querySelector(".dropdown-menu-view-settings");if(!e)return!1;let t=e.querySelector("#applyCustomization");return t?(t.click(),!0):!1}var ca,L,_e=k(()=>{_();G();W();be();ca="qa-customize-modal",L=new E({id:"qa-customize-modal",layoutId:ca,minWidth:520,minHeight:320,baseWidth:800,onDefaultLayout:e=>{e&&(e.style.right="20px",e.style.top="120px",e.style.width="800px")}})});function ha(){if(D&&document.body.contains(D))return D;let e=document.getElementById("qa-status-container");if(e)return D=e,D;let t=document.createElement("div");t.id="qa-status-container";let a=document.body||document.documentElement;return a?(a.appendChild(t),D=t,D):null}function Ye(e,t={}){if(!e||e.dataset.qaDismissing==="1")return;e.dataset.qaDismissing="1";let a=Qe.get(e);a&&(clearTimeout(a),Qe.delete(e)),e.classList.remove("qa-status-toast--visible"),e.classList.add("qa-status-toast--leaving");let o=typeof t.delay=="number"?t.delay:kt;window.setTimeout(()=>{e.remove()},o)}function Ue(){return Je||(Je=Promise.resolve().then(()=>(He(),ht))),Je}function Ve(){return We||(We=Promise.resolve().then(()=>(_e(),wt))),We}async function qe(){try{let[e,t]=await Promise.all([Ue(),Ve()]),a=!!e.getSavedFiltersSnapshot(),o=!!t.getSavedCustomizeState();ye&&(ye.disabled=!(a&&o))}catch(e){console.error("[QA Helper] Failed to update panel buttons:",e)}}async function ya(){try{let[e,t]=await Promise.all([Ue(),Ve()]);t.saveCurrentCustomizeState(),e.saveCurrentFiltersSnapshot(),qe(),f("\u2705 Saved customize & filters state")}catch(e){console.error("[QA Helper] Failed to save combined state:",e);let t=e?.message||e?.toString?.()||"Unknown error";f(`\u274C Failed to save state: ${t}`)}}async function qa(){try{let[e,t]=await Promise.all([Ue(),Ve()]),a=t.getSavedCustomizeState(),o=e.getSavedFiltersSnapshot();if(!a||!o){f("\u26A0\uFE0F Save customize & filters first");return}let r=t.applyCustomizeState(a,{skipApply:!0,silent:!0}),n=e.applyFiltersSnapshot(o);if(!r||!n){f("\u26A0\uFE0F Failed to apply saved state");return}let s=t.triggerCustomizeApply();f(s?"\u2705 Applied customize & filters state":"\u26A0\uFE0F Applied state, but apply button was not triggered")}catch(e){console.error("[QA Helper] Failed to apply combined state:",e);let t=e?.message||e?.toString?.()||"Unknown error";f(`\u274C Failed to apply state: ${t}`)}}function Ct(){let e=document.getElementById("qa-rpt");if(e)return;e=document.createElement("div"),e.id="qa-rpt",e.innerHTML='<div class="hd" id="qa-rpt-drag"><span class="title">QA Helper</span> <span class="grow"></span><div class="qa-window-controls"><button type="button" class="qa-window-btn qa-window-btn--close" id="qa-rpt-close" title="Close" aria-label="Close" data-icon="\xD7"></button> <button type="button" class="qa-window-btn qa-window-btn--reset" id="qa-rpt-reset" title="Reset position" aria-label="Reset position" data-icon="\u21BA"></button> <button type="button" class="qa-window-btn qa-window-btn--collapse" id="qa-rpt-collapse" title="Collapse" aria-label="Collapse" data-icon="\u2013"></button></div></div><div class="ft"><button class="btn" id="qa-save-state"><i class="fa fa-save"></i> Save Customize&Filters state</button> <button class="btn" id="qa-apply-state" disabled><i class="fa fa-check"></i> Apply Customize&Filters state</button> <button class="btn" id="qa-open-columns">\u{1F4CA} Last table response</button> <button class="btn" id="qa-open-filters">\u{1F39B}\uFE0F Current filters</button> <button class="btn" id="qa-open-customize"><i class="fa fa-cog" style="color:#fff"></i> Current customize</button> <button class="btn" id="qa-compare-dropdown"><i class="fa fa-filter" style="color:#656c71"></i> Column Filter</button></div>',document.body.appendChild(e);let t=()=>{e.style.top="16px",e.style.left="",e.style.right="16px",e.style.bottom="",e.style.transform=""};document.getElementById("qa-rpt-close")?.addEventListener("click",()=>e.remove()),document.getElementById("qa-rpt-reset")?.addEventListener("click",()=>t()),document.getElementById("qa-rpt-collapse")?.addEventListener("click",()=>C("qa-rpt","QA Helper",()=>v("qa-rpt"),{onClose:()=>e.remove(),insertAtStart:!0})),document.getElementById("qa-save-state")?.addEventListener("click",()=>{ya()}),ye=document.getElementById("qa-apply-state"),ye?.addEventListener("click",()=>{qa()}),document.getElementById("qa-open-columns")?.addEventListener("click",()=>{X.onOpenColumns()}),document.getElementById("qa-open-filters")?.addEventListener("click",()=>{X.onOpenFilters()}),document.getElementById("qa-open-customize")?.addEventListener("click",()=>{X.onOpenCustomize()}),document.getElementById("qa-compare-dropdown")?.addEventListener("click",()=>{X.onOpenCompare()}),de(e,document.getElementById("qa-rpt-drag")),vt||(vt=!0,requestAnimationFrame(()=>{C("qa-rpt","QA Helper",()=>v("qa-rpt"),{onClose:()=>e.remove(),insertAtStart:!0})})),qe()}function St(e){X={onOpenColumns:e?.onOpenColumns||(()=>{}),onOpenCompare:e?.onOpenCompare||(()=>{}),onOpenFilters:e?.onOpenFilters||(()=>{}),onOpenCustomize:e?.onOpenCustomize||(()=>{})},Ct()}function f(e,t={}){if(!e)return;let a=ha();if(!a)return;let o=Array.from(a.querySelectorAll(".qa-status-toast"));o.length>=xa&&Ye(o[0],{delay:kt});let r=document.createElement("div");r.className="qa-status-toast",r.textContent=e,a.appendChild(r),requestAnimationFrame(()=>{r.classList.add("qa-status-toast--visible")});let n=typeof t.duration=="number"?t.duration:ga;if(n>0){let s=window.setTimeout(()=>Ye(r),n);Qe.set(r,s)}r.addEventListener("click",()=>Ye(r,{delay:0}))}function we(e){Ct(),window.dispatchEvent(new CustomEvent("qaPayloadUpdated",{detail:e}))}var X,vt,Je,We,ye,D,ga,kt,xa,Qe,W=k(()=>{M();ze();_();X={onOpenColumns:()=>{},onOpenCompare:()=>{},onOpenFilters:()=>{},onOpenCustomize:()=>{}},vt=!1,Je=null,We=null,ye=null,D=null,ga=2400,kt=220,xa=4,Qe=new WeakMap;window.addEventListener("qaFiltersSnapshotChanged",()=>{qe()});window.addEventListener("qaCustomizeSnapshotChanged",()=>{qe()})});var at=`:root{--qa-bg: linear-gradient(135deg, rgba(38,12,63,.92) 0%, rgba(17,15,36,.94) 100%);--qa-surface: linear-gradient(135deg, rgba(79,29,112,.52) 0%, rgba(30,22,61,.62) 100%);--qa-surface-soft: linear-gradient(135deg, rgba(122,45,179,.35) 0%, rgba(62,36,102,.4) 100%);--qa-surface-strong: linear-gradient(135deg, rgba(99,35,152,.6) 0%, rgba(35,22,70,.72) 100%);--qa-accent: linear-gradient(135deg, rgba(168,85,247,.18) 0%, rgba(236,72,153,.12) 100%);--qa-border: rgba(192,132,252,.35);--qa-border-strong: rgba(192,132,252,.55);--qa-border-muted: rgba(192,132,252,.2);--qa-hover: rgba(217,70,239,.2);--qa-primary: #a855f7;--qa-primary-bright: #c084fc;--qa-primary-light: #e9d5ff;--qa-secondary: #f472b6;--qa-highlight: rgba(236,72,153,.32);--qa-text: #f8fafc;--qa-text-dim: #d1d5db;--qa-text-muted: rgba(226,232,240,.75);--qa-success: #22c55e;--qa-warning: #f97316;--qa-danger: #f87171;--qa-info: #c4b5fd;--qa-cyan: #d8b4fe;--qa-blue: #a855f7;--qa-blue-light: #ede9fe;--qa-blue-bright: #c084fc;--qa-purple: #f5d0fe;--qa-tab-bg: linear-gradient(135deg, rgba(37,23,74,.96) 0%, rgba(49,32,89,.96) 100%);--qa-tab-hover: linear-gradient(135deg, rgba(63,34,106,.98) 0%, rgba(75,43,119,.98) 100%);--qa-scrollbar-track: rgba(17,15,36,.35);--qa-scrollbar-thumb: linear-gradient(135deg, rgba(192,132,252,.55) 0%, rgba(139,92,246,.62) 100%);--qa-scrollbar-thumb-hover: linear-gradient(135deg, rgba(207,166,255,.75) 0%, rgba(168,114,255,.82) 100%);--qa-shadow-soft: 0 12px 48px rgba(139,92,246,.25);--qa-shadow-strong: 0 24px 72px rgba(139,92,246,.35)}.qa-modal{display:none;flex-direction:column;background:var(--qa-surface);color:var(--qa-text)}.qa-modal-visible{display:flex!important}.qa-window-controls{display:flex;align-items:center;gap:6px;margin-left:10px;user-select:none;cursor:default;flex-shrink:0;flex-direction:row-reverse}.qa-window-btn{width:14px;height:14px;border-radius:50%;border:1px solid rgba(0,0,0,.28);display:inline-flex;align-items:center;justify-content:center;padding:0;background:linear-gradient(135deg,#ffffff8c,#00000014);position:relative;box-shadow:inset 0 1px #fff9,inset 0 -1px #00000026;transition:transform .18s ease,box-shadow .18s ease,filter .18s ease;cursor:pointer;overflow:hidden;font-size:0}.qa-window-btn:after{content:attr(data-icon);position:absolute;inset:0;display:flex;align-items:center;justify-content:center;font-size:8px;line-height:1;color:#0f172ad1;opacity:.75;transform:scale(1);transition:opacity .15s ease,transform .18s ease}.qa-window-btn:focus{outline:none;box-shadow:0 0 0 2px #ffffff59,inset 0 1px #fff9,inset 0 -1px #00000026}.qa-window-btn:hover{filter:brightness(1.05);transform:translateY(-.5px);box-shadow:0 0 8px #ffffff4d,inset 0 1px #ffffffb3,inset 0 -1px #0000002e}.qa-window-btn:hover:after,.qa-window-btn:focus-visible:after{opacity:1}.qa-window-btn--close{background:radial-gradient(circle at 25% 25%,#ffffffbf,#ff5f57 70%);border-color:#c82d2da6}.qa-window-btn--reset{background:radial-gradient(circle at 25% 25%,#ffffffbf,#febb2e 70%);border-color:#d9770699}.qa-window-btn--collapse{background:radial-gradient(circle at 25% 25%,#ffffffbf,#28c840 70%);border-color:#16a34a99}.hidden-input{position:absolute;opacity:0;pointer-events:none}#qa-rpt{position:fixed;right:16px;top:16px;z-index:10000;width:min(280px,88vw);background:var(--qa-bg);color:var(--qa-text);border-radius:14px;box-shadow:0 10px 40px #8b5cf63b,0 0 0 1px #c084fc47;overflow:hidden;font:12px/1.5 system-ui,-apple-system,Segoe UI,Roboto,sans-serif;backdrop-filter:blur(16px)}#qa-rpt .hd{display:flex;align-items:center;gap:8px;padding:10px 12px;background:var(--qa-accent);border-bottom:1px solid var(--qa-border);cursor:move;user-select:none}#qa-rpt .title{background:linear-gradient(135deg,#a855f7,#c084fc);-webkit-background-clip:text;-webkit-text-fill-color:transparent;background-clip:text;font-size:12px;font-weight:800;letter-spacing:.3px}#qa-rpt .grow{flex:1}#qa-rpt .btn-ico{cursor:pointer;opacity:.75;padding:4px;border-radius:7px;transition:all .2s cubic-bezier(.4,0,.2,1);user-select:none;font-size:11px;background:#ffffff0d}#qa-rpt .btn-ico:hover{opacity:1;background:#c084fc40;transform:scale(1.1);box-shadow:0 0 12px #c084fc66}#qa-rpt .ft{display:flex;gap:6px;padding:10px 12px;background:var(--qa-accent);border-top:1px solid var(--qa-border);flex-direction:column}#qa-rpt .btn{cursor:pointer;padding:8px 10px;border-radius:9px;background:linear-gradient(135deg,#8b5cf633,#c084fc26);border:1px solid rgba(192,132,252,.4);transition:all .25s cubic-bezier(.4,0,.2,1);font-weight:600;text-align:center;font-size:11px;color:var(--qa-text);box-shadow:0 2px 6px #8b5cf626}#qa-rpt .btn:hover{background:linear-gradient(135deg,#8b5cf659,#c084fc40);border-color:#c084fc99;box-shadow:0 4px 16px #8b5cf64d,0 0 0 3px #c084fc26;transform:translateY(-1px)}#qa-status-container{position:fixed;right:20px;bottom:20px;display:flex;flex-direction:column;align-items:flex-end;gap:10px;z-index:10002;pointer-events:none}.qa-status-toast{background:var(--qa-surface-strong);color:var(--qa-text);border-radius:12px;padding:10px 14px;border:1px solid var(--qa-border);box-shadow:var(--qa-shadow-soft);font-size:12px;font-weight:600;min-width:220px;max-width:min(320px,80vw);opacity:0;transform:translateY(12px) scale(.96);transition:opacity .2s ease,transform .2s ease,filter .2s ease;backdrop-filter:blur(18px);pointer-events:auto;cursor:pointer;line-height:1.45;letter-spacing:.2px}.qa-status-toast--visible{opacity:1;transform:translateY(0) scale(1)}.qa-status-toast--leaving{opacity:0;transform:translateY(-6px) scale(.94)}.qa-status-toast:hover{filter:brightness(1.08)}#qa-col-modal{position:fixed;left:50%;top:6%;transform:translate(-50%);width:min(860px,90vw);max-height:82vh;overflow:hidden;background:var(--qa-bg);color:var(--qa-text);border-radius:12px;box-shadow:0 20px 60px #8b5cf652,0 0 0 1px #c084fc59,inset 0 0 0 1px #c084fc1f;display:none;flex-direction:column;backdrop-filter:blur(16px);z-index:1500;--qa-scale: .92;font-size:clamp(11px,calc(13px * var(--qa-scale, 1)),13px);transition:box-shadow .2s cubic-bezier(.4,0,.2,1)}#qa-col-modal:hover{box-shadow:0 20px 60px #8b5cf652,0 0 0 1px #c084fc61,inset 0 0 10px #8b5cf638,inset 0 0 0 2px #c084fc52}#qa-col-modal .hd{display:flex;align-items:center;gap:10px;padding:9px 12px;background:var(--qa-accent);border-bottom:1px solid var(--qa-border);cursor:move;user-select:none}#qa-col-modal .title{background:linear-gradient(135deg,#c084fc,#c4b5fd);-webkit-background-clip:text;-webkit-text-fill-color:transparent;background-clip:text;font-weight:800;font-size:clamp(11px,calc(15px * var(--qa-scale, 1)),15px);letter-spacing:.4px;text-shadow:0 0 20px rgba(236,72,153,.3)}#qa-col-modal .grow{flex:1}#qa-col-modal .tools{padding:14px;background:linear-gradient(135deg,#8b5cf614,#ec48990a);border-bottom:1px solid var(--qa-border)}#qa-col-modal .section{margin-bottom:14px}#qa-col-modal .section:last-child{margin-bottom:0}#qa-col-modal .section-title{color:var(--qa-cyan);font-size:clamp(11px,calc(11px * var(--qa-scale, 1)),11px);font-weight:800;text-transform:uppercase;letter-spacing:.9px;margin-bottom:8px;text-shadow:0 0 9px rgba(192,132,252,.45)}#qa-col-modal .filter-row{display:flex;gap:10px;align-items:stretch}#qa-col-modal .filter-row label{flex:1;display:flex;flex-direction:column;gap:6px;color:var(--qa-text-dim);font-size:clamp(11px,calc(11px * var(--qa-scale, 1)),11px);font-weight:700;text-transform:uppercase;letter-spacing:.5px}#qa-col-modal .filter-row label span{opacity:.9;background:linear-gradient(135deg,#c084fc66,#ec48994d);padding:3px 7px;border-radius:6px;display:inline-block;width:fit-content}#qa-col-modal .pickers-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(180px,1fr));gap:10px;align-items:start}#qa-col-modal .picker-item{display:flex;flex-direction:column;gap:5px}#qa-col-modal .picker-header{display:flex;align-items:center;justify-content:space-between;gap:6px}#qa-col-modal .picker-item label{color:var(--qa-blue-light);font-size:clamp(11px,calc(10px * var(--qa-scale, 1)),11px);font-weight:700;text-transform:uppercase;letter-spacing:.6px}#qa-col-modal .picker-remove{cursor:pointer;opacity:.6;font-size:clamp(11px,calc(14px * var(--qa-scale, 1)),14px);padding:2px 6px;border-radius:5px;transition:all .2s cubic-bezier(.4,0,.2,1);background:#ef444426;line-height:1}#qa-col-modal .picker-remove:hover{opacity:1;background:#ef44444d;transform:scale(1.15);box-shadow:0 0 8px #ef444466}#qa-col-modal .actions-row{display:flex;gap:8px;flex-wrap:wrap;align-items:center;padding-top:2px}#qa-col-modal select,#qa-col-modal input[type=text]{background:var(--qa-surface-strong);color:#f1f5f9f2;border:2px solid rgba(192,132,252,.3);border-radius:10px;padding:8px 12px;font-size:clamp(11px,calc(12px * var(--qa-scale, 1)),12px);width:100%;transition:all .3s cubic-bezier(.4,0,.2,1);font-family:inherit;font-weight:500;box-shadow:0 4px 16px #8b5cf614,inset 0 1px #ffffff0a}#qa-col-modal select option{background:#2a163e;color:#f5e8ff;padding:8px 12px}#qa-col-modal select option:hover,#qa-col-modal select option:checked{background:#3a1d52;color:#f1ddff}#qa-col-modal select:focus,#qa-col-modal input[type=text]:focus{outline:none;border-color:#8b5cf6b3;box-shadow:0 0 0 3px #8b5cf626,0 8px 32px #8b5cf640,inset 0 1px #ffffff14,inset 0 0 20px #8b5cf61a;background:linear-gradient(135deg,#36185cf0,#1a0e3af5)}#qa-col-modal select:hover,#qa-col-modal input[type=text]:hover{border-color:#c084fc73;box-shadow:0 6px 24px #8b5cf61f,inset 0 1px #ffffff0d}#qa-col-filter,#qa-compare-filter{padding:10px 12px 10px 14px!important;background:linear-gradient(135deg,#311554d9,#1a0e3ade)!important;border:2px solid rgba(192,132,252,.25)!important;border-radius:11px!important;letter-spacing:.35px;font-size:clamp(12px,calc(14px * var(--qa-scale, 1)),14px)!important;font-weight:500;color:#f1f5f9f2!important;box-shadow:0 3px 14px #8b5cf614,inset 0 1px #ffffff0a!important;transition:all .3s cubic-bezier(.4,0,.2,1)!important;position:relative;height:38px;display:flex;align-items:center}#qa-col-filter:not(:placeholder-shown),#qa-compare-filter:not(:placeholder-shown){background:linear-gradient(135deg,#311554e6,#1a0e3aeb)!important;border-color:#8b5cf666!important;box-shadow:0 0 0 1px #8b5cf61a,0 4px 18px #8b5cf624,inset 0 1px #ffffff0f!important}#qa-col-filter:focus,#qa-compare-filter:focus{background:linear-gradient(135deg,#36185cf0,#1a0e3af5)!important;border-color:#8b5cf6b3!important;box-shadow:0 0 0 3px #8b5cf626,0 8px 28px #8b5cf63b,inset 0 1px #ffffff14,inset 0 0 20px #8b5cf61a!important;outline:none!important}#qa-col-filter:hover,#qa-compare-filter:hover{border-color:#c084fc73!important;box-shadow:0 0 0 1px #8b5cf61a,0 6px 20px #8b5cf61c,inset 0 1px #ffffff0d!important}#qa-col-filter::placeholder,#qa-compare-filter::placeholder{color:#c084fc8c;opacity:1;font-weight:400}#qa-col-filter:focus::placeholder,#qa-compare-filter:focus::placeholder{color:#c084fca6}#qa-col-modal .btn{cursor:pointer;padding:8px 12px;border-radius:9px;background:linear-gradient(135deg,#8b5cf633,#c084fc26);border:1px solid rgba(192,132,252,.4);white-space:nowrap;transition:all .25s cubic-bezier(.4,0,.2,1);font-weight:600;font-size:clamp(11px,calc(12px * var(--qa-scale, 1)),12px);font-family:inherit;color:var(--qa-text);box-shadow:0 2px 6px #8b5cf626}#qa-col-modal .btn:hover{background:linear-gradient(135deg,#8b5cf659,#c084fc40);border-color:#c084fc99;box-shadow:0 4px 14px #8b5cf647,0 0 0 3px #c084fc26;transform:translateY(-1px)}#qa-col-modal .btn-primary{background:linear-gradient(135deg,#8b5cf6,#a855f7);border-color:#a855f7;color:#fff;font-weight:700;box-shadow:0 4px 12px #8b5cf661}#qa-col-modal .btn-primary:hover{background:linear-gradient(135deg,#9333ea,#a855f7);box-shadow:0 5px 18px #8b5cf67a,0 0 0 3px #8b5cf640;transform:translateY(-2px)}#qa-col-modal .btn-copy{background:linear-gradient(135deg,#8b5cf6,#a855f7);border-color:#a855f7;color:#fff;font-weight:700;box-shadow:0 4px 12px #8b5cf661}#qa-col-modal .btn-copy:hover{background:linear-gradient(135deg,#8b5cf6,#a855f7);box-shadow:0 4px 12px #8b5cf661;transform:none;border-color:#a855f7}#qa-col-modal .stat{color:var(--qa-cyan);font-size:clamp(11px,calc(12px * var(--qa-scale, 1)),12px);font-weight:600;padding:7px 12px;background:linear-gradient(135deg,#c084fc2e,#c084fc1a);border-radius:8px;border:1px solid rgba(192,132,252,.3);box-shadow:0 2px 7px #c084fc2e}#qa-col-modal .mode-toggle{display:inline-flex;background:#34165ce0;border-radius:9px;border:1px solid rgba(192,132,252,.35);overflow:hidden;box-shadow:0 2px 7px #8b5cf61a}#qa-col-modal .mode-toggle button{padding:7px 14px;background:transparent;border:none;color:var(--qa-text-dim);font-size:clamp(11px,calc(11px * var(--qa-scale, 1)),11px);font-weight:700;cursor:pointer;transition:all .2s cubic-bezier(.4,0,.2,1);font-family:inherit;text-transform:uppercase;letter-spacing:.5px;border-right:1px solid rgba(192,132,252,.2)}#qa-col-modal .mode-toggle button:last-child{border-right:none}#qa-col-modal .mode-toggle button.active{background:linear-gradient(135deg,#8b5cf64d,#c084fc33);color:var(--qa-cyan);text-shadow:0 0 8px rgba(192,132,252,.5)}#qa-col-modal .mode-toggle button:hover:not(.active){background:#c084fc1a;color:var(--qa-text)}#qa-col-modal .body{padding:18px;overflow:auto;flex:1}#qa-col-modal pre.list,pre.list.json-viewer{background:linear-gradient(135deg,#210d3ff2,#120929e6);border:1px solid rgba(192,132,252,.3);border-radius:12px;padding:14px;white-space:pre-wrap;word-break:break-word;font-size:clamp(11px,calc(12px * var(--qa-scale, 1)),12px);line-height:1.6;font-family:Consolas,Monaco,Courier New,monospace;color:#e2e8f0;margin:0;box-shadow:0 4px 16px #8b5cf626}.body pre.list.json-viewer .json-key,.customize-content pre.list.json-viewer .json-key{color:#c084fc;font-weight:600}.body pre.list.json-viewer .json-string,.customize-content pre.list.json-viewer .json-string{color:#34d399}.body pre.list.json-viewer .json-number,.customize-content pre.list.json-viewer .json-number{color:#a855f7}.body pre.list.json-viewer .json-bool,.body pre.list.json-viewer .json-null,.customize-content pre.list.json-viewer .json-bool,.customize-content pre.list.json-viewer .json-null{color:#f87171;font-weight:600}#qa-col-modal table.data-table{width:100%;border-collapse:collapse;background:linear-gradient(135deg,#210d3ff2,#120929e6);border:1px solid rgba(192,132,252,.3);border-radius:12px;box-shadow:0 4px 16px #8b5cf626;overflow:hidden}#qa-col-modal table.data-table th{background:linear-gradient(135deg,#8b5cf640,#c084fc26);color:var(--qa-cyan);font-size:clamp(11px,calc(11px * var(--qa-scale, 1)),11px);font-weight:800;text-transform:uppercase;letter-spacing:.8px;padding:12px 14px;text-align:left;border-bottom:2px solid rgba(192,132,252,.4);position:sticky;top:0;z-index:10;text-shadow:0 0 8px rgba(192,132,252,.3)}#qa-col-modal table.data-table td{padding:10px 14px;font-size:clamp(11px,calc(12px * var(--qa-scale, 1)),12px);color:#e2e8f0;border-bottom:1px solid rgba(192,132,252,.15);font-family:Consolas,Monaco,Courier New,monospace;word-break:break-word}#qa-col-modal table.data-table tr:last-child td{border-bottom:none}#qa-col-modal table.data-table tr:hover td{background:#c084fc14}#qa-col-modal table.data-table td.null-value{color:var(--qa-text-dim);opacity:.6;font-style:italic}#qa-col-modal table.data-table td.object-value{color:var(--qa-purple);font-size:clamp(11px,calc(11px * var(--qa-scale, 1)),11px)}.qa-loader-overlay{position:absolute;inset:0;z-index:100;background:#0f172af2;display:flex;flex-direction:column;align-items:center;justify-content:center;backdrop-filter:blur(8px)}.qa-loader-spinner{width:60px;height:60px;border:4px solid rgba(192,132,252,.2);border-top:4px solid var(--qa-cyan);border-radius:50%;animation:qa-spin 1s linear infinite;box-shadow:0 0 20px #c084fc73}@keyframes qa-spin{0%{transform:rotate(0)}to{transform:rotate(360deg)}}.qa-loader-text{margin-top:20px;color:var(--qa-cyan);font-size:clamp(11px,calc(14px * var(--qa-scale, 1)),14px);font-weight:600;text-shadow:0 0 10px rgba(192,132,252,.5)}.qa-loader-progress{margin-top:10px;color:var(--qa-text-dim);font-size:clamp(11px,calc(12px * var(--qa-scale, 1)),12px)}.qa-loader-cancel{margin-top:20px;padding:10px 20px;background:linear-gradient(135deg,#ef44444d,#ef444433);border:1px solid rgba(239,68,68,.5);border-radius:10px;color:#fca5a5;font-size:clamp(11px,calc(12px * var(--qa-scale, 1)),12px);font-weight:600;cursor:pointer;transition:all .25s cubic-bezier(.4,0,.2,1)}.qa-loader-cancel:hover{background:linear-gradient(135deg,#ef444480,#ef44444d);border-color:#ef4444b3;box-shadow:0 4px 16px #ef44444d;transform:translateY(-1px)}#qa-filters-modal{position:fixed;left:50%;top:6%;transform:translate(-50%);width:min(760px,88vw);max-height:80vh;overflow:hidden;background:var(--qa-bg);color:var(--qa-text);border-radius:12px;box-shadow:0 20px 60px #8b5cf652,0 0 0 1px #c084fc59,inset 0 0 0 1px #c084fc1f;display:none;flex-direction:column;backdrop-filter:blur(16px);z-index:1500;--qa-scale: .92;font-size:clamp(11px,calc(13px * var(--qa-scale, 1)),13px);transition:box-shadow .2s cubic-bezier(.4,0,.2,1)}#qa-filters-modal:hover{box-shadow:0 20px 60px #8b5cf652,0 0 0 1px #c084fc61,inset 0 0 10px #8b5cf638,inset 0 0 0 2px #c084fc52}#qa-filters-modal .hd{display:flex;align-items:center;gap:10px;padding:9px 12px;background:var(--qa-accent);border-bottom:1px solid var(--qa-border);cursor:move;user-select:none}#qa-filters-modal .title{background:linear-gradient(135deg,#c084fc,#c4b5fd);-webkit-background-clip:text;-webkit-text-fill-color:transparent;background-clip:text;font-weight:800;font-size:clamp(11px,calc(15px * var(--qa-scale, 1)),15px);letter-spacing:.4px;text-shadow:0 0 20px rgba(236,72,153,.3)}#qa-filters-modal .grow{flex:1}#qa-filters-modal .filters-tools{padding:14px;background:linear-gradient(135deg,#8b5cf614,#ec48990a);border-bottom:1px solid var(--qa-border)}#qa-filters-modal .filters-actions{display:flex;gap:8px;flex-wrap:wrap;align-items:center}#qa-filters-modal .btn-action{cursor:pointer;padding:8px 12px;border-radius:9px;background:linear-gradient(135deg,#8b5cf633,#c084fc26);border:1px solid rgba(192,132,252,.4);white-space:nowrap;transition:all .25s cubic-bezier(.4,0,.2,1);font-weight:600;font-size:clamp(11px,calc(12px * var(--qa-scale, 1)),12px);font-family:inherit;color:var(--qa-text);box-shadow:0 2px 6px #8b5cf626;display:flex;align-items:center;gap:7px}#qa-filters-modal .btn-action .icon{font-size:clamp(12px,calc(13px * var(--qa-scale, 1)),13px)}#qa-filters-modal .btn-action:hover{background:linear-gradient(135deg,#8b5cf659,#c084fc40);border-color:#c084fc99;box-shadow:0 4px 16px #8b5cf64d,0 0 0 3px #c084fc26;transform:translateY(-1px)}#qa-filters-modal .btn-action.primary{background:linear-gradient(135deg,#8b5cf6,#a855f7);border-color:#a855f7;color:#fff;font-weight:700;box-shadow:0 4px 14px #8b5cf666}#qa-filters-modal .btn-action.primary:hover{background:linear-gradient(135deg,#9333ea,#a855f7);box-shadow:0 5px 20px #8b5cf680,0 0 0 3px #8b5cf640;transform:translateY(-2px)}#qa-filters-modal .body{padding:16px;overflow:auto;flex:1}#qa-filters-modal .filter-content{width:100%}#qa-filters-modal pre.list{background:linear-gradient(135deg,#210d3ff2,#120929e6);border:1px solid rgba(192,132,252,.3);border-radius:12px;padding:14px;white-space:pre-wrap;word-break:break-word;font-size:clamp(11px,calc(12px * var(--qa-scale, 1)),12px);line-height:1.6;font-family:Consolas,Monaco,Courier New,monospace;color:#e2e8f0;margin:0;box-shadow:0 4px 16px #8b5cf626}#qa-filters-modal .body::-webkit-scrollbar{width:10px}#qa-filters-modal .body::-webkit-scrollbar-track{background:#0000004d;border-radius:10px}#qa-filters-modal .body::-webkit-scrollbar-thumb{background:linear-gradient(135deg,#c084fc80,#8b5cf699);border-radius:10px;border:2px solid transparent;background-clip:padding-box;box-shadow:0 0 8px #8b5cf666}#qa-filters-modal .body::-webkit-scrollbar-thumb:hover{background:linear-gradient(135deg,#c084fcb3,#8b5cf6cc);background-clip:padding-box;box-shadow:0 0 12px #8b5cf699}#qa-customize-modal{position:fixed;left:50%;top:6%;transform:translate(-50%);width:min(760px,88vw);max-height:80vh;overflow:hidden;background:var(--qa-bg);color:var(--qa-text);border-radius:12px;box-shadow:0 20px 60px #8b5cf652,0 0 0 1px #c084fc59,inset 0 0 0 1px #c084fc1f;display:none;flex-direction:column;backdrop-filter:blur(16px);z-index:1500;--qa-scale: .92;font-size:clamp(11px,calc(13px * var(--qa-scale, 1)),13px);transition:box-shadow .2s cubic-bezier(.4,0,.2,1)}#qa-customize-modal:hover{box-shadow:0 20px 60px #8b5cf652,0 0 0 1px #c084fc61,inset 0 0 10px #8b5cf638,inset 0 0 0 2px #c084fc52}#qa-customize-modal .hd{display:flex;align-items:center;gap:10px;padding:9px 12px;background:var(--qa-accent);border-bottom:1px solid var(--qa-border);cursor:move;user-select:none}#qa-customize-modal .title{background:linear-gradient(135deg,#c084fc,#c4b5fd);-webkit-background-clip:text;-webkit-text-fill-color:transparent;background-clip:text;font-weight:800;font-size:clamp(11px,calc(15px * var(--qa-scale, 1)),15px);letter-spacing:.4px;text-shadow:0 0 20px rgba(236,72,153,.3)}#qa-customize-modal .grow{flex:1}#qa-customize-modal .customize-tools{padding:14px;background:linear-gradient(135deg,#8b5cf614,#ec48990a);border-bottom:1px solid var(--qa-border)}#qa-customize-modal .customize-actions{display:flex;gap:8px;flex-wrap:wrap;align-items:center}#qa-customize-modal .btn-action{cursor:pointer;padding:8px 12px;border-radius:9px;background:linear-gradient(135deg,#8b5cf633,#c084fc26);border:1px solid rgba(192,132,252,.4);white-space:nowrap;transition:all .25s cubic-bezier(.4,0,.2,1);font-weight:600;font-size:clamp(11px,calc(12px * var(--qa-scale, 1)),12px);font-family:inherit;color:var(--qa-text);box-shadow:0 2px 6px #8b5cf626;display:flex;align-items:center;gap:7px}#qa-customize-modal .btn-action .icon{font-size:clamp(12px,calc(13px * var(--qa-scale, 1)),13px)}#qa-customize-modal .btn-action:hover{background:linear-gradient(135deg,#8b5cf659,#c084fc40);border-color:#c084fc99;box-shadow:0 4px 16px #8b5cf64d,0 0 0 3px #c084fc26;transform:translateY(-1px)}#qa-customize-modal .btn-action.primary{background:linear-gradient(135deg,#8b5cf6,#a855f7);border-color:#a855f7;color:#fff;font-weight:700;box-shadow:0 4px 14px #8b5cf666}#qa-customize-modal .btn-action.primary:hover{background:linear-gradient(135deg,#9333ea,#a855f7);box-shadow:0 5px 20px #8b5cf680,0 0 0 3px #8b5cf640;transform:translateY(-2px)}#qa-customize-modal .body{padding:16px;overflow:auto;flex:1}#qa-customize-modal .customize-content{width:100%}#qa-customize-modal .body::-webkit-scrollbar{width:10px}#qa-customize-modal .body::-webkit-scrollbar-track{background:#0000004d;border-radius:10px}#qa-customize-modal .body::-webkit-scrollbar-thumb{background:linear-gradient(135deg,#c084fc80,#8b5cf699);border-radius:10px;border:2px solid transparent;background-clip:padding-box;box-shadow:0 0 8px #8b5cf666}#qa-customize-modal .body::-webkit-scrollbar-thumb:hover{background:linear-gradient(135deg,#c084fcb3,#8b5cf6cc);background-clip:padding-box;box-shadow:0 0 12px #8b5cf699}.qa-resize-handle{position:absolute;background:transparent;border:none;opacity:0;z-index:11}.qa-resize-handle.resize-n,.qa-resize-handle.resize-s{left:0;right:0;height:8px}.qa-resize-handle.resize-n{top:0;cursor:ns-resize}.qa-resize-handle.resize-s{bottom:0;cursor:ns-resize}.qa-resize-handle.resize-e,.qa-resize-handle.resize-w{top:0;bottom:0;width:8px}.qa-resize-handle.resize-e{right:0;cursor:ew-resize}.qa-resize-handle.resize-w{left:0;cursor:ew-resize}.qa-resize-handle.resize-ne,.qa-resize-handle.resize-nw,.qa-resize-handle.resize-se,.qa-resize-handle.resize-sw{width:10px;height:10px;z-index:12}.qa-resize-handle.resize-ne{top:0;right:0;cursor:nesw-resize}.qa-resize-handle.resize-nw{top:0;left:0;cursor:nwse-resize}.qa-resize-handle.resize-se{bottom:0;right:0;cursor:nwse-resize}.qa-resize-handle.resize-sw{bottom:0;left:0;cursor:nesw-resize}.qa-tab{position:fixed;right:0;z-index:10001;width:26px;min-height:88px;padding:6px 0;display:flex;flex-direction:column;align-items:center;justify-content:center;gap:6px;color:var(--qa-text);background:var(--qa-tab-bg);border-left:2px solid var(--qa-border);border-top:1px solid var(--qa-border-muted);border-bottom:1px solid var(--qa-border-muted);border-top-left-radius:8px;border-bottom-left-radius:8px;box-shadow:-6px 0 24px #8b5cf64d;cursor:grab;user-select:none;backdrop-filter:blur(12px);transition:background .25s cubic-bezier(.4,0,.2,1),box-shadow .25s cubic-bezier(.4,0,.2,1),border-left-color .25s cubic-bezier(.4,0,.2,1)}.qa-tab.qa-tab--dragging{cursor:grabbing;box-shadow:-12px 0 36px #8b5cf68c}.qa-tab:hover{background:var(--qa-tab-hover);box-shadow:-10px 0 36px #8b5cf680;border-left-color:var(--qa-cyan);border-left-width:3px}.qa-tab:active{border-left-color:var(--qa-blue)}.qa-tab .label{writing-mode:vertical-rl;text-orientation:mixed;font-weight:700;font-size:8px;letter-spacing:.8px;text-transform:uppercase;flex:1;overflow:hidden;text-overflow:ellipsis;color:var(--qa-cyan);text-shadow:0 0 10px rgba(192,132,252,.5)}.qa-tab-close{margin-top:auto;width:18px;height:18px;border-radius:50%;border:1px solid rgba(192,132,252,.4);background:#0f172a8c;color:var(--qa-text);font-size:10px;display:flex;align-items:center;justify-content:center;cursor:pointer;transition:transform .18s ease,box-shadow .18s ease,background .18s ease}.qa-tab-close:hover{background:#9459ffcc;box-shadow:0 0 12px #c084fc8c;transform:scale(1.05)}.qa-tab-close:focus{outline:none;box-shadow:0 0 0 2px #ffffff4d,0 0 12px #c084fc99}@keyframes qa-tab-pulse{0%{transform:translate(0)}50%{transform:translate(-6px)}to{transform:translate(0)}}.qa-tab.qa-tab-pulse{animation:qa-tab-pulse .45s ease}#qa-col-modal .body::-webkit-scrollbar{width:10px}#qa-col-modal .body::-webkit-scrollbar-track{background:#0000004d;border-radius:10px}#qa-col-modal .body::-webkit-scrollbar-thumb{background:linear-gradient(135deg,#c084fc80,#8b5cf699);border-radius:10px;border:2px solid transparent;background-clip:padding-box;box-shadow:0 0 8px #8b5cf666}#qa-col-modal .body::-webkit-scrollbar-thumb:hover{background:linear-gradient(135deg,#c084fcb3,#8b5cf6cc);background-clip:padding-box;box-shadow:0 0 12px #8b5cf699}#qa-compare-modal{position:fixed;left:50%;top:6%;transform:translate(-50%);width:min(860px,90vw);max-height:82vh;overflow:hidden;background:var(--qa-bg);color:var(--qa-text);border-radius:12px;box-shadow:0 20px 60px #8b5cf652,0 0 0 1px #c084fc59,inset 0 0 0 1px #c084fc1f;display:none;flex-direction:column;backdrop-filter:blur(16px);z-index:1500;--qa-scale: .92;font-size:clamp(11px,calc(13px * var(--qa-scale, 1)),13px);transition:box-shadow .2s cubic-bezier(.4,0,.2,1)}#qa-compare-modal:hover{box-shadow:0 20px 60px #8b5cf652,0 0 0 1px #c084fc61,inset 0 0 10px #8b5cf638,inset 0 0 0 2px #c084fc52}#qa-compare-modal .hd{display:flex;align-items:center;gap:10px;padding:9px 12px;background:var(--qa-accent);border-bottom:1px solid var(--qa-border);cursor:move;user-select:none}#qa-compare-modal .title{background:linear-gradient(135deg,#c084fc,#c4b5fd);-webkit-background-clip:text;-webkit-text-fill-color:transparent;background-clip:text;font-weight:800;font-size:clamp(11px,calc(15px * var(--qa-scale, 1)),15px);letter-spacing:.4px;text-shadow:0 0 20px rgba(236,72,153,.3)}#qa-compare-modal .grow{flex:1}#qa-compare-modal .tools{padding:16px;background:linear-gradient(135deg,#8b5cf614,#ec48990a);border-bottom:1px solid var(--qa-border)}#qa-compare-modal .section{margin-bottom:14px}#qa-compare-modal .section:last-child{margin-bottom:0}#qa-compare-modal .section-title{color:var(--qa-cyan);font-size:clamp(11px,calc(11px * var(--qa-scale, 1)),11px);font-weight:800;text-transform:uppercase;letter-spacing:.9px;margin-bottom:8px;text-shadow:0 0 9px rgba(192,132,252,.45)}#qa-compare-modal .info-box{padding:12px 16px;background:linear-gradient(135deg,#8b5cf62e,#ec48991f);border-radius:12px;border:1px solid rgba(192,132,252,.42);color:var(--qa-text);font-size:clamp(11px,calc(13px * var(--qa-scale, 1)),13px);line-height:1.7;box-shadow:inset 0 1px #ffffff0f,0 16px 36px #20123e6b;backdrop-filter:blur(18px)}.status-box{padding:14px 16px;border-radius:12px;border:1px solid var(--qa-border);background:linear-gradient(135deg,#7a2db347,#36185c52);color:var(--qa-text-muted);font-size:clamp(11px,calc(13px * var(--qa-scale, 1)),13px);line-height:1.6;box-shadow:0 10px 28px #8b5cf633;transition:all .25s cubic-bezier(.4,0,.2,1)}.status-box.is-ready{border-color:#22c55e73;background:linear-gradient(135deg,#22c55e38,#7a2db347);color:#bbf7d0;box-shadow:0 14px 38px #22c55e59}.status-box.is-waiting{border-color:#c084fc40;background:linear-gradient(135deg,#7a2db338,#210d3f47);color:var(--qa-text-muted);box-shadow:0 10px 26px #8b5cf62e}#qa-compare-modal .info-box i{margin:0 2px}#qa-compare-modal .filter-row{display:flex;gap:10px;align-items:stretch}#qa-compare-modal .filter-row label{flex:1;display:flex;flex-direction:column;gap:6px;color:var(--qa-text-dim);font-size:clamp(11px,calc(11px * var(--qa-scale, 1)),11px);font-weight:700;text-transform:uppercase;letter-spacing:.5px}#qa-compare-modal .filter-row label span{opacity:.9;background:linear-gradient(135deg,#c084fc66,#ec48994d);padding:4px 8px;border-radius:6px;display:inline-block;width:fit-content}#qa-compare-modal select,#qa-compare-modal input[type=text]{background:var(--qa-surface-strong);color:#f1f5f9f2;border:2px solid rgba(192,132,252,.3);border-radius:12px;padding:10px 14px;font-size:clamp(12px,calc(13px * var(--qa-scale, 1)),13px);width:100%;transition:all .3s cubic-bezier(.4,0,.2,1);font-family:inherit;font-weight:500;box-shadow:0 4px 16px #8b5cf614,inset 0 1px #ffffff0a}#qa-compare-modal select:focus,#qa-compare-modal input[type=text]:focus{outline:none;border-color:#8b5cf6b3;box-shadow:0 0 0 3px #8b5cf626,0 8px 32px #8b5cf640,inset 0 1px #ffffff14,inset 0 0 20px #8b5cf61a;background:linear-gradient(135deg,#36185cf0,#1a0e3af5)}#qa-compare-modal select:hover,#qa-compare-modal input[type=text]:hover{border-color:#c084fc73;box-shadow:0 6px 24px #8b5cf61f,inset 0 1px #ffffff0d}#qa-compare-modal .actions-row{display:flex;gap:8px;flex-wrap:wrap;align-items:center;padding-top:2px}#qa-compare-modal .diff-toggle{display:inline-flex;align-items:center;gap:8px;padding:9px 14px;border-radius:8px;border:1px solid rgba(192,132,252,.3);background:linear-gradient(135deg,#8b5cf61f,#c084fc14);color:var(--qa-text-dim);font-size:clamp(11px,calc(11px * var(--qa-scale, 1)),11px);font-weight:600;cursor:pointer;user-select:none;box-shadow:0 2px 6px #8b5cf61f;transition:all .25s cubic-bezier(.4,0,.2,1)}#qa-compare-modal label{margin:0}#qa-compare-modal .diff-toggle:hover{border-color:#c084fc80;background:linear-gradient(135deg,#8b5cf62e,#c084fc1f)}#qa-compare-modal .diff-toggle i{font-size:18px;color:var(--qa-text-dim);transition:color .25s cubic-bezier(.4,0,.2,1)}#qa-compare-modal .diff-toggle i.fa-toggle-on{color:var(--qa-blue)}#qa-compare-modal .diff-toggle span{color:var(--qa-text-dim);font-size:clamp(11px,calc(11px * var(--qa-scale, 1)),11px)}#qa-compare-modal select{background:linear-gradient(135deg,#2b1147e6,#160c30eb);color:var(--qa-text);border:1px solid rgba(192,132,252,.35);border-radius:9px;padding:8px 11px;font-size:clamp(11px,calc(12px * var(--qa-scale, 1)),12px);width:100%;transition:all .25s cubic-bezier(.4,0,.2,1);font-family:inherit;box-shadow:0 2px 7px #8b5cf61a}#qa-compare-modal select option{background:#2a163e;color:#f5e8ff;padding:8px 12px}#qa-compare-modal select option:hover,#qa-compare-modal select option:checked{background:#3a1d52;color:#f1ddff}#qa-compare-modal select:focus{outline:none;border-color:var(--qa-blue-bright);box-shadow:0 0 0 3px #c084fc38,0 4px 12px #8b5cf640;background:linear-gradient(135deg,#2d124bf2,#180d34f5)}#qa-compare-modal select:hover{border-color:#c084fc80;box-shadow:0 4px 12px #8b5cf626}#qa-compare-modal .btn{cursor:pointer;padding:8px 12px;border-radius:9px;background:linear-gradient(135deg,#8b5cf633,#c084fc26);border:1px solid rgba(192,132,252,.4);white-space:nowrap;transition:all .25s cubic-bezier(.4,0,.2,1);font-weight:600;font-size:clamp(11px,calc(12px * var(--qa-scale, 1)),12px);font-family:inherit;color:var(--qa-text);box-shadow:0 2px 6px #8b5cf626}#qa-compare-modal .btn.disabled,#qa-compare-modal .btn:disabled{opacity:.5;cursor:not-allowed;pointer-events:none;box-shadow:none;filter:grayscale(.2)}#qa-compare-modal .btn:hover{background:linear-gradient(135deg,#8b5cf659,#c084fc40);border-color:#c084fc99;box-shadow:0 4px 16px #8b5cf64d,0 0 0 3px #c084fc26;transform:translateY(-1px)}#qa-compare-modal .btn-primary{background:linear-gradient(135deg,#8b5cf6,#a855f7);border-color:#a855f7;color:#fff;font-weight:700;box-shadow:0 4px 14px #8b5cf666}#qa-compare-modal .btn-primary:hover{background:linear-gradient(135deg,#9333ea,#a855f7);box-shadow:0 5px 20px #8b5cf680,0 0 0 3px #8b5cf640;transform:translateY(-2px)}#qa-compare-modal .stat{color:var(--qa-cyan);font-size:clamp(11px,calc(12px * var(--qa-scale, 1)),12px);font-weight:600;padding:7px 12px;background:linear-gradient(135deg,#c084fc2e,#c084fc1a);border-radius:8px;border:1px solid rgba(192,132,252,.3);box-shadow:0 2px 7px #c084fc2e}#qa-compare-modal .body{padding:16px;overflow:auto;flex:1}#qa-compare-modal pre.list{background:linear-gradient(135deg,#210d3ff2,#120929e6);border:1px solid rgba(192,132,252,.28);border-radius:10px;padding:12px;white-space:pre-wrap;word-break:break-word;font-size:clamp(11px,calc(12px * var(--qa-scale, 1)),12px);line-height:1.6;font-family:Consolas,Monaco,Courier New,monospace;color:#e2e8f0;margin:0;box-shadow:0 4px 16px #8b5cf626}#qa-compare-modal table.data-table{width:100%;border-collapse:collapse;background:linear-gradient(135deg,#210d3ff2,#120929e6);border:1px solid rgba(192,132,252,.28);border-radius:10px;box-shadow:0 3px 14px #8b5cf624;overflow:hidden}#qa-compare-modal table.data-table th{background:linear-gradient(135deg,#8b5cf640,#c084fc26);color:var(--qa-cyan);font-size:clamp(11px,calc(11px * var(--qa-scale, 1)),11px);font-weight:800;text-transform:uppercase;letter-spacing:.7px;padding:10px 12px;text-align:left;border-bottom:2px solid rgba(192,132,252,.4);position:sticky;top:0;z-index:10;text-shadow:0 0 8px rgba(192,132,252,.3)}#qa-compare-modal table.data-table td{padding:8px 12px;font-size:clamp(11px,calc(12px * var(--qa-scale, 1)),12px);color:#e2e8f0;border-bottom:1px solid rgba(192,132,252,.15);font-family:Consolas,Monaco,Courier New,monospace;word-break:break-word}#qa-compare-modal table.data-table tr:last-child td{border-bottom:none}#qa-compare-modal table.data-table tr:hover td{background:#c084fc14}#qa-compare-modal table.data-table td.null-value{color:var(--qa-text-dim);opacity:.6;font-style:italic}#qa-compare-modal table.compare-table tbody tr:nth-child(2n) td{background:#a855f714}#qa-compare-modal table.compare-table tbody tr td:first-child{border-right:1px solid rgba(192,132,252,.18)}#qa-compare-modal table.compare-table td{font-family:Inter,Segoe UI,Roboto,sans-serif;letter-spacing:.2px}#qa-compare-modal .body::-webkit-scrollbar{width:10px}#qa-compare-modal .body::-webkit-scrollbar-track{background:#0000004d;border-radius:10px}#qa-compare-modal .body::-webkit-scrollbar-thumb{background:linear-gradient(135deg,#c084fc80,#8b5cf699);border-radius:10px;border:2px solid transparent;background-clip:padding-box;box-shadow:0 0 8px #8b5cf666}#qa-compare-modal .body::-webkit-scrollbar-thumb:hover{background:linear-gradient(135deg,#c084fcb3,#8b5cf6cc);background-clip:padding-box;box-shadow:0 0 12px #8b5cf699}pre.json-customize{background:linear-gradient(135deg,#210d3ff2,#120929e6);padding:14px;border-radius:8px;overflow:auto;max-height:100%;font-family:Consolas,Monaco,Courier New,monospace;font-size:11px;line-height:1.6;color:#e2e8f0;border:1px solid rgba(192,132,252,.3);margin:0;word-break:break-word;white-space:pre-wrap}pre.json-customize .json-key{color:#c084fc;font-weight:600}pre.json-customize .json-string{color:#34d399}pre.json-customize .json-number{color:#a855f7}pre.json-customize .json-bool,pre.json-customize .json-null{color:#f87171;font-weight:600}.qa-json-modal{position:fixed;top:50%;left:50%;transform:translate(-50%,-50%);background:var(--qa-bg);border:1px solid var(--qa-border);border-radius:14px;padding:20px;z-index:20000;width:90%;max-width:500px;box-shadow:0 20px 60px #0000004d;font-family:inherit}.qa-json-modal-title{margin-bottom:12px;font-weight:600;color:var(--qa-text)}.qa-json-modal textarea{width:100%;height:200px;padding:12px;background:var(--qa-bg-secondary, rgba(15, 23, 42, .5));border:1px solid var(--qa-border);border-radius:8px;font-family:Consolas,Monaco,Courier New,monospace;font-size:12px;color:var(--qa-text);resize:vertical;box-sizing:border-box}.qa-json-modal-buttons{display:flex;gap:10px;margin-top:16px}.qa-json-modal button{flex:1;padding:10px;border-radius:8px;font-weight:600;cursor:pointer;transition:all .25s;border:none}.qa-json-modal .btn-ok{background:linear-gradient(135deg,#8b5cf6,#a855f7);border:1px solid #a855f7;color:#fff}.qa-json-modal .btn-ok:hover{box-shadow:0 8px 24px #8b5cf666;transform:translateY(-2px)}.qa-json-modal .btn-cancel{background:#c084fc33;border:1px solid rgba(192,132,252,.4);color:var(--qa-text)}.qa-json-modal .btn-cancel:hover{background:#c084fc4d;border-color:#c084fc80}
`;M();W();le();M();_();G();function ve(e,t={}){if(!e)return null;let{message:a="Loading data...",progress:o="Preparing...",cancellable:r=!1,cancelLabel:n="Cancel",onCancel:s}=t,c=document.createElement("div");c.className="qa-loader-overlay",c.innerHTML=`<div class="qa-loader-spinner"></div><div class="qa-loader-text"></div><div class="qa-loader-progress"></div><button class="qa-loader-cancel">${n}</button>`;let i=c.querySelector(".qa-loader-text"),u=c.querySelector(".qa-loader-progress"),d=c.querySelector(".qa-loader-cancel");return i&&(i.textContent=a),u&&(u.textContent=o),d&&(r?d.addEventListener("click",()=>{typeof s=="function"&&s()}):d.remove()),e.appendChild(c),{element:c,setMessage(p){i&&(i.textContent=p)},setProgress(p){u&&(u.textContent=p)},remove(){c.remove()}}}M();function zt(e){return Number.isFinite(e)}function ke(e=l.lastPayload){if(!e||typeof e!="object")return null;let t=e.totalRows??e.recordsFiltered??e.recordsTotal;return zt(t)?t:null}function wa(e){return JSON.stringify({column:e,direction:"desc"})}function Et(e,t){!e||!t||e.set("order",wa(t))}function va(e){return typeof e=="function"&&e()}function ka(e){return new Promise(t=>setTimeout(t,e))}async function Ce(e,t={}){if(!e)throw new Error("Missing table request info");let{columnName:a="",pageSize:o=200,shouldCancel:r,onProgress:n,requestDelay:s=100}=t,{url:c,requestData:i}=e,u=new URLSearchParams(i);u.set("start","0"),u.set("length",String(o)),Et(u,a);let d=()=>$.ajax({url:c,method:"POST",data:u.toString(),contentType:"application/x-www-form-urlencoded; charset=UTF-8",dataType:"json",headers:{"X-Requested-With":"XMLHttpRequest"}}),p=await d(),m=p.recordsFiltered??p.recordsTotal??p.totalRows??0,b=zt(m)?m:0,x=Array.isArray(p.data)?[...p.data]:[];typeof n=="function"&&n({loaded:x.length,totalRows:b,isFirstBatch:!0});let g=x.length;for(;x.length<b;){if(va(r)){let q=new Error("Cancelled");throw q.name="FetchCancelledError",q}u.set("start",String(g)),u.set("length",String(o)),Et(u,a);let h=await d(),S=Array.isArray(h.data)?h.data:[];if(S.length===0)break;x=x.concat(S),g+=o,typeof n=="function"&&n({loaded:x.length,totalRows:b}),s>0&&await ka(s)}return{rows:x,totalRows:b,firstResponse:p}}W();be();var Sa="qa-columns-modal",K=new E({id:"qa-col-modal",layoutId:Sa,minWidth:520,minHeight:320});function N(){let e=document.getElementById("qa-load-all");if(!e)return;let t=!!(l.lastRequestInfo&&l.lastPayload),a="Load full table data",o=ke(l.lastPayload);e.disabled=!t,e.textContent=o!=null?`${a} (${o})`:a}function Ea(){if(document.getElementById("qa-col-modal"))return;let e=document.createElement("div");e.id="qa-col-modal",e.className="card qa-modal qa-modal-visible",e.innerHTML='<div class="hd" id="qa-col-drag"><span class="title">Last table response</span> <span class="grow"></span><div class="qa-window-controls"><button type="button" class="qa-window-btn qa-window-btn--close" id="qa-col-close" title="Close" aria-label="Close" data-icon="\xD7"></button> <button type="button" class="qa-window-btn qa-window-btn--reset" id="qa-col-reset" title="Reset layout" aria-label="Reset layout" data-icon="\u21BA"></button> <button type="button" class="qa-window-btn qa-window-btn--collapse" id="qa-col-collapse" title="Collapse" aria-label="Collapse" data-icon="\u2013"></button></div></div><div class="tools"><div class="section"><div class="section-title"><i class="fa fa-search"></i> Filtering</div><div class="filter-row"><label><span><i class="fa fa-search"></i> Substring search</span> <input id="qa-col-filter" placeholder="Type to filter..."></label></div></div><div class="section"><div class="section-title">\u{1F4CA} Column selection</div><div class="pickers-grid" id="qa-col-pickers"></div></div><div class="section"><div class="section-title">\u26A1 Actions</div><div class="actions-row"><button class="btn btn-primary" id="qa-load-all" disabled>Load full table data</button> <button class="btn" id="qa-col-add">\u2795 Add column</button><div class="mode-toggle"><button class="active" data-mode="json">\u{1F4C4} JSON</button> <button data-mode="table">\u{1F4CA} Table</button></div><button class="btn btn-copy" id="qa-col-copy">\u{1F4CB} Copy state JSON</button> <button class="btn" id="qa-col-csv"><i class="fa fa-save"></i> Generate CSV</button> <span class="stat" id="qa-col-stat"></span></div></div></div><div class="body"></div>',document.body.appendChild(e),document.getElementById("qa-col-close")?.addEventListener("click",()=>It()),document.getElementById("qa-col-reset")?.addEventListener("click",()=>{K.resetLayout(),N()}),document.getElementById("qa-col-collapse")?.addEventListener("click",()=>{document.getElementById("qa-col-modal")&&(K.saveCurrentLayout(),C("qa-col-modal","Last table response",()=>{v("qa-col-modal"),Mt(),N()}),It(!0))}),document.getElementById("qa-col-add")?.addEventListener("click",()=>Lt()),document.getElementById("qa-col-filter")?.addEventListener("input",T),document.getElementById("qa-col-copy")?.addEventListener("click",La),document.getElementById("qa-col-csv")?.addEventListener("click",Fa),document.getElementById("qa-load-all")?.addEventListener("click",za),document.querySelectorAll(".mode-toggle button").forEach(o=>{o.addEventListener("click",()=>{l.displayMode=o.dataset.mode||"json",document.querySelectorAll(".mode-toggle button").forEach(r=>r.classList.remove("active")),o.classList.add("active"),T()})}),Lt();let t=document.getElementById("qa-col-modal"),a=document.getElementById("qa-col-drag");K.attach(t,{dragHandle:a})}function Tt(){if(Ea(),v("qa-col-modal"),!l.lastPayload){let e=ce();e&&(l.lastPayload=e)}Xe(),T(),Mt(),N()}function At(){jt()&&(Xe(),T(),N())}function za(){if(!l.lastRequestInfo){f("\u26A0\uFE0F No request info available");return}if(l.isLoadingAll){f("\u26A0\uFE0F Full load already in progress");return}l.isLoadingAll=!0,l.cancelLoadingAll=!1;let e=document.getElementById("qa-col-modal");if(!e)return;let t=ve(e,{cancellable:!0,onCancel:()=>{l.cancelLoadingAll=!0,f("\u23F3 Cancelling...")}});(async()=>{let o=I()[0]||"";try{f("\u{1F504} Loading full dataset...");let{rows:r,totalRows:n,firstResponse:s}=await Ce(l.lastRequestInfo,{columnName:o,shouldCancel:()=>l.cancelLoadingAll,onProgress:({loaded:c,totalRows:i})=>{t?.setProgress(`${c} / ${i}`)}});if(l.cancelLoadingAll){f("\u26A0\uFE0F Loading cancelled");return}l.lastPayload={...s,data:r,recordsTotal:n,recordsFiltered:n},ie(l.lastPayload),we(l.lastPayload),Xe(),T(),f(`\u2705 Loaded ${r.length} rows`)}catch(r){r&&r.name==="FetchCancelledError"?f("\u26A0\uFE0F Loading cancelled"):(console.error("[QA Helper] Load all error:",r),f(`\u274C Error: ${r.message||r}`),alert(`Failed to load data: ${r.message}`))}finally{t?.remove(),l.isLoadingAll=!1,l.cancelLoadingAll=!1}})()}function Z(){return Array.from(document.querySelectorAll("#qa-col-pickers select"))}function Lt(){let e=document.getElementById("qa-col-pickers");if(!e)return;let t=Z();if(t.length>=8)return;let a=document.createElement("div");a.className="picker-item",a.innerHTML=`<div class="picker-header"><label>Column ${t.length+1}</label> <span class="picker-remove" title="Remove">\u2715</span></div><select></select>`,e.appendChild(a);let o=a.querySelector("select");Bt(o),a.querySelector(".picker-remove")?.addEventListener("click",()=>{a.remove(),Ft(),T()}),o?.addEventListener("change",T),Ft(),T()}function Ft(){Z().forEach((t,a)=>{let o=t.closest(".picker-item")?.querySelector("label");o&&(o.textContent=`Column ${a+1}`)})}function Xe(){Z().forEach(e=>Bt(e))}function Bt(e){if(!e)return;e.innerHTML="";let t=l.lastPayload||ce(),a=Array.isArray(t?.data)?t.data:[],o=a.length?Object.keys(a[0]):[],r=new Set(Z().filter(s=>s!==e).map(s=>s.value).filter(Boolean)),n=document.createElement("option");if(n.value="",n.textContent=o.length?"-- select column --":"-- no data --",e.appendChild(n),o.sort((s,c)=>s.localeCompare(c,"en",{sensitivity:"base"})).forEach(s=>{let c=document.createElement("option");c.value=s,c.textContent=s,r.has(s)&&(c.disabled=!0),e.appendChild(c)}),!e.value){let s=Array.from(e.options).find(c=>c.value&&!c.disabled);s&&(e.value=s.value)}}function I(){return Z().map(e=>e.value).filter(Boolean)}function Ke(){let e=l.lastPayload||ce(),t=Array.isArray(e?.data)?e.data:[],a=I(),r=(document.getElementById("qa-col-filter")?.value||"").toLowerCase();if(!a.length)return{mode:"empty",data:[],total:0,unique:0};let n=[];for(let d of t){if(!r){n.push(d);continue}a.some(m=>{let b=d?.[m];return typeof b=="object"&&b!==null&&(b=JSON.stringify(b)),(b==null?"":String(b).toLowerCase()).includes(r)})&&n.push(d)}let s=a[0],c=n.map(d=>{let p=d?.[s];return typeof p=="object"&&p!==null?JSON.stringify(p):p==null?"":String(p)}),i=new Set(c).size;if(a.length===1)return{mode:"single",data:c,total:c.length,unique:i};let u=n.map(d=>{let p={};for(let m of a){let b=d?.[m];p[m]=typeof b=="object"&&b!==null?b:b??null}return p});return{mode:"multi",data:u,total:u.length,unique:i}}function T(){let e=document.getElementById("qa-col-stat"),t=document.getElementById("qa-col-copy"),a=document.querySelector("#qa-col-modal .body"),o=document.querySelector("#qa-col-modal .mode-toggle");if(!e||!t||!a||!o)return;let{mode:r,data:n,total:s,unique:c}=Ke();if(o.querySelectorAll("button").forEach(i=>{i.classList.toggle("active",i.dataset.mode===l.displayMode)}),r==="single"){if(o.hidden=!1,t.innerHTML=l.displayMode==="table"?"\u{1F4CB} Copy values":"\u{1F4CB} Copy state JSON",l.displayMode==="table"){let u=I()[0],d='<table class="data-table"><thead><tr>';d+=`<th>${u}</th>`,d+="</tr></thead><tbody>",n.forEach(p=>{d+="<tr>",p==null||p===""?d+='<td class="null-value">\u2014</td>':d+=`<td>${p}</td>`,d+="</tr>"}),d+="</tbody></table>",a.innerHTML=d}else{let u=I()[0],d=n.map(p=>({[u]:p}));a.innerHTML=R(d)}e.textContent=`\u{1F4CA} Rows: ${s} \u2022 Unique: ${c}`}else if(r==="multi"){if(o.hidden=!1,t.innerHTML="\u{1F4CB} Copy state JSON",l.displayMode==="table"){let i=I(),u='<table class="data-table"><thead><tr>';i.forEach(d=>{u+=`<th>${d}</th>`}),u+="</tr></thead><tbody>",n.forEach(d=>{u+="<tr>",i.forEach(p=>{let m=d[p];m==null?u+='<td class="null-value">\u2014</td>':typeof m=="object"?u+=`<td class="object-value">${JSON.stringify(m)}</td>`:u+=`<td>${String(m)}</td>`}),u+="</tr>"}),u+="</tbody></table>",a.innerHTML=u}else a.innerHTML=R(n);e.textContent=`\u{1F4E6} Objects: ${s} \u2022 Unique: ${c}`}else o.hidden=!0,t.innerHTML="\u{1F4CB} Copy",a.innerHTML='<pre class="list">(no data)</pre>',e.textContent=""}function La(){let{mode:e,data:t}=Ke();if(e==="single"){let o=I()[0];if(l.displayMode==="json"){let r=(t||[]).map(n=>({[o]:n}));GM_setClipboard(JSON.stringify(r,null,2),"text"),f("\u2705 JSON copied")}else GM_setClipboard((t||[]).join(`
`),"text"),f("\u2705 List copied")}else e==="multi"?(GM_setClipboard(JSON.stringify(t||[],null,2),"text"),f("\u2705 JSON copied")):f("\u26A0\uFE0F No data available")}function Fa(){let{mode:e,data:t}=Ke();if(e==="empty"||!t||t.length===0){f("\u26A0\uFE0F Nothing to export");return}let a="";if(e==="single")a=I()[0]+`
`+t.map(Ge).join(`
`);else{let s=I();a=s.map(Ge).join(",")+`
`,t.forEach(c=>{let i=s.map(u=>{let d=c[u];return d==null?"":typeof d=="object"?JSON.stringify(d):String(d)});a+=i.map(Ge).join(",")+`
`})}let o=new Blob(["\uFEFF"+a],{type:"text/csv;charset=utf-8;"}),r=document.createElement("a"),n=URL.createObjectURL(o);r.href=n,r.download=`qa-export-${Date.now()}.csv`,r.hidden=!0,document.body.appendChild(r),r.click(),document.body.removeChild(r),f("\u2705 CSV exported")}function Ge(e){if(e==null)return'""';let t=String(e);return t.includes(",")||t.includes('"')||t.includes(`
`)||t.includes("\r")?'"'+t.replace(/"/g,'""')+'"':t}function Mt(){let e=document.getElementById("qa-col-modal");e&&(e.style.display="",e.classList.add("qa-modal-visible"),K.applyLayout(),K.focus(),N())}function It(e=!1){let t=document.getElementById("qa-col-modal");t&&t.classList.remove("qa-modal-visible")}function jt(){return!!document.getElementById("qa-col-modal")}window.addEventListener("qaPayloadUpdated",()=>{(jt()||document.getElementById("qa-load-all"))&&N()});M();_();G();W();var Ia="qa-compare-modal",ee=new E({id:"qa-compare-modal",layoutId:Ia,minWidth:520,minHeight:320,baseWidth:860});function Ta(){if(document.getElementById("qa-compare-modal"))return;let e=document.createElement("div");e.id="qa-compare-modal",e.className="card",e.innerHTML='<div class="hd" id="qa-compare-drag"><span class="title">Column Filter</span> <span class="grow"></span><div class="qa-window-controls"><button type="button" class="qa-window-btn qa-window-btn--close" id="qa-compare-close" title="Close" aria-label="Close" data-icon="\xD7"></button> <button type="button" class="qa-window-btn qa-window-btn--reset" id="qa-compare-reset" title="Reset layout" aria-label="Reset layout" data-icon="\u21BA"></button> <button type="button" class="qa-window-btn qa-window-btn--collapse" id="qa-compare-collapse" title="Collapse" aria-label="Collapse" data-icon="\u2013"></button></div></div><div class="tools"><div class="section"><div class="section-title"><i class="fa fa-search"></i> Filtering</div><div class="filter-row"><label><span><i class="fa fa-search"></i> Substring search</span> <input id="qa-compare-filter" placeholder="Type to filter..."></label></div></div><div class="section"><div class="section-title">\u{1F4CB} How to use</div><div class="info-box">1. Open the needed column filter in the table (click the button <i class="fa fa-filter" style="color:#656c71"></i>)<br>2. Wait until dropdown data loads<br>3. Close the dropdown (the request will be intercepted automatically)<br>4. Click "Load full table data" below</div></div><div class="section"><div class="section-title">\u{1F3AF} Interception status</div><div id="qa-compare-column-info" class="status-box">Waiting for dropdown selection\u2026</div></div><div class="section"><div class="section-title">\u26A1 Actions</div><div class="actions-row"><button class="btn btn-primary" id="qa-compare-load-all" disabled>Load full table data</button> <button class="btn" id="qa-compare-export-csv" disabled><i class="fa fa-save"></i> Export CSV</button> <label class="diff-toggle"><input type="checkbox" id="qa-compare-only-diff" class="hidden-input"> <i class="fa fa-toggle-off" id="qa-compare-toggle-icon"></i> <span>Only differences</span></label> <span class="stat" id="qa-compare-stat"></span></div></div></div><div class="body"></div>',document.body.appendChild(e),document.getElementById("qa-compare-close")?.addEventListener("click",()=>Nt()),document.getElementById("qa-compare-reset")?.addEventListener("click",()=>{ee.resetLayout(),A()}),document.getElementById("qa-compare-collapse")?.addEventListener("click",()=>{document.getElementById("qa-compare-modal")&&(ee.saveCurrentLayout(),C("qa-compare-modal","Column Filter",()=>{v("qa-compare-modal"),Wt(),A()}),Nt(!0))}),document.getElementById("qa-compare-load-all")?.addEventListener("click",Aa),document.getElementById("qa-compare-export-csv")?.addEventListener("click",Ba);let t=document.getElementById("qa-compare-filter");t&&t.addEventListener("input",s=>{l.compareFilterText=(s.target?.value??"").trim(),te()});let a=document.getElementById("qa-compare-only-diff"),o=document.getElementById("qa-compare-toggle-icon");document.querySelector(".diff-toggle")?.addEventListener("click",s=>{s.preventDefault(),a instanceof HTMLInputElement&&(a.checked=!a.checked,l.compareShowOnlyDiff=!!a.checked,o&&(o.className=a.checked?"fa fa-toggle-on":"fa fa-toggle-off"),te())});let n=document.getElementById("qa-compare-modal");ee.attach(n,{dragHandle:"qa-compare-drag"})}function Pt(){Ta(),v("qa-compare-modal");try{typeof window.columnsFilter<"u"&&window.columnsFilter&&(l.columnsFilterConfig=window.columnsFilter)}catch(o){console.error("[QA Helper] Error getting columnsFilter config:",o)}let e=document.getElementById("qa-compare-column"),t=l.lastDropdownRequest?.search_column||l.compareSelectedColumn||"";if(e){e.innerHTML='<option value="">-- select column --</option>';let o=Array.isArray(l.lastPayload?.data)?l.lastPayload.data:[],r=o.length?Object.keys(o[0]):[];r.length===0?e.innerHTML='<option value="">-- no table data --</option>':[...r].sort((s,c)=>s.localeCompare(c,"en",{sensitivity:"base"})).forEach(s=>{let c=document.createElement("option");c.value=s,c.textContent=s,e.appendChild(c)}),e.removeEventListener("change",Rt),e.addEventListener("change",Rt),t&&(e.value=t)}l.compareTableData=[],l.compareDropdownData=[],l.compareSelectedColumn=t,l.compareShowOnlyDiff=!1;let a=document.getElementById("qa-compare-only-diff");a instanceof HTMLInputElement&&(a.checked=!1),te(),A(),Wt()}function $t(e){let t=new URLSearchParams(e);if(!(t.has("dropdown_search")||t.has("dropdown_search[0][column]")))return;l.lastDropdownRequest={url:l.lastRequestInfo?.url||window.location.href,requestData:e};let o=t.get("search_column");if(o){l.lastDropdownRequest.search_column=o,l.compareSelectedColumn=o;let r=document.getElementById("qa-compare-column");r&&(r.value=o)}console.log("[QA Helper] Dropdown request intercepted for column:",o),A()}function A(){let e=document.getElementById("qa-compare-column-info"),t=document.getElementById("qa-compare-load-all");if(!e||!t)return;let a="Load full table data",o=ke(l.lastPayload);t.textContent=o!=null?`${a} (${o})`:a;let r=!!l.lastDropdownRequest,n=!!(l.lastRequestInfo&&l.lastPayload);if(r&&n){let s=l.lastDropdownRequest.search_column||"unknown";e.classList.remove("is-waiting"),e.classList.add("is-ready"),e.innerHTML=`\u2705 Intercepted dropdown column: <code>${Ze(s)}</code>`,t.disabled=!1}else e.classList.remove("is-ready"),e.classList.add("is-waiting"),r?n?e.textContent="Waiting for intercepted data\u2026":e.textContent="Waiting for table response\u2026":e.textContent="Waiting for dropdown selection\u2026",t.disabled=!0}function Rt(){let e=document.getElementById("qa-compare-column");l.compareSelectedColumn=e?e.value:"",l.compareTableData=[],l.compareDropdownData=[],l.compareShowOnlyDiff=!1;let t=document.getElementById("qa-compare-only-diff");t instanceof HTMLInputElement&&(t.checked=!1),te()}async function Aa(){if(!l.lastDropdownRequest){f("\u26A0\uFE0F Open the dropdown filter in the table first");return}if(!l.lastRequestInfo){f("\u26A0\uFE0F Missing table request info");return}let e=l.compareSelectedColumn||l.lastDropdownRequest.search_column||"";if(!e){f("\u26A0\uFE0F Unable to determine column for comparison");return}l.compareSelectedColumn=e,l.compareFilterText="";let t=document.getElementById("qa-compare-filter");t&&(t.value="");let a=document.getElementById("qa-compare-modal");if(!a)return;let o=document.getElementById("qa-compare-column");o&&o.value!==e&&(o.value=e);try{typeof window.columnsFilter<"u"&&window.columnsFilter&&(l.columnsFilterConfig=window.columnsFilter)}catch(n){console.error("[QA Helper] Error getting columnsFilter config:",n)}let r=ve(a);try{r?.setProgress("Step 1/2: Loading table data...");let{rows:n}=await Ce(l.lastRequestInfo,{columnName:e,onProgress:({loaded:g,totalRows:h})=>{r?.setProgress(`Step 1/2: Table ${g} / ${h}`)}}),s=Dt(l.compareSelectedColumn),c=Ht(Ma(l.compareSelectedColumn,s,n));c.sort((g,h)=>h.label.localeCompare(g.label,"en",{sensitivity:"base",numeric:!0})),l.compareTableData=c,r?.setProgress("Step 2/2: Loading dropdown data...");try{typeof window.columnsFilter<"u"&&window.columnsFilter&&(l.columnsFilterConfig=window.columnsFilter)}catch{console.warn("[QA Helper] columnsFilter config not found")}let i=l.lastDropdownRequest.url,u=l.lastDropdownRequest.requestData;s=Dt(l.compareSelectedColumn);let d=200,p=[],m=0,b=!0;for(;b;){let g=u;g=g.replace(/([&?])start=\d+/,`$1start=${m}`),g=g.replace(/([&?])length=\d+/,`$1length=${d}`);let S=(await $.ajax({url:i,method:"POST",data:g,contentType:"application/x-www-form-urlencoded; charset=UTF-8",dataType:"json",headers:{"X-Requested-With":"XMLHttpRequest"}})).data||[];if(S.length===0)break;let q=ja(l.compareSelectedColumn,s,S);p=[...p,...q],m+=S.length,b=S.length===d,r?.setProgress(`Step 2/2: Dropdown ${p.length} / ?`),await new Promise(w=>setTimeout(w,100))}let x=Ht(p.map(g=>({key:g.value||g.label,label:g.label||g.value||""})));x.sort((g,h)=>h.label.localeCompare(g.label,"en",{sensitivity:"base",numeric:!0})),l.compareDropdownData=x,te(),f(`\u2705 Loaded: table ${l.compareTableData.length}, dropdown ${l.compareDropdownData.length}`)}catch(n){console.error("[QA Helper] Compare load error:",n),f(`\u274C Error: ${n.message}`)}finally{r?.remove()}}function te(){let e=document.querySelector("#qa-compare-modal .body"),t=document.getElementById("qa-compare-stat"),a=document.getElementById("qa-compare-export-csv");if(!e||!t)return;if(!l.compareSelectedColumn){a&&(a.disabled=!0,a.classList.add("disabled")),e.innerHTML='<pre class="list">Select a column to compare</pre>',t.textContent="";return}if(l.compareTableData.length===0&&l.compareDropdownData.length===0){a&&(a.disabled=!0,a.classList.add("disabled")),e.innerHTML='<pre class="list">Click "Load full table data" to fetch records</pre>',t.textContent="";return}let o=_t();if(a){let s=o.length>0;a.disabled=!s,a.classList.toggle("disabled",!s)}let r=l.compareShowOnlyDiff?o.filter(s=>Se(s.tableLabel)!==Se(s.dropdownLabel)):o;if(l.compareFilterText){let s=l.compareFilterText.toLowerCase();r=r.filter(c=>c.tableLabel.toLowerCase().includes(s)||c.dropdownLabel.toLowerCase().includes(s))}if(r.length===0){let s=l.compareFilterText?"No results for this filter":l.compareShowOnlyDiff?"All values match \u{1F389}":"No data to display";e.innerHTML=`<pre class="list">${s}</pre>`,t.textContent=`\u{1F4CA} ${l.compareTableData.length} | \u{1F53D} ${l.compareDropdownData.length}`;return}let n='<table class="data-table compare-table"><thead><tr>';n+=`<th>\u{1F4CA} Table (${l.compareTableData.length})</th>`,n+=`<th>\u{1F53D} Dropdown (${l.compareDropdownData.length})</th>`,n+="</tr></thead><tbody>";for(let s of r)n+="<tr>",n+=s.tableLabel===""?'<td class="null-value">\u2014</td>':`<td>${Ze(s.tableLabel)}</td>`,n+=s.dropdownLabel===""?'<td class="null-value">\u2014</td>':`<td>${Ze(s.dropdownLabel)}</td>`,n+="</tr>";n+="</tbody></table>",e.innerHTML=n,t.textContent=`\u{1F4CA} ${l.compareTableData.length} | \u{1F53D} ${l.compareDropdownData.length}`}function _t(){let e=new Map(l.compareTableData.map(o=>[o.key,o.label])),t=new Map(l.compareDropdownData.map(o=>[o.key,o.label]));return Array.from(new Set([...e.keys(),...t.keys()])).map(o=>{let r=e.get(o)||"",n=t.get(o)||"";return{key:o,tableLabel:r,dropdownLabel:n,sortLabel:r||n||o}}).sort((o,r)=>r.sortLabel.localeCompare(o.sortLabel,"en",{sensitivity:"base",numeric:!0}))}function Ba(){if(!l.compareSelectedColumn){f("\u26A0\uFE0F Select a column first");return}let e=_t();if(e.length===0){f("\u26A0\uFE0F Nothing to export");return}let t=l.compareShowOnlyDiff?e.filter(s=>Se(s.tableLabel)!==Se(s.dropdownLabel)):e;if(l.compareFilterText){let s=l.compareFilterText.toLowerCase();t=t.filter(c=>c.tableLabel.toLowerCase().includes(s)||c.dropdownLabel.toLowerCase().includes(s))}if(t.length===0){f("\u26A0\uFE0F Nothing to export");return}let a=["Table","Dropdown"].map(Ot).join(",")+`
`;t.forEach(s=>{let c=[s.tableLabel||"",s.dropdownLabel||""];a+=c.map(Ot).join(",")+`
`});let o=new Blob(["\uFEFF"+a],{type:"text/csv;charset=utf-8;"}),r=document.createElement("a"),n=URL.createObjectURL(o);r.href=n,r.download=`qa-compare-${l.compareSelectedColumn}-${Date.now()}.csv`,r.hidden=!0,document.body.appendChild(r),r.click(),document.body.removeChild(r),setTimeout(()=>URL.revokeObjectURL(n),1e3),f("\u2705 CSV exported")}function Ot(e){if(e==null)return'""';let t=String(e);return t.includes(",")||t.includes('"')||t.includes(`
`)||t.includes("\r")?'"'+t.replace(/"/g,'""')+'"':t}function Ma(e,t,a){let o=t||{idField:e,textField:e};return a.map(r=>{let n=o.textField?P(r,o.textField):P(r,e),s=Jt(n==null?"":String(n)),c=o.idField?P(r,o.idField):P(r,e),i=c==null?"":String(c);if(i==="0"&&!s)return null;let u=o.idField&&o.textField&&o.idField!==o.textField&&i;if(i){let b=u?`(${i}) ${s||i}`:s||i;return{key:i,label:b}}let d=P(r,e),p=d==null||typeof d=="object"?"":String(d),m=p||s;return m?{key:m,label:s||p}:null}).filter(Boolean)}function Ht(e){let t=new Map;for(let a of e){if(!a)continue;let o=a.key??a.label??"",r=a.label??"",n=String(o).trim(),s=String(r).trim(),c=n||s;c&&(t.has(c)||t.set(c,{key:c,label:s||c}))}return Array.from(t.values())}function Se(e){return String(e??"").trim()}function Dt(e){if(!l.columnsFilterConfig||!l.columnsFilterConfig.idNameColumns)return{idField:e,textField:e,keyForPayload:e};let t=l.columnsFilterConfig.idNameColumns;if(t[e]){let a=String(t[e]),o=e;if(a.indexOf(".")!==-1&&e.indexOf(".")===-1){let n=a.split(".").slice(0,-1).join(".");o=n?n+".id":e}let r=e.replace(/\.id$/,"");return{idField:o,textField:a,keyForPayload:r}}return{idField:e,textField:e,keyForPayload:e}}function ja(e,t,a){let o=t||{idField:e,textField:e};return a.map(r=>{let n=o.textField?P(r,o.textField):r[e]==null?"":r[e],s=Jt(n==null?"":String(n)),c=o.idField?P(r,o.idField):r[e]==null?"":r[e],i=String(c??"");if(i==="0")return{value:"0",label:"Empty",_serverEmpty:!0};let u=o.idField!==o.textField&&i;if(i)return{value:i,label:u?`(${i}) ${s}`:s};let d=r[e],p=d==null||typeof d=="object"?"":String(d);return p===""?{value:"0",label:"Empty",_serverEmpty:!0}:{value:p,label:s}}).filter(r=>!r._serverEmpty)}function P(e,t){return t?t.split(".").reduce((a,o)=>{if(a==null)return null;if(Array.isArray(a)){let r=Number(o);return Number.isNaN(r)?a[0]?.[o]:a[r]}return a?.[o]},e):null}function Jt(e){if(e==null)return"";let t=document.createElement("div");return t.innerHTML=e,t.textContent||t.innerText||""}function Ze(e){return String(e).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;")}function Wt(){let e=document.getElementById("qa-compare-modal");e&&(e.style.display="",e.classList.add("qa-modal-visible"),ee.applyLayout(),ee.focus(),A())}function Nt(e=!1){let t=document.getElementById("qa-compare-modal");t&&t.classList.remove("qa-modal-visible")}window.addEventListener("qaPayloadUpdated",()=>{A()});He();_e();function Yt(){let e=function(){let a=/\/admin_panel\/reports\/(aggregated|smartlink)(\/|$)/i;function o(i){if(!i)return"";if(typeof i=="string")return i;if(typeof URLSearchParams<"u"&&i instanceof URLSearchParams)return i.toString();if(typeof FormData<"u"&&i instanceof FormData){let u=new URLSearchParams;return i.forEach((d,p)=>{let m="";if(typeof d=="string")m=d;else try{m=String(d)}catch(b){console.warn("[QA Helper] Failed to stringify FormData value",b),m=""}u.append(p,m)}),u.toString()}try{return String(i)}catch(u){console.warn("[QA Helper] Failed to normalize request body",u)}return""}function r(i,u){try{let d=typeof i=="string"?i:i&&i.url||"";return u&&u.toUpperCase()==="POST"&&a.test(d)}catch{return!1}}let n=window.fetch;window.fetch=async function(i,u){let d=u&&u.method||typeof i=="object"&&i&&i.method||"GET",p=r(i,d),m="";p&&u&&u.body&&(m=o(u.body));let b=await n.apply(this,arguments);if(p)try{let x=b.clone();if((x.headers.get("content-type")||"").includes("application/json")){let h=await x.json(),S=typeof i=="string"?i:i&&i.url||"";window.dispatchEvent(new CustomEvent("qaReportResponse",{detail:{url:S,method:d,payload:h,requestData:m}}))}}catch(x){console.error("[QA Helper] fetch intercept error",x)}return b};let s=window.XMLHttpRequest;function c(){let i=new s,u=i.open,d=i.send,p="GET",m="",b="";return i.open=function(x,g){return p=x||"GET",m=g||"",u.apply(i,arguments)},i.send=function(x){return b=o(x),d.apply(i,arguments)},i.addEventListener("loadend",function(){if(r(m,p))try{if((i.getResponseHeader("content-type")||"").includes("application/json")){let g=JSON.parse(i.responseText);window.dispatchEvent(new CustomEvent("qaReportResponse",{detail:{url:m,method:p,payload:g,requestData:b}}))}}catch(x){console.error("[QA Helper] XHR intercept error",x)}}),i}window.XMLHttpRequest=c},t=document.createElement("script");t.textContent=`(${e.toString()})();`,document.documentElement.appendChild(t),t.remove()}GM_addStyle(at);ot();St({onOpenColumns:Tt,onOpenCompare:Pt,onOpenFilters:Re,onOpenCustomize:Pe});Yt();window.addEventListener("qaReportResponse",e=>{let{url:t,method:a,payload:o,requestData:r}=e.detail||{},n=typeof r=="string"?r:"";if(n.includes("dropdown_search")){$t(n);return}if(l.lastPayload=o||null,n&&t&&(l.lastRequestInfo={url:t,method:a,requestData:n}),ie(l.lastPayload),t&&a){let s=t.split("?")[0];f(`${a} ${s}`.slice(-60))}o&&typeof o=="object"&&(we(o),At(),Oe(),$e(),A())});})();
