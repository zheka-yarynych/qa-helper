// ==UserScript==
// @name         QA Helper
// @namespace    https://github.com/zheka-yarynych/qa-helper
// @version      0.14.0
// @description  QA Report Helper
// @author       zheka-yarynych
// @match        https://cdportal-qa-codebase-php82.gdm4qapub.link/admin_panel/reports/aggregated/*
// @match        https://cdportal-qa-codebase-php82.gdm4qapub.link/admin_panel/reports/smartlink/*
// @match        https://cldportal-us-east-1-prod-rel-1.cdtbox.rocks/admin_panel/reports/aggregated/*
// @match        https://cldportal-us-east-1-prod-rel-1.cdtbox.rocks/admin_panel/reports/smartlink/*
// @match        http://mcd/admin_panel/reports/aggregated/*
// @match        http://mcd/admin_panel/reports/smartlink/*
// @match        https://partners.clickdealer.com/admin_panel/reports/aggregated/*
// @match        https://partners.clickdealer.com/admin_panel/reports/smartlink/*
// @updateURL    https://raw.githubusercontent.com/zheka-yarynych/qa-helper/main/qa-helper.js
// @downloadURL  https://raw.githubusercontent.com/zheka-yarynych/qa-helper/main/qa-helper.js
// @run-at       document-idle
// @grant        GM_addStyle
// @grant        GM_setClipboard
// @grant        GM_getValue
// @grant        GM_setValue
// @grant        GM_addValueChangeListener
// ==/UserScript==

(()=>{var to=Object.defineProperty;var z=(e,t)=>()=>(e&&(t=e(e=0)),t);var Yt=(e,t)=>{for(var a in t)to(e,a,{get:t[a],enumerable:!0})};var le,st,Oe,ce=z(()=>{le="QA_RPT_LAST_PAYLOAD",st="QA_HELPER_LAYOUT",Oe="Too many rows. For safety you can download up to 5000 records."});function Re(e){s.lastPayload=e;try{e?localStorage.setItem(le,JSON.stringify(e)):localStorage.removeItem(le)}catch(t){console.warn("[QA Helper] Failed to persist data in localStorage",t)}}function je(){try{let e=localStorage.getItem(le);return e?JSON.parse(e):null}catch(e){return console.warn("[QA Helper] Failed to read data from localStorage",e),null}}function Ut(){try{localStorage.removeItem(le)}catch(e){console.warn("[QA Helper] Failed to clear localStorage",e)}s.lastPayload=null}var s,R=z(()=>{ce();s={lastPayload:null,lastRequestInfo:null,lastDropdownRequest:null,displayMode:"json",isLoadingAll:!1,cancelLoadingAll:!1,columnsFilterConfig:null,compareTableData:[],compareDropdownData:[],compareSelectedColumn:"",compareShowOnlyDiff:!1,compareFilterText:"",tabsRegistry:new Map,tabsOrder:[],syncTabId:`tab-${Date.now().toString(36)}-${Math.random().toString(16).slice(2)}`,syncPeers:new Map,lastTableRequestSignature:null,lastCustomizeSignature:null,compareSyncActive:!1,compareSyncTarget:null}});function He(e,t,a={}){if(!e||!t)return;let o,r,n,i,c,p,m=!1,l=a.onMove||(()=>{}),d=a.onEnd||(()=>{});t.addEventListener("mousedown",f=>{if(f.button!==0||f.target?.closest(".qa-window-controls"))return;m=!0;let b=e.getBoundingClientRect();o=f.clientX,r=f.clientY,n=b.top,i=b.left,c=Math.max(6,window.innerWidth-b.width-6),p=Math.max(6,window.innerHeight-b.height-6),e.style.transform="none",e.style.left=`${b.left}px`,e.style.top=`${b.top}px`,e.style.right="",e.style.transition="none",f.preventDefault()}),window.addEventListener("mousemove",f=>{if(!m)return;let b=f.clientX-o,h=f.clientY-r,g=Math.max(6,Math.min(p,n+h)),x=Math.max(6,Math.min(c,i+b));e.style.top=`${g}px`,e.style.left=`${x}px`,l({top:g,left:x})}),window.addEventListener("mouseup",()=>{if(!m)return;m=!1,e.style.transition="";let f=parseFloat(e.style.top||"0"),b=parseFloat(e.style.left||"0");d({top:f,left:b})})}var it=z(()=>{});function pe(){return Array.isArray(s.tabsOrder)||(s.tabsOrder=[]),s.tabsOrder}function oo(){let e=Array.from(document.querySelectorAll(".qa-tab")),t=pe(),a=new Map(e.map(r=>[r.dataset.elementId,r])),o=[];return t.forEach(r=>{a.get(r)&&(o.push(r),a.delete(r))}),a.forEach((r,n)=>{o.push(n)}),s.tabsOrder=o,o}function lt(e){let t=pe();s.tabsOrder=t.filter(a=>a!==e)}function Gt(e,t={}){let o=pe().filter(r=>r!==e);t.insertAtStart?o.unshift(e):o.push(e),s.tabsOrder=o}function ro(){return oo().map(t=>document.querySelector(`.qa-tab[data-element-id="${t}"]`)).filter(Boolean)}function de(){let e=ro();if(!e.length)return;let t=_e;e.forEach((a,o)=>{let n=a.getBoundingClientRect().height||a.offsetHeight||Xt;if(a.dataset.qaDragging==="1"){o===0?t=_e+n+Ne:t+=n+Ne;return}o===0?(a.style.top=`${_e}px`,t=_e+n+Ne):(a.style.top=`${t}px`,t+=n+Ne),a.style.transition=""})}function no(e,t){let a=pe().filter(r=>r!==t);if(!a.length)return 0;let o=0;return a.forEach(r=>{let n=document.querySelector(`.qa-tab[data-element-id="${r}"]`);if(!n)return;let i=n.getBoundingClientRect(),c=i.top+i.height/2;e>c&&(o+=1)}),o}function so(){if(!q)return;let{tab:e,elementId:t,hasMoved:a}=q,o=q.lastClientY??q.startClientY,r=no(o,t),n=pe().filter(i=>i!==t);n.splice(r,0,t),s.tabsOrder=n,delete e.dataset.qaDragging,a&&(e.dataset.qaJustDragged="1"),e.classList.remove("qa-tab--dragging"),e.style.transition="",e.style.top="",q=null,de(),a&&requestAnimationFrame(()=>{delete e.dataset.qaJustDragged})}function io(e){if(!q)return;q.lastClientY=e.clientY,q.hasMoved||Math.abs(q.startClientY-e.clientY)>2&&(q.hasMoved=!0);let t=e.clientY-q.offsetY,a=Math.max(Qt,window.innerHeight-q.height-ao),o=Math.max(Qt,Math.min(a,t));q.tab.style.top=`${o}px`}function Vt(e){!e||e.dataset.qaDragInit==="1"||(e.dataset.qaDragInit="1",e.addEventListener("mousedown",t=>{if(t.button!==0||t.target?.closest(".qa-tab-close"))return;q=null;let a=e.getBoundingClientRect();q={tab:e,elementId:e.dataset.elementId,offsetY:t.clientY-a.top,height:a.height||Xt,startClientY:t.clientY,lastClientY:t.clientY,hasMoved:!1},e.dataset.qaDragging="1",e.classList.add("qa-tab--dragging"),e.style.transition="none",e.style.top=`${a.top}px`,t.preventDefault()}))}function I(e,t,a,o={}){let r=document.getElementById(e);if(!r)return;let n=s.tabsRegistry.get(e),i=o.insertAtStart===!0;if(n&&n.tabEl){if(n.tabEl.isConnected){i&&(Gt(e,{insertAtStart:!0}),de()),Vt(n.tabEl),n.tabEl.classList.remove("qa-tab-pulse"),requestAnimationFrame(()=>{n.tabEl.classList.add("qa-tab-pulse")}),n.tabEl.addEventListener("animationend",()=>n.tabEl.classList.remove("qa-tab-pulse"),{once:!0});return}s.tabsRegistry.delete(e),lt(e)}let c=r.getBoundingClientRect();r.dataset.qaSavedTop=r.style.top||`${c.top}px`,r.dataset.qaSavedRight=r.style.right||"",r.dataset.qaSavedLeft=r.style.left||"",r.classList.remove("qa-modal-visible"),r.style.display="none";let p=document.createElement("div");p.className="qa-tab",p.dataset.elementId=e;let m=document.createElement("span");m.className="label",m.textContent=t;let l=document.createElement("button");l.type="button",l.className="qa-tab-close",l.setAttribute("aria-label","Close tab"),l.textContent="\u2715",p.append(m,l),document.body.appendChild(p),Gt(e,{insertAtStart:i}),Vt(p),de();let d=()=>{r.dataset.qaSavedTop&&(r.style.top=r.dataset.qaSavedTop),r.dataset.qaSavedRight?r.style.right=r.dataset.qaSavedRight:r.style.right="",r.dataset.qaSavedLeft?r.style.left=r.dataset.qaSavedLeft:r.style.left="",r.style.display="",p.remove(),s.tabsRegistry.delete(e),lt(e),de(),typeof a=="function"&&a()};p.addEventListener("click",()=>{p.dataset.qaDragging!=="1"&&p.dataset.qaJustDragged!=="1"&&d()}),l.addEventListener("click",f=>{f.stopPropagation(),p.remove(),s.tabsRegistry.delete(e),delete r.dataset.qaSavedTop,delete r.dataset.qaSavedRight,delete r.dataset.qaSavedLeft,r.classList.remove("qa-modal-visible"),r.style.display="none",lt(e),de(),typeof o.onClose=="function"&&o.onClose()}),s.tabsRegistry.set(e,{tabEl:p,restore:d})}function C(e){let t=s.tabsRegistry.get(e);t&&t.restore()}var Ne,_e,Xt,Qt,ao,q,te=z(()=>{R();Ne=12,_e=0,Xt=88,Qt=6,ao=6,q=null;window.addEventListener("mousemove",e=>{q&&io(e)});window.addEventListener("mouseup",e=>{q&&(q.lastClientY=e.clientY,so())})});function bo(){try{let{pathname:e,search:t}=window.location||{pathname:"",search:""},a=e&&e.replace(/\/+$/,"")||"/";return t?`${a}${t}`:a}catch(e){return console.warn("[QA Helper] Failed to determine current route for sync",e),window.location?.pathname||"/"}}function na(e){let t=String(e||""),a=0;for(let o=0;o<t.length;o+=1)a=(a<<5)-a+t.charCodeAt(o),a|=0;return`h${(a>>>0).toString(16)}`}function xe(e,t){let a=String(e??""),o=String(t??"");return Zt?Zt.compare(a,o):a.localeCompare(o)}function ye(e){return e==null?"":typeof e!="object"?JSON.stringify(e):Array.isArray(e)?`[${e.map(o=>ye(o)).join(",")}]`:`{${Object.keys(e).sort(xe).map(o=>`${JSON.stringify(o)}:${ye(e[o])}`).join(",")}}`}function go(e){if(typeof e!="string")return{success:!1,value:null};try{return{success:!0,value:JSON.parse(e)}}catch{return{success:!1,value:null}}}function ut(e){if(Array.isArray(e)){let a=e.map(o=>ut(o)).map(o=>({key:ye(o),value:o}));return a.sort((o,r)=>xe(o.key,r.key)),a.map(o=>o.value)}if(e&&typeof e=="object"){let t={};return Object.keys(e).sort(xe).forEach(a=>{t[a]=ut(e[a])}),t}return e}function ho(e,t=""){return e==null?typeof t=="string"?t:"":ye(e)}function xo(e){let t=go(e);if(!t.success)return e;let a=ut(t.value);return ho(a,e)}function yo(e){let t=Number(e);return Number.isFinite(t)?String(t):String(e??"")}function qo(e){if(!e)return"";try{let t=new URLSearchParams(e),a=[];return t.forEach((o,r)=>{if(r==="reportName")return;let n=o;r==="columns"||r==="grouping"||r==="groupings"||r==="order"?n=xo(o):r==="start"||r==="length"?n=yo(o):n=String(o??""),a.push([r,n])}),a.sort((o,r)=>{let n=xe(o[0],r[0]);return n!==0?n:xe(o[1],r[1])}),a.map(([o,r])=>`${o}=${r}`).join("&")}catch(t){return console.warn("[QA Helper] Failed to normalize request data for sync",t),String(e)}}function wo(e){if(!e)return null;try{let t=new URL(e.url,window.location.origin),a=(e.method||"POST").toUpperCase(),o=t.pathname&&t.pathname.replace(/\/+$/,"")||"/",r=qo(e.requestData);return na(`${a}|${o}|${r}`)}catch(t){return console.warn("[QA Helper] Failed to compute table signature",t),null}}function vo(e){if(!e)return null;try{return na(ye(e))}catch(t){return console.warn("[QA Helper] Failed to compute customize signature",t),null}}function oe(){return{host:window.location?.host||"",route:ra,tableSignature:s.lastTableRequestSignature,customizeSignature:s.lastCustomizeSignature}}function T(e,t={}){if(W)try{let a={id:`${s.syncTabId}-${Date.now().toString(36)}-${Math.random().toString(16).slice(2)}`,type:e,from:s.syncTabId,payload:t};me&&me.postMessage(a),gt&&GM_setValue(bt,a)}catch(a){console.warn("[QA Helper] Failed to post message to sync channel",a)}}function So(){ue||!W||(ue=window.setInterval(()=>{T("state",oe())},mo))}function Co(){ue&&(window.clearInterval(ue),ue=null)}function ko(){let e=Date.now();Array.from(ae.entries()).forEach(([t,a])=>{(!a||e-(a.lastSeen||0)>fo)&&(ae.delete(t),s.compareSyncTarget===t&&qe({notifyPeer:!1,reason:"\u26A0\uFE0F The second tab is unavailable"}))})}function ea(e,t={}){if(!e||e===s.syncTabId)return;let o={...ae.get(e)||{},...t,tabId:e,lastSeen:Date.now()};ae.set(e,o),re()}function Eo(e){e&&(ae.delete(e),s.compareSyncTarget===e&&qe({notifyPeer:!1,reason:"\u26A0\uFE0F The second tab stopped sync"}),re())}function re(){if(ko(),!W){L({available:!1,reason:"Compare sync is not supported in this environment",targetId:null});return}let e=Array.from(ae.values()).filter(a=>a.route===ra);if(e.length===0){L({available:!1,reason:"No second tab with this report",targetId:null});return}if(e.length>1){L({available:!1,reason:"More than two tabs with this report are open",targetId:null});return}let t=e[0];if(!t){L({available:!1,reason:"Second tab not found",targetId:null});return}if(!t.host||t.host===window.location.host){L({available:!1,reason:"A tab on a different domain is required",targetId:null});return}if(!s.lastTableRequestSignature){L({available:!1,reason:"No saved table request",targetId:t.tabId});return}if(!t.tableSignature){L({available:!1,reason:"The second tab has no table data",targetId:t.tabId});return}if(s.lastTableRequestSignature!==t.tableSignature){L({available:!1,reason:"Table requests do not match",targetId:t.tabId});return}if(!s.lastCustomizeSignature){L({available:!1,reason:"Customize settings are not applied in this tab",targetId:t.tabId});return}if(!t.customizeSignature){L({available:!1,reason:"Customize settings are not applied in the second tab",targetId:t.tabId});return}if(s.lastCustomizeSignature!==t.customizeSignature){L({available:!1,reason:"Customize settings differ between tabs",targetId:t.tabId});return}L({available:!0,reason:"",targetId:t.tabId})}function L(e){B={available:!!e?.available,reason:e?.reason||"",targetId:e?.targetId||null},$e(),s.compareSyncActive&&(!B.available||B.targetId!==s.compareSyncTarget)&&qe({notifyPeer:!0,reason:"\u26A0\uFE0F Compare sync conditions are no longer met"})}function $e(){if(typeof pt=="function")try{pt({available:B.available,reason:B.reason,active:s.compareSyncActive,targetId:B.targetId})}catch(e){console.warn("[QA Helper] Failed to emit sync state change",e)}}function zo(){return[document.querySelector("#view-table"),document.querySelector("#view-table .table-responsive"),document.querySelector("#qa-compare-modal .modal-body"),document.querySelector("#reportTable .table-wrapper"),document.querySelector(".table-responsive.table-responsive-navs"),document.querySelector(".dataTables_scrollBody"),document.querySelector("#reportTable"),document.querySelector(".table-responsive")].find(t=>t&&t.scrollHeight>t.clientHeight+8)||null}function ft(){if(!O)return;(O===window?window:O).removeEventListener("scroll",ia),O=null}function sa(){O&&O!==window&&!document.contains(O)&&ft();let t=zo()||window;return O===t||(ft(),O=t,he&&(t===window?window:t).addEventListener("scroll",ia,{passive:!0})),t}function Je(){if(k&&document.contains(k))return k;let t=[document.querySelector("#view-table"),document.querySelector("#view-table .table-responsive"),document.querySelector("#reportTable .table-wrapper"),document.querySelector("#reportTable"),document.querySelector(".dataTables_scrollBody"),document.querySelector(".table-responsive"),document.querySelector("table.dataTable")?.parentElement].find(a=>a?a.scrollWidth-a.clientWidth>1:!1);return k&&k!==t&&k.removeEventListener("scroll",mt),k=t||null,k&&k.addEventListener("scroll",mt,{passive:!0}),k}function Lo(){he||(he=!0,sa(),Je())}function To(){he&&(ft(),he=!1),k&&(k.removeEventListener("scroll",mt),k=null)}function Ye(){let e=sa();return e&&e!==window?{target:e,top:e.scrollTop,viewport:e.clientHeight}:{target:window,top:window.scrollY,viewport:window.innerHeight}}function ia(){if(!s.compareSyncActive||Pe)return;let e=Ye();T("scroll-update",{target:s.compareSyncTarget,scrollY:e.top,viewport:e.viewport})}function mt(){if(!s.compareSyncActive||De)return;let e=Je();e&&T("horizontal-update",{target:s.compareSyncTarget,left:e.scrollLeft,width:e.clientWidth,max:e.scrollWidth})}function ct(e,t){if(!t||s.compareSyncTarget!==e||t.target&&t.target!==s.syncTabId||typeof t.scrollY!="number")return;let o=Ye().target;Pe=!0,A&&(window.clearTimeout(A),A=null),o&&o!==window?typeof o.scrollTo=="function"?o.scrollTo({top:t.scrollY}):o.scrollTop=t.scrollY:typeof window.scrollTo=="function"?window.scrollTo({top:t.scrollY}):window.scrollY=t.scrollY;let r=()=>{A&&(window.clearTimeout(A),A=null),Pe=!1};typeof requestAnimationFrame=="function"&&requestAnimationFrame(()=>{r()}),A=window.setTimeout(()=>{r()},180)}function dt(e,t){if(!t||s.compareSyncTarget!==e||t.target&&t.target!==s.syncTabId||typeof t.left!="number")return;let a=Je();if(!a)return;De=!0,F&&(window.clearTimeout(F),F=null),typeof a.scrollTo=="function"?a.scrollTo({left:t.left}):a.scrollLeft=t.left;let o=()=>{F&&(window.clearTimeout(F),F=null),De=!1};typeof requestAnimationFrame=="function"&&requestAnimationFrame(()=>{o()}),F=window.setTimeout(()=>{o()},180)}function la(){let e=Je();return e?e.scrollLeft:0}function ht(e){let t=e?.data;if(!t||t.from===s.syncTabId)return;let{type:a,payload:o}=t;switch(a){case"hello":ea(t.from,o),T("state",oe());break;case"state":ea(t.from,o);break;case"bye":Eo(t.from);break;case"sync-start":o?.target===s.syncTabId&&(ca(t.from),typeof o.scrollY=="number"&&ct(t.from,o),typeof o.horizontal=="number"&&dt(t.from,{...o,left:o.horizontal}),T("sync-confirm",{target:t.from,scrollY:Ye().top,horizontal:la()}));break;case"sync-confirm":o?.target===s.syncTabId&&s.compareSyncTarget===t.from&&(typeof o.scrollY=="number"&&ct(t.from,o),typeof o.horizontal=="number"&&dt(t.from,{...o,left:o.horizontal}));break;case"sync-stop":o?.target===s.syncTabId&&s.compareSyncTarget===t.from&&qe({notifyPeer:!1,reason:"\u26A0\uFE0F Sync stopped by the second tab"});break;case"scroll-update":ct(t.from,o);break;case"horizontal-update":dt(t.from,o);break;default:break}}function ca(e){return e?(s.compareSyncActive&&s.compareSyncTarget===e||(s.compareSyncActive=!0,s.compareSyncTarget=e,Lo(),$e(),typeof ge=="function"&&ge("\u2705 Compare sync enabled")),!0):!1}function qe(e={}){if(!s.compareSyncActive)return!1;let{notifyPeer:t=!0,reason:a=""}=e,o=s.compareSyncTarget;return s.compareSyncActive=!1,s.compareSyncTarget=null,A&&(window.clearTimeout(A),A=null),F&&(window.clearTimeout(F),F=null),Pe=!1,De=!1,To(),$e(),t&&o&&T("sync-stop",{target:o}),a&&typeof ge=="function"&&ge(a),!0}function da(){if(!W)return{success:!1,message:"Compare sync is not supported"};if(re(),!B.available||!B.targetId)return{success:!1,message:B.reason||"Compare sync is unavailable"};let e=B.targetId;return ca(e),T("sync-start",{target:e,scrollY:Ye().top,horizontal:la()}),{success:!0}}function pa(e={}){typeof e.onStateChange=="function"&&(pt=e.onStateChange),typeof e.onStatus=="function"&&(ge=e.onStatus),$e(),re()}function ua(e){let t=wo(e);s.lastTableRequestSignature=t,W&&T("state",oe()),re()}function We(e){let t=vo(e);s.lastCustomizeSignature=t,W&&T("state",oe()),re()}function fa(){return qe({notifyPeer:!0,reason:""})}function Io(){fe&&(window.clearInterval(fe),fe=null)}async function ta(){if(be)try{let e=await Promise.resolve(GM_getValue(bt));if(!e||e.from===s.syncTabId||e.id&&e.id===Kt)return;Kt=e.id||null,ht({data:e})}catch(e){console.warn("[QA Helper] Failed to poll GM channel for sync",e)}}function aa(){!be||fe||(fe=window.setInterval(()=>{ta()},250),ta())}var lo,co,me,bt,gt,po,uo,oa,be,W,ra,fo,mo,B,pt,ge,k,O,he,Pe,De,A,F,ue,fe,Kt,ae,Zt,xt=z(()=>{R();lo="qa-helper-compare-sync-v1",co=typeof BroadcastChannel<"u",me=co?new BroadcastChannel(lo):null,bt="QA_HELPER_COMPARE_SYNC_MESSAGE",gt=typeof GM_setValue=="function",po=typeof GM_addValueChangeListener=="function",uo=typeof GM_getValue=="function",oa=gt&&po,be=gt&&uo,W=!!(me||oa||be),ra=bo(),fo=15e3,mo=7e3,B={available:!1,reason:W?"Waiting for the second tab\u2026":"Compare sync is not supported",targetId:null},pt=()=>{},ge=()=>{},k=null,O=null,he=!1,Pe=!1,De=!1,A=null,F=null,ue=null,fe=null,Kt=null,ae=s.syncPeers;Zt=typeof Intl<"u"&&typeof Intl.Collator=="function"?new Intl.Collator("en",{sensitivity:"base",numeric:!0}):null;me&&me.addEventListener("message",ht);if(oa)try{GM_addValueChangeListener(bt,(e,t,a,o)=>{!o||!a||a.from===s.syncTabId||ht({data:a})})}catch(e){console.warn("[QA Helper] Failed to attach GM channel listener",e),be&&aa()}else be&&aa();T("hello",oe());T("state",oe());So();window.addEventListener("beforeunload",()=>{Co(),Io(),T("bye",{})})});function Ao(e){if(!e)return[];let t=[{position:"n",cursor:"ns-resize"},{position:"s",cursor:"ns-resize"},{position:"e",cursor:"ew-resize"},{position:"w",cursor:"ew-resize"},{position:"ne",cursor:"nesw-resize"},{position:"nw",cursor:"nwse-resize"},{position:"se",cursor:"nwse-resize"},{position:"sw",cursor:"nesw-resize"}],a=[];for(let{position:o,cursor:r}of t){let n=document.createElement("div");n.className=`qa-resize-handle resize-${o}`,n.style.cursor=r,n.dataset.position=o,e.appendChild(n),a.push(n)}return a}function ma(e,t={}){if(!e)return;let{minWidth:a=520,minHeight:o=320,maxWidth:r=()=>window.innerWidth-40,maxHeight:n=()=>window.innerHeight-40,onResize:i=()=>{},onEnd:c=()=>{}}=t,p=!1,m=0,l=0,d=0,f=0,b=0,h=0,g=null,x="";Ao(e).forEach(S=>{S.addEventListener("mousedown",v=>{v.button===0&&(v.preventDefault(),v.stopPropagation(),g=e.getBoundingClientRect(),p=!0,m=v.clientX,l=v.clientY,d=g.width,f=g.height,b=g.top,h=g.left,x=S.dataset.position||"",document.body.style.userSelect="none",document.body.style.cursor=S.style.cursor)})}),window.addEventListener("mousemove",S=>{if(!p)return;let v=S.clientX-m,J=S.clientY-l,Ie=typeof r=="function"?r({startRect:g,container:e}):r,Jt=typeof n=="function"?n({startRect:g,container:e}):n,Ae=d,Fe=f,Be=b,Me=h;if(x.includes("e")&&(Ae=Math.min(Math.max(d+v,a),Ie)),x.includes("w")){let Y=d-v;Y>=a&&Y<=Ie&&(Ae=Y,Me=h+v)}if(x.includes("s")&&(Fe=Math.min(Math.max(f+J,o),Jt)),x.includes("n")){let Y=f-J;Y>=o&&Y<=Jt&&(Fe=Y,Be=b+J)}e.style.width=`${Ae}px`,e.style.height=`${Fe}px`,Be!==b&&(e.style.top=`${Be}px`),Me!==h&&(e.style.left=`${Me}px`),i({width:Ae,height:Fe,top:Be,left:Me})}),window.addEventListener("mouseup",()=>{if(!p)return;p=!1,x="",document.body.style.userSelect="",document.body.style.cursor="";let S=parseFloat(e.style.width||`${d}`),v=parseFloat(e.style.height||`${f}`),J=parseFloat(e.style.top||`${b}`),Ie=parseFloat(e.style.left||`${h}`);c({width:S,height:v,top:J,left:Ie})})}var ba=z(()=>{});function yt(){if(U)return U;try{let e=localStorage.getItem(st);if(e){let t=JSON.parse(e);if(t&&typeof t=="object")return U=t,U}}catch(e){console.warn("[QA Helper] Failed to read layout from localStorage",e)}return U={},U}function ga(e){U=e;try{localStorage.setItem(st,JSON.stringify(e))}catch(t){console.warn("[QA Helper] Failed to save layout to localStorage",t)}}function ha(e){if(!e)return null;let a=yt()[e];return!a||typeof a!="object"?null:{...a}}function xa(e,t){if(!e||!t)return;let a={...yt()},o=a[e]&&typeof a[e]=="object"?a[e]:{};a[e]={...o,...t},ga(a)}function ya(e){if(!e)return;let t={...yt()};t[e]&&(delete t[e],ga(t))}var U,qa=z(()=>{ce();U=null});function Ue(e,t){let a=Number.parseFloat(e);return Number.isFinite(a)?a:t}function Fo(e,t){return t?typeof t=="string"?document.getElementById(t)||e?.querySelector(t)||null:t:null}function Qe(e,t,a){return typeof e=="function"?e(a):Number.isFinite(e)?e:t(a)}var wt,qt,M,we=z(()=>{it();ba();qa();wt=class{constructor(t=1500){this.baseZIndex=t,this.modals=new Set}register(t){t&&(this.modals.add(t),t.style.zIndex||(t.style.zIndex=String(this.baseZIndex+this.modals.size)))}bringToFront(t){if(!t)return;let a=this.baseZIndex;this.modals.forEach(r=>{let n=parseInt(r.style.zIndex||"0",10);n>a&&(a=n)}),!(parseInt(t.style.zIndex||"0",10)>=a)&&(t.style.zIndex=String(a+1))}reset(){this.modals.clear()}},qt=new wt;M=class{constructor(t={}){let{id:a,layoutId:o,minWidth:r=520,minHeight:n=320,maxWidth:i,maxHeight:c,baseWidth:p=960,minScale:m=11/13,scaleVariable:l="--qa-scale",viewportMargin:d=20,onResize:f,onResizeEnd:b,onDefaultLayout:h}=t;this.id=a,this.layoutId=o,this.minWidth=r,this.minHeight=n,this.maxWidthOption=i,this.maxHeightOption=c,this.baseWidthFallback=p,this.minScale=m,this.scaleVariable=l,this.viewportMargin=d,this.onResize=typeof f=="function"?f:null,this.onResizeEnd=typeof b=="function"?b:null,this.onDefaultLayout=typeof h=="function"?h:null,this.modal=null,this.dragHandle=null,this.cachedBaseWidth=0}get element(){return this.modal?this.modal:(this.id&&(this.modal=document.getElementById(this.id)),this.modal)}attach(t,a={}){if(this.modal=t||this.element,!this.modal)return;let{dragHandle:o}=a;this.dragHandle=Fo(this.modal,o),this.applyLayout(),this.setupDragging(),this.setupResizing(),this.setupFocus()}setupDragging(){!this.modal||!this.dragHandle||He(this.modal,this.dragHandle,{onEnd:({top:t,left:a})=>{this.persistLayout({top:t,left:a})}})}setupResizing(){if(!this.modal)return;let t=({startRect:o})=>{let r=o?.left??Ue(this.modal.style.left,0);return Math.max(this.minWidth,window.innerWidth-r-this.viewportMargin)},a=({startRect:o})=>{let r=o?.top??Ue(this.modal.style.top,0);return Math.max(this.minHeight,window.innerHeight-r-this.viewportMargin)};ma(this.modal,{minWidth:this.minWidth,minHeight:this.minHeight,maxWidth:o=>Qe(this.maxWidthOption,t,o),maxHeight:o=>Qe(this.maxHeightOption,a,o),onResize:({width:o,height:r,top:n,left:i})=>{this.updateScale(o),this.onResize&&this.onResize({width:o,height:r,top:n,left:i})},onEnd:({width:o,height:r,top:n,left:i})=>{this.updateScale(o),this.persistLayout({width:o,height:r,top:n,left:i}),this.onResizeEnd&&this.onResizeEnd({width:o,height:r,top:n,left:i})}})}setupFocus(){this.modal&&(this.modal.addEventListener("mousedown",()=>{this.focus()}),qt.register(this.modal))}focus(){let t=this.element;t&&(qt.register(t),qt.bringToFront(t))}computeBaseWidth(){if(this.cachedBaseWidth)return this.cachedBaseWidth;let t=this.element;if(!t)return this.baseWidthFallback;let a=t.getBoundingClientRect();return this.cachedBaseWidth=a?.width||this.baseWidthFallback,this.cachedBaseWidth}updateScale(t){let a=this.element;if(!a)return;let o=a.getBoundingClientRect(),r=t||o.width,n=this.computeBaseWidth(),i=Math.max(this.minScale,Math.min(1,r/n));a.style.setProperty(this.scaleVariable,i.toFixed(3))}applyLayout(){let t=this.element;if(!t)return;let a=this.layoutId?ha(this.layoutId):null,o=t.getBoundingClientRect();if(t.style.right="",!a){this.onDefaultLayout&&this.onDefaultLayout(t),this.updateScale();return}if(Number.isFinite(a.left)&&(t.style.left=`${a.left}px`,t.style.transform="none"),Number.isFinite(a.top)&&(t.style.top=`${a.top}px`),Number.isFinite(a.width)){let r=this.resolveLayoutLimit("maxWidth",o,a.left),n=Math.min(a.width,r);t.style.width=`${n}px`,this.updateScale(n)}else this.updateScale();if(Number.isFinite(a.height)){let r=this.resolveLayoutLimit("maxHeight",o,a.top),n=Math.min(a.height,r);t.style.height=`${n}px`}}resolveLayoutLimit(t,a,o){let r={startRect:a,container:this.element};return t==="maxWidth"?Qe(this.maxWidthOption,()=>{let n=Number.isFinite(o)?o:a?.left??0;return Math.max(this.minWidth,window.innerWidth-n-this.viewportMargin)},r):Qe(this.maxHeightOption,()=>{let n=Number.isFinite(o)?o:a?.top??0;return Math.max(this.minHeight,window.innerHeight-n-this.viewportMargin)},r)}persistLayout(t={}){if(!this.layoutId)return;let a={};Number.isFinite(t.width)&&(a.width=t.width),Number.isFinite(t.height)&&(a.height=t.height),Number.isFinite(t.top)&&(a.top=t.top),Number.isFinite(t.left)&&(a.left=t.left),Object.keys(a).length&&xa(this.layoutId,a)}saveCurrentLayout(){let t=this.element;if(!t)return;let a=t.getBoundingClientRect(),o=Ue(t.style.top,a.top),r=Ue(t.style.left,a.left);this.persistLayout({width:a.width,height:a.height,top:o,left:r})}resetLayout(){let t=this.element;t&&(this.layoutId&&ya(this.layoutId),t.style.left="",t.style.top="",t.style.width="",t.style.height="",t.style.right="",t.style.transform="",this.cachedBaseWidth=0,this.applyLayout(),this.focus())}}});function Bo(e=""){return e.replace(/("(?:\\u[\da-fA-F]{4}|\\[^u]|[^\\"])*"(?:\s*:)?|\b(?:true|false|null)\b|-?\d+(?:\.\d+)?(?:[eE][+\-]?\d+)?)/g,t=>t.startsWith('"')?`<span class="${t.endsWith(":")?"json-key":"json-string"}">${t}</span>`:t==="true"||t==="false"?`<span class="json-bool">${t}</span>`:t==="null"?`<span class="json-null">${t}</span>`:`<span class="json-number">${t}</span>`)}function Q(e){let t=JSON.stringify(e??{},null,2)??"{}";return`<pre class="list json-viewer">${Bo(t)}</pre>`}var Ge=z(()=>{});var Ca={};Yt(Ca,{applyFiltersSnapshot:()=>No,getCurrentFiltersSnapshot:()=>Sa,getSavedFiltersSnapshot:()=>Ho,openFilters:()=>Et,refreshFiltersIfExists:()=>zt,saveCurrentFiltersSnapshot:()=>jo});function Oo(){try{let e=GM_getValue(wa);return e?JSON.parse(e):null}catch(e){return console.log("[QA Helper] Failed to load filters snapshot:",e),null}}function kt(){return St||(vt=Oo(),St=!0),vt}function va(e){vt=e,St=!0;try{GM_setValue(wa,JSON.stringify(e))}catch(t){throw console.log("[QA Helper] Failed to save filters snapshot:",t),t}}function ne(){let e=document.getElementById("qa-filters-apply"),t=!!kt();e&&(e.disabled=!t),window.dispatchEvent(new CustomEvent("qaFiltersSnapshotChanged",{detail:{hasSnapshot:t}}))}function Ct(e){let t=document.getElementById("aggregatedReportFilterForm");if(!t){u("Filters form not found");return}let{filters:a={},periods:o={}}=e;if(Object.entries(a).forEach(([n,i])=>{let c=t.querySelector(`[name="${n}"]`);if(c)if(c.type==="checkbox")c.checked=i===!0||i==="true"||i==="1"||i===1;else if(c.tagName==="SELECT")if(typeof jQuery<"u"){let p=jQuery(c);if(p.hasClass("select2-ajaxified-list")||p.hasClass("select2-ajaxified")){let m=p.data("entity");if(m){let l={fields:{},searchFields:{id:i},searchValue:i};jQuery.ajax({url:"/admin_panel/affiliates/getDropDownList/"+m+"/",type:"POST",dataType:"json",data:l,success:function(d){if(d&&d.length>0){let f=d[0];p.find('option:not([value=""])').remove();let b=new Option(f.name||f.id,f.id,!0,!0);p.append(b),p.trigger("change.select2"),p.val(f.id).trigger("change.select2")}},error:function(d){console.log("[QA Helper] AJAX error for "+m+":",d),c.value=i,p.trigger("change.select2")}})}else c.value=i,p.trigger("change.select2")}else c.value=i,p.trigger("chosen:updated"),p.trigger("change.select2")}else c.value=i;else c.value=i}),o.current){let n=document.querySelector("input[name=daterangepicker_start]"),i=document.querySelector("input[name=daterangepicker_end]");n&&o.current.start&&(n.value=o.current.start),i&&o.current.end&&(i.value=o.current.end)}if(o.comparison){let n=document.querySelector("input[name=daterangepicker_compare_start]"),i=document.querySelector("input[name=daterangepicker_compare_end]"),c=document.querySelector("input[name=enable_compare]");c&&(c.checked=!0),n&&o.comparison.start&&(n.value=o.comparison.start),i&&o.comparison.end&&(i.value=o.comparison.end)}typeof jQuery<"u"&&jQuery(t).trigger("change");let r=t.querySelector(".btn-apply");r&&r.click()}function Ve(){let e=document.getElementById("aggregatedReportFilterForm");if(!e)return u("Filters form not found"),null;let t={};return e.querySelectorAll("[name]").forEach(o=>{let r=o.name;if(!r)return;let n=null,i=!1,c=null;if(o.type==="checkbox")i=o.checked,i&&(n=o.value||!0);else if(o.tagName==="SELECT"){let p=o.querySelector("option");p&&(c=p.value),n=o.value,i=n!==""&&n!==null&&n!=="0"&&n!==0&&n!==c}else(o.type==="text"||o.type==="hidden")&&(n=o.value,i=n!==""&&n!==null&&n!=="0"&&n!==0);i&&(t[r]?(Array.isArray(t[r])||(t[r]=[t[r]]),t[r].push(n)):t[r]=n)}),t}function Xe(){let e={},t=document.querySelector("input[name=daterangepicker_start]"),a=document.querySelector("input[name=daterangepicker_end]");if((t?.value||a?.value)&&(e.current={start:t?.value||null,end:a?.value||null}),document.querySelector("input[name=enable_compare]")?.checked){let r=document.querySelector("input[name=daterangepicker_compare_start]"),n=document.querySelector("input[name=daterangepicker_compare_end]");(r?.value||n?.value)&&(e.comparison={start:r?.value||null,end:n?.value||null})}return e}function Ro(){if(document.getElementById("qa-filters-modal"))return;let e=document.createElement("div");e.id="qa-filters-modal",e.className="card qa-modal qa-modal-visible",e.innerHTML='<div class="hd" id="qa-filters-drag"><span class="title">Current filters</span> <span class="grow"></span><div class="qa-window-controls"><button type="button" class="qa-window-btn qa-window-btn--close" id="qa-filters-close" title="Close" aria-label="Close" data-icon="\xD7"></button> <button type="button" class="qa-window-btn qa-window-btn--reset" id="qa-filters-reset" title="Reset layout" aria-label="Reset layout" data-icon="\u21BA"></button> <button type="button" class="qa-window-btn qa-window-btn--collapse" id="qa-filters-collapse" title="Collapse" aria-label="Collapse" data-icon="\u2013"></button></div></div><div class="filters-tools"><div class="filters-actions"><button class="btn-action" id="qa-filters-refresh" title="Refresh filters snapshot"><span class="icon"><i class="fa fa-refresh"></i></span> <span class="label">Refresh preview</span></button> <button class="btn-action" id="qa-filters-copy-json" title="Copy current filters as JSON"><span class="icon">\u{1F4CB}</span> <span class="label">Copy state JSON</span></button> <button class="btn-action primary" id="qa-filters-save" title="Save current filters to storage"><span class="icon"><i class="fa fa-save"></i></span> <span class="label">Save state</span></button> <button class="btn-action primary" id="qa-filters-apply" title="Apply saved filters from storage" disabled><span class="icon"><i class="fa fa-check"></i></span> <span class="label">Apply state</span></button> <button class="btn-action" id="qa-filters-apply-json" title="Apply filters from JSON"><span class="icon">\u{1F4C4}</span> <span class="label">Apply state JSON</span></button></div></div><div class="body" id="qa-filters-body"><div class="filter-content"></div></div>',document.body.appendChild(e),j.attach(e,{dragHandle:"qa-filters-drag"}),document.getElementById("qa-filters-refresh")?.addEventListener("click",()=>{G(),u("\u2705 Filters preview refreshed")}),document.getElementById("qa-filters-copy-json")?.addEventListener("click",()=>{let a=Ve(),o=Xe(),r={filters:a||{},periods:o||{}};GM_setClipboard(JSON.stringify(r,null,2),"text"),u("\u2705 Filters JSON copied")}),document.getElementById("qa-filters-save")?.addEventListener("click",()=>{let a=Ve(),o=Xe(),r={filters:a||{},periods:o||{},timestamp:new Date().toISOString()};console.log("[QA Helper] Saving filters snapshot:",r),va(r),u("\u2705 Filters state saved"),ne()}),document.getElementById("qa-filters-apply")?.addEventListener("click",()=>{let a=kt();if(!a){u("\u274C No saved filters state"),alert("\u274C No saved filters state. Save it first.");return}Ct(a),G(),u("\u2705 Filters state applied")}),document.getElementById("qa-filters-apply-json")?.addEventListener("click",()=>{let a=document.createElement("div");a.className="qa-json-modal",a.innerHTML='<div class="qa-json-modal-title">\u{1F4CB} Paste filters state JSON:</div><textarea id="qa-paste-json-area"></textarea><div class="qa-json-modal-buttons"><button id="qa-paste-json-ok" class="btn-ok">Apply</button> <button id="qa-paste-json-cancel" class="btn-cancel">Cancel</button></div>',document.body.appendChild(a);let o=document.getElementById("qa-paste-json-area");o.focus(),document.getElementById("qa-paste-json-ok")?.addEventListener("click",()=>{let r=o.value.trim();a.remove(),t(r)}),document.getElementById("qa-paste-json-cancel")?.addEventListener("click",()=>{a.remove(),u("\u274C Cancelled")})});function t(a){if(!a){u("\u274C No data to load");return}try{let o=JSON.parse(a);if(!o.filters||typeof o.filters!="object"){alert('\u274C Invalid format. Expected an object with "filters".'),u("\u274C Invalid snapshot format");return}Ct(o),G(),u("\u2705 Filters applied from JSON"),ne()}catch(o){u(`\u274C JSON parsing error: ${o.message}`),alert(`\u274C Failed to parse JSON:
${o.message}`)}}document.getElementById("qa-filters-close")?.addEventListener("click",()=>{j.saveCurrentLayout(),e.remove()}),document.getElementById("qa-filters-reset")?.addEventListener("click",()=>{j.resetLayout(),G(),ne()}),document.getElementById("qa-filters-collapse")?.addEventListener("click",()=>{j.saveCurrentLayout(),I("qa-filters-modal","Current filters",()=>{e.classList.add("qa-modal-visible"),j.applyLayout(),j.focus(),ne()}),e.classList.remove("qa-modal-visible")}),j.applyLayout(),G(),ne()}function G(){let e=document.getElementById("qa-filters-modal");if(!e)return;let t=Ve(),a=Xe(),o={filters:t||{},periods:a||{}},r=e.querySelector(".filter-content");r&&(r.innerHTML=Q(o))}function Et(){Ro(),C("qa-filters-modal");let e=document.getElementById("qa-filters-modal");e&&(e.style.display="",j.focus())}function zt(){document.getElementById("qa-filters-modal")&&G()}function Sa(){let e=Ve(),t=Xe();return{filters:e||{},periods:t||{}}}function jo(){let e=Sa();return va({...e,timestamp:new Date().toISOString()}),ne(),e}function Ho(){return kt()}function No(e){return e?(Ct(e),G(),!0):!1}var Mo,wa,j,vt,St,Lt=z(()=>{te();we();se();Ge();Mo="qa-filters-modal",wa="QA_FILTERS_SNAPSHOT",j=new M({id:"qa-filters-modal",layoutId:Mo,minWidth:520,minHeight:320});vt=null,St=!1});var za={};Yt(za,{applyCustomizeState:()=>Go,getCurrentCustomizeState:()=>Ea,getSavedCustomizeState:()=>Qo,openCustomize:()=>At,refreshCustomizeIfExists:()=>Ft,saveCurrentCustomizeState:()=>Uo,triggerCustomizeApply:()=>Vo});function Po(e){return typeof e=="string"?e.trim():""}function Do(){let e=document.getElementById("report-view");if(e instanceof HTMLSelectElement)return e;let t=document.querySelector(".custom-views-buttons-box select");return t instanceof HTMLSelectElement?t:null}function $o(){let e=Do();if(!e)return null;let t=e.options[e.selectedIndex];if(!t)return null;let a=t.value!=null?String(t.value):"",o=Po(t.textContent||t.innerText||"");return!a&&!o?null:{id:a,name:o}}function Ke(){let e={view:$o(),columns:[],grouping:[],filters:{}},t=document.querySelector(".dropdown-menu-view-settings");if(!t)return console.log("[QA Helper] dropdown-menu-view-settings not found"),e;let a=t.querySelector("#customFiltersBlock");a&&a.querySelectorAll('input[type="checkbox"]:checked').forEach(n=>{let i=n.getAttribute("data-source"),c=n.getAttribute("data-title");i&&(e.filters[i]=Jo(c||i))});let o=t.querySelector("#customGroupingsBlock");o&&o.querySelectorAll('input[type="checkbox"]:checked').forEach(n=>{let i=n.getAttribute("data-source");i&&e.grouping.push(i)});let r=t.querySelector("#customListColumnsSortable");return r&&r.querySelectorAll('input[type="checkbox"]:checked').forEach(n=>{let i=n.getAttribute("data-source");i&&e.columns.push(i)}),console.log("[QA Helper] Saving customize settings:",e),e}function Jo(e){if(!e)return"";let t=document.createElement("div");return t.innerHTML=e,t.textContent||t.innerText||""}function Tt(e,t={}){if(!e)return;let a=document.querySelector(".dropdown-menu-view-settings");if(!a){console.log("[QA Helper] dropdown-menu-view-settings not found");return}let{skipApply:o=!1,silent:r=!1}=t,n=a.querySelector("#customFiltersBlock");n&&e.filters&&n.querySelectorAll('input[type="checkbox"]').forEach(l=>{let d=l.getAttribute("data-source");l.checked=!!(d&&e.filters[d])});let i=a.querySelector("#customGroupingsBlock");i&&e.grouping&&Array.isArray(e.grouping)&&i.querySelectorAll('input[type="checkbox"]').forEach(l=>{let d=l.getAttribute("data-source");l.checked=!!(d&&e.grouping.includes(d))});let c=a.querySelector("#customListColumnsSortable");c&&e.columns&&Array.isArray(e.columns)&&(c.querySelectorAll('input[type="checkbox"]').forEach(l=>{let d=l.getAttribute("data-source");l.checked=!!(d&&e.columns.includes(d))}),Yo(c,e.columns));let p=a.querySelector("#applyCustomization");p&&!o&&p.click(),r||u("\u2705 Customize settings applied")}function Yo(e,t){if(!e||!Array.isArray(t)||t.length===0)return;let a=Array.from(e.querySelectorAll(":scope > li"));if(a.length===0)return;let o=new Map;if(a.forEach(d=>{let f=d.querySelector('input[type="checkbox"][data-source]');if(!f)return;let b=f.getAttribute("data-source");!b||o.has(b)||o.set(b,{item:d,checkbox:f})}),!o.size)return;let r=[],n=new Set;if(t.forEach(d=>{if(n.has(d))return;let f=o.get(d);!f||!f.checkbox.checked||(r.push(f.item),n.add(d))}),!r.length)return;let i=new Set(r),c=[],p=0,m=!1;if(a.forEach(d=>{if(!i.has(d)){c.push(d);return}let f=r[p]||d;p+=1,c.push(f),f!==d&&(m=!0)}),!m)return;let l=document.createDocumentFragment();c.forEach((d,f)=>{d instanceof HTMLElement&&d.hasAttribute("data-order")&&d.setAttribute("data-order",String(f)),l.appendChild(d)}),e.appendChild(l)}function It(){try{let e=GM_getValue("QA_CUSTOMIZE_SETTINGS");return e?JSON.parse(e):null}catch(e){return console.log("[QA Helper] Failed to load customize settings:",e),null}}function ka(e){try{GM_setValue("QA_CUSTOMIZE_SETTINGS",JSON.stringify(e))}catch(t){throw console.log("[QA Helper] Failed to save customize settings:",t),t}}function N(){let e=document.getElementById("qa-customize-apply"),t=!!It();e&&(e.disabled=!t),window.dispatchEvent(new CustomEvent("qaCustomizeSnapshotChanged",{detail:{hasState:t}}))}function Wo(){if(document.getElementById("qa-customize-modal"))return;let e=document.createElement("div");e.id="qa-customize-modal",e.className="card qa-modal qa-modal-visible",e.innerHTML='<div class="hd" id="qa-customize-drag"><span class="title">Current customize</span> <span class="grow"></span><div class="qa-window-controls"><button type="button" class="qa-window-btn qa-window-btn--close" id="qa-customize-close" title="Close" aria-label="Close" data-icon="\xD7"></button> <button type="button" class="qa-window-btn qa-window-btn--reset" id="qa-customize-reset" title="Reset layout" aria-label="Reset layout" data-icon="\u21BA"></button> <button type="button" class="qa-window-btn qa-window-btn--collapse" id="qa-customize-collapse" title="Collapse" aria-label="Collapse" data-icon="\u2013"></button></div></div><div class="customize-tools"><div class="customize-actions"><button class="btn-action" id="qa-customize-refresh" title="Refresh customize snapshot"><span class="icon"><i class="fa fa-refresh"></i></span> <span class="label">Refresh preview</span></button> <button class="btn-action" id="qa-customize-copy-json" title="Copy current customize as JSON"><span class="icon">\u{1F4CB}</span> <span class="label">Copy state JSON</span></button> <button class="btn-action primary" id="qa-customize-save" title="Save current customize to storage"><span class="icon"><i class="fa fa-save"></i></span> <span class="label">Save state</span></button> <button class="btn-action primary" id="qa-customize-apply" title="Apply saved customize from storage" disabled><span class="icon"><i class="fa fa-check"></i></span> <span class="label">Apply state</span></button> <button class="btn-action" id="qa-customize-apply-json" title="Apply customize from JSON"><span class="icon">\u{1F4C4}</span> <span class="label">Apply state JSON</span></button></div></div><div class="body" id="qa-customize-body"><div class="customize-content"></div></div>',document.body.appendChild(e),H.attach(e,{dragHandle:"qa-customize-drag"}),document.getElementById("qa-customize-refresh")?.addEventListener("click",()=>{V(),u("\u2705 Customize preview refreshed")}),document.getElementById("qa-customize-copy-json")?.addEventListener("click",()=>{let a=Ke();GM_setClipboard(JSON.stringify(a,null,2),"text"),u("\u2705 Customize JSON copied")}),document.getElementById("qa-customize-save")?.addEventListener("click",()=>{let a=Ke();ka(a),u("\u2705 Customize state saved"),N()}),document.getElementById("qa-customize-apply")?.addEventListener("click",()=>{let a=It();if(!a){u("\u274C No saved customize state"),alert("\u274C No saved customize state. Save it first.");return}Tt(a),V(),u("\u2705 Customize state applied")}),document.getElementById("qa-customize-apply-json")?.addEventListener("click",()=>{let a=document.createElement("div");a.className="qa-json-modal",a.innerHTML='<div class="qa-json-modal-title">\u{1F4CB} Paste customize state JSON:</div><textarea id="qa-paste-customize-json-area"></textarea><div class="qa-json-modal-buttons"><button id="qa-paste-customize-json-ok" class="btn-ok">Apply</button> <button id="qa-paste-customize-json-cancel" class="btn-cancel">Cancel</button></div>',document.body.appendChild(a);let o=document.getElementById("qa-paste-customize-json-area");o.focus(),document.getElementById("qa-paste-customize-json-ok")?.addEventListener("click",()=>{let r=o.value.trim();a.remove(),t(r)}),document.getElementById("qa-paste-customize-json-cancel")?.addEventListener("click",()=>{a.remove(),u("\u274C Cancelled")})});function t(a){if(!a){u("\u274C No data to load");return}try{let o=JSON.parse(a);if(!o.columns||typeof o.columns!="object"){alert('\u274C Invalid format. Expected an object with "columns".'),u("\u274C Invalid customize format");return}Tt(o),V(),u("\u2705 Customize applied from JSON"),N()}catch(o){u(`\u274C JSON parsing error: ${o.message}`),alert(`\u274C Failed to parse JSON:
${o.message}`)}}document.getElementById("qa-customize-close")?.addEventListener("click",()=>{H.saveCurrentLayout(),e.remove()}),document.getElementById("qa-customize-reset")?.addEventListener("click",()=>{H.resetLayout(),V(),N()}),document.getElementById("qa-customize-collapse")?.addEventListener("click",()=>{H.saveCurrentLayout(),I("qa-customize-modal","Current customize",()=>{e.classList.add("qa-modal-visible"),H.applyLayout(),H.focus(),N()}),e.classList.remove("qa-modal-visible")}),H.applyLayout(),V(),N()}function V(){let e=document.getElementById("qa-customize-modal");if(!e)return;let t=Ke(),a=e.querySelector(".customize-content");a&&(a.innerHTML=Q(t))}function At(){Wo(),C("qa-customize-modal");let e=document.getElementById("qa-customize-modal");e&&(e.style.display="",H.focus()),N()}function Ft(){document.getElementById("qa-customize-modal")&&(V(),N())}function Ea(){return Ke()}function Uo(){let e=Ea();return ka(e),N(),e}function Qo(){return It()}function Go(e,t={}){return e?(Tt(e,t),V(),!0):!1}function Vo(){let e=document.querySelector(".dropdown-menu-view-settings");if(!e)return!1;let t=e.querySelector("#applyCustomization");return t?(t.click(),!0):!1}var _o,H,Bt=z(()=>{te();we();se();Ge();_o="qa-customize-modal",H=new M({id:"qa-customize-modal",layoutId:_o,minWidth:520,minHeight:320,baseWidth:800,onDefaultLayout:e=>{e&&(e.style.right="20px",e.style.top="120px",e.style.width="800px")}})});function Zo(){if(X&&document.body.contains(X))return X;let e=document.getElementById("qa-status-container");if(e)return X=e,X;let t=document.createElement("div");t.id="qa-status-container";let a=document.body||document.documentElement;return a?(a.appendChild(t),X=t,X):null}function Rt(e,t={}){if(!e||e.dataset.qaDismissing==="1")return;e.dataset.qaDismissing="1";let a=Ht.get(e);a&&(clearTimeout(a),Ht.delete(e)),e.classList.remove("qa-status-toast--visible"),e.classList.add("qa-status-toast--leaving");let o=typeof t.delay=="number"?t.delay:Aa;window.setTimeout(()=>{e.remove()},o)}function ie(){Ze&&(Ze.remove(),Ze=null)}function Ta(e){if(!y||!e)return;ie();let t=document.createElement("div");t.className="qa-tooltip",t.textContent=e,document.body.appendChild(t);let a=y.getBoundingClientRect(),o=t.getBoundingClientRect(),r=a.bottom+window.scrollY+8,n=a.left+window.scrollX+a.width/2-o.width/2;t.style.top=`${Math.max(r,0)}px`,t.style.left=`${Math.max(n,8)}px`,Ze=t,requestAnimationFrame(()=>{t.classList.add("qa-tooltip--visible")})}function Ia(e={}){if(E={available:!!e.available,reason:e.reason||"",active:!!e.active},!y)return;let t=E.available;if(y.classList.toggle("qa-sync-active",E.active),y.classList.toggle("qa-sync-disabled",!t),t?y.removeAttribute("aria-disabled"):y.setAttribute("aria-disabled","true"),E.available?(y.title="Sync tabs for compare",delete y.dataset.qaTooltip,ie()):(y.title=E.reason||"Compare sync is unavailable",E.reason?y.dataset.qaTooltip=E.reason:delete y.dataset.qaTooltip),K){let a=E.active&&t;K.classList.toggle("qa-sync-indicator--active",a),K.classList.toggle("qa-sync-indicator--unavailable",!t),jt&&(jt.className=a?"fa fa-toggle-on":"fa fa-toggle-off");let o=t?a?"Compare sync is active":"Compare sync is idle":E.reason||"Compare sync is unavailable";K.setAttribute("title",o),K.setAttribute("aria-label",o)}}function Se(){return Mt||(Mt=Promise.resolve().then(()=>(Lt(),Ca))),Mt}function Ce(){return Ot||(Ot=Promise.resolve().then(()=>(Bt(),za))),Ot}async function ke(){try{let[e,t]=await Promise.all([Se(),Ce()]),a=!!e.getSavedFiltersSnapshot(),o=!!t.getSavedCustomizeState();et&&(et.disabled=!(a&&o))}catch(e){console.error("[QA Helper] Failed to update panel buttons:",e)}}async function er(){try{let[e,t]=await Promise.all([Se(),Ce()]),a=t.saveCurrentCustomizeState(),o=e.saveCurrentFiltersSnapshot();ke(),u("\u2705 Saved customize & filters state"),We({customize:a||{},filters:o?.filters||{},periods:o?.periods||{}})}catch(e){console.error("[QA Helper] Failed to save combined state:",e);let t=e?.message||e?.toString?.()||"Unknown error";u(`\u274C Failed to save state: ${t}`)}}async function tr(){try{let[e,t]=await Promise.all([Se(),Ce()]),a=t.getSavedCustomizeState(),o=e.getSavedFiltersSnapshot();if(!a||!o){u("\u26A0\uFE0F Save customize & filters first");return}let r=t.applyCustomizeState(a,{skipApply:!0,silent:!0}),n=e.applyFiltersSnapshot(o);if(!r||!n){u("\u26A0\uFE0F Failed to apply saved state");return}We({customize:a,filters:o?.filters||{},periods:o?.periods||{}});let i=t.triggerCustomizeApply();u(i?"\u2705 Applied customize & filters state":"\u26A0\uFE0F Applied state, but apply button was not triggered")}catch(e){console.error("[QA Helper] Failed to apply combined state:",e);let t=e?.message||e?.toString?.()||"Unknown error";u(`\u274C Failed to apply state: ${t}`)}}async function ar(){try{let[e,t]=await Promise.all([Se(),Ce()]),a=t.getCurrentCustomizeState?.()||t.getSavedCustomizeState?.()||{},o=e.getCurrentFiltersSnapshot?.()||e.getSavedFiltersSnapshot?.()||{},r={customize:a||{},filters:o?.filters||{},periods:o?.periods||{}};GM_setClipboard(JSON.stringify(r,null,2),"text"),u("\u2705 Copied customize & filters JSON")}catch(e){console.error("[QA Helper] Failed to copy combined state JSON:",e);let t=e?.message||e?.toString?.()||"Unknown error";u(`\u274C Failed to copy state JSON: ${t}`)}}function or(e){let t=document.createElement("div");t.className="qa-json-modal",t.innerHTML='<div class="qa-json-modal-title">\u{1F4CB} Paste customize & filters state JSON:</div><textarea id="qa-paste-combined-json-area"></textarea><div class="qa-json-modal-buttons"><button id="qa-paste-combined-json-ok" class="btn-ok">Apply</button> <button id="qa-paste-combined-json-cancel" class="btn-cancel">Cancel</button></div>',document.body.appendChild(t);let a=document.getElementById("qa-paste-combined-json-area");a?.focus(),document.getElementById("qa-paste-combined-json-ok")?.addEventListener("click",()=>{let o=a?.value.trim()||"";t.remove(),e(o)}),document.getElementById("qa-paste-combined-json-cancel")?.addEventListener("click",()=>{t.remove(),u("\u274C Cancelled")})}async function rr(e){if(!e){u("\u274C No data to load");return}try{let t=JSON.parse(e);if(!t||typeof t!="object")throw new Error("Invalid JSON payload");let a=t.customize,o={filters:t.filters||{},periods:t.periods||{}};if(!a||typeof a!="object")throw new Error('Expected "customize" object in JSON');if(!o.filters||typeof o.filters!="object")throw new Error('Expected "filters" object in JSON');let[r,n]=await Promise.all([Se(),Ce()]),i=n.applyCustomizeState?.(a,{skipApply:!0,silent:!0}),c=r.applyFiltersSnapshot?.(o);if(!i||!c){u("\u26A0\uFE0F Failed to apply pasted state");return}We({customize:a,filters:o.filters||{},periods:o.periods||{}});let p=n.triggerCustomizeApply?.();u(p?"\u2705 Applied customize & filters from JSON":"\u26A0\uFE0F Applied JSON state, but apply button was not triggered"),n.saveCurrentCustomizeState?.(),r.saveCurrentFiltersSnapshot?.(),ke()}catch(t){console.error("[QA Helper] Failed to apply state from JSON:",t);let a=t?.message||t?.toString?.()||"Unknown error";alert(`\u274C Failed to apply JSON state:
${a}`),u(`\u274C Failed to apply JSON state: ${a}`)}}function Fa(){let e=document.getElementById("qa-rpt");if(e)return;e=document.createElement("div"),e.id="qa-rpt",e.innerHTML='<div class="hd" id="qa-rpt-drag"><span class="title">QA Helper</span> <span class="grow"></span><div class="qa-window-controls"><button type="button" class="qa-window-btn qa-window-btn--close" id="qa-rpt-close" title="Close" aria-label="Close" data-icon="\xD7"></button> <button type="button" class="qa-window-btn qa-window-btn--reset" id="qa-rpt-reset" title="Reset position" aria-label="Reset position" data-icon="\u21BA"></button> <button type="button" class="qa-window-btn qa-window-btn--collapse" id="qa-rpt-collapse" title="Collapse" aria-label="Collapse" data-icon="\u2013"></button></div></div><div class="ft"><div class="btn-inline-group"><button class="btn btn--with-addon" id="qa-save-state"><i class="fa fa-save"></i> Save Customize&Filters state</button> <button class="btn btn-icon-only" id="qa-copy-combined-state" title="Copy Customize&Filters JSON" aria-label="Copy Customize&Filters JSON">\u{1F4CB}</button></div><div class="btn-inline-group"><button class="btn btn--with-addon" id="qa-apply-state" disabled><i class="fa fa-check"></i> Apply Customize&Filters state</button> <button class="btn btn-icon-only" id="qa-paste-combined-state" title="Apply Customize&Filters from JSON" aria-label="Apply Customize&Filters from JSON">\u{1F4C4}</button></div><button class="btn" id="qa-open-columns">\u{1F4CA} Last table response</button> <button class="btn" id="qa-open-filters">\u{1F39B}\uFE0F Current filters</button> <button class="btn" id="qa-open-customize"><i class="fa fa-cog" style="color:#fff"></i> Current customize</button> <button class="btn" id="qa-compare-dropdown"><i class="fa fa-filter" style="color:#656c71"></i> Column Filter</button><div class="qa-sync-row"><div class="btn-inline-group qa-sync-controls"><button class="btn" id="qa-sync-compare">\u{1F504} Sync tabs for compare</button> <span class="qa-sync-indicator" id="qa-sync-state" role="status" aria-live="polite" title="Compare sync is idle" aria-label="Compare sync is idle"><i class="fa fa-toggle-off" aria-hidden="true"></i></span></div></div></div>',document.body.appendChild(e);let t=()=>{e.style.top="16px",e.style.left="",e.style.right="16px",e.style.bottom="",e.style.transform=""};if(document.getElementById("qa-rpt-close")?.addEventListener("click",()=>e.remove()),document.getElementById("qa-rpt-reset")?.addEventListener("click",()=>t()),document.getElementById("qa-rpt-collapse")?.addEventListener("click",()=>I("qa-rpt","QA Helper",()=>C("qa-rpt"),{onClose:()=>e.remove(),insertAtStart:!0})),document.getElementById("qa-save-state")?.addEventListener("click",()=>{er()}),document.getElementById("qa-copy-combined-state")?.addEventListener("click",()=>{ar()}),et=document.getElementById("qa-apply-state"),et?.addEventListener("click",()=>{tr()}),document.getElementById("qa-paste-combined-state")?.addEventListener("click",()=>{or(a=>{rr(a)})}),document.getElementById("qa-open-columns")?.addEventListener("click",()=>{ve.onOpenColumns()}),document.getElementById("qa-open-filters")?.addEventListener("click",()=>{ve.onOpenFilters()}),document.getElementById("qa-open-customize")?.addEventListener("click",()=>{ve.onOpenCustomize()}),document.getElementById("qa-compare-dropdown")?.addEventListener("click",()=>{ve.onOpenCompare()}),y=document.getElementById("qa-sync-compare"),y){y.addEventListener("click",()=>{if(E.active){fa()&&u("\u23F9\uFE0F Compare sync disabled");return}if(!E.available){y.dataset.qaTooltip&&(Ta(y.dataset.qaTooltip),u(`\u26A0\uFE0F ${y.dataset.qaTooltip}`));return}ie();let o=da();!o.success&&o.message&&u(`\u26A0\uFE0F ${o.message}`)});let a=()=>{!E.available&&y.dataset.qaTooltip&&Ta(y.dataset.qaTooltip)};y.addEventListener("mouseenter",a),y.addEventListener("focus",a),y.addEventListener("mouseleave",()=>ie()),y.addEventListener("blur",()=>ie())}K=document.getElementById("qa-sync-state"),jt=K?.querySelector("i")||null,pa({onStateChange:a=>Ia(a),onStatus:a=>{a&&u(a)}}),Ia(E),He(e,document.getElementById("qa-rpt-drag")),La||(La=!0,requestAnimationFrame(()=>{I("qa-rpt","QA Helper",()=>C("qa-rpt"),{onClose:()=>e.remove(),insertAtStart:!0})})),ke()}function Ba(e){ve={onOpenColumns:e?.onOpenColumns||(()=>{}),onOpenCompare:e?.onOpenCompare||(()=>{}),onOpenFilters:e?.onOpenFilters||(()=>{}),onOpenCustomize:e?.onOpenCustomize||(()=>{})},Fa()}function u(e,t={}){if(!e)return;let a=Zo();if(!a)return;let o=Array.from(a.querySelectorAll(".qa-status-toast"));o.length>=Ko&&Rt(o[0],{delay:Aa});let r=document.createElement("div");r.className="qa-status-toast",r.textContent=e,a.appendChild(r),requestAnimationFrame(()=>{r.classList.add("qa-status-toast--visible")});let n=typeof t.duration=="number"?t.duration:Xo;if(n>0){let i=window.setTimeout(()=>Rt(r),n);Ht.set(r,i)}r.addEventListener("click",()=>Rt(r,{delay:0}))}function tt(e){Fa(),window.dispatchEvent(new CustomEvent("qaPayloadUpdated",{detail:e}))}var ve,La,Mt,Ot,et,X,y,Ze,K,jt,E,Xo,Aa,Ko,Ht,se=z(()=>{R();it();te();xt();ve={onOpenColumns:()=>{},onOpenCompare:()=>{},onOpenFilters:()=>{},onOpenCustomize:()=>{}},La=!1,Mt=null,Ot=null,et=null,X=null,y=null,Ze=null,K=null,jt=null,E={available:!1,reason:"",active:!1},Xo=2400,Aa=220,Ko=4,Ht=new WeakMap;window.addEventListener("scroll",()=>ie(),!0);window.addEventListener("qaFiltersSnapshotChanged",()=>{ke()});window.addEventListener("qaCustomizeSnapshotChanged",()=>{ke()})});var Wt=`:root{--qa-bg: linear-gradient(135deg, rgba(38,12,63,.92) 0%, rgba(17,15,36,.94) 100%);--qa-surface: linear-gradient(135deg, rgba(79,29,112,.52) 0%, rgba(30,22,61,.62) 100%);--qa-surface-soft: linear-gradient(135deg, rgba(122,45,179,.35) 0%, rgba(62,36,102,.4) 100%);--qa-surface-strong: linear-gradient(135deg, rgba(99,35,152,.6) 0%, rgba(35,22,70,.72) 100%);--qa-accent: linear-gradient(135deg, rgba(168,85,247,.18) 0%, rgba(236,72,153,.12) 100%);--qa-border: rgba(192,132,252,.35);--qa-border-strong: rgba(192,132,252,.55);--qa-border-muted: rgba(192,132,252,.2);--qa-hover: rgba(217,70,239,.2);--qa-primary: #a855f7;--qa-primary-bright: #c084fc;--qa-primary-light: #e9d5ff;--qa-secondary: #f472b6;--qa-highlight: rgba(236,72,153,.32);--qa-text: #f8fafc;--qa-text-dim: #d1d5db;--qa-text-muted: rgba(226,232,240,.75);--qa-success: #22c55e;--qa-warning: #f97316;--qa-danger: #f87171;--qa-info: #c4b5fd;--qa-cyan: #d8b4fe;--qa-blue: #a855f7;--qa-blue-light: #ede9fe;--qa-blue-bright: #c084fc;--qa-purple: #f5d0fe;--qa-tab-bg: linear-gradient(135deg, rgba(37,23,74,.96) 0%, rgba(49,32,89,.96) 100%);--qa-tab-hover: linear-gradient(135deg, rgba(63,34,106,.98) 0%, rgba(75,43,119,.98) 100%);--qa-scrollbar-track: rgba(17,15,36,.35);--qa-scrollbar-thumb: linear-gradient(135deg, rgba(192,132,252,.55) 0%, rgba(139,92,246,.62) 100%);--qa-scrollbar-thumb-hover: linear-gradient(135deg, rgba(207,166,255,.75) 0%, rgba(168,114,255,.82) 100%);--qa-shadow-soft: 0 12px 48px rgba(139,92,246,.25);--qa-shadow-strong: 0 24px 72px rgba(139,92,246,.35)}.qa-modal{display:none;flex-direction:column;background:var(--qa-surface);color:var(--qa-text)}.qa-modal-visible{display:flex!important}.qa-window-controls{display:flex;align-items:center;gap:6px;margin-left:10px;user-select:none;cursor:default;flex-shrink:0;flex-direction:row-reverse}.qa-window-btn{width:14px;height:14px;border-radius:50%;border:1px solid rgba(0,0,0,.28);display:inline-flex;align-items:center;justify-content:center;padding:0;background:linear-gradient(135deg,#ffffff8c,#00000014);position:relative;box-shadow:inset 0 1px #fff9,inset 0 -1px #00000026;transition:transform .18s ease,box-shadow .18s ease,filter .18s ease;cursor:pointer;overflow:hidden;font-size:0}.qa-window-btn:after{content:attr(data-icon);position:absolute;inset:0;display:flex;align-items:center;justify-content:center;font-size:8px;line-height:1;color:#0f172ad1;opacity:.75;transform:scale(1);transition:opacity .15s ease,transform .18s ease}.qa-window-btn:focus{outline:none;box-shadow:0 0 0 2px #ffffff59,inset 0 1px #fff9,inset 0 -1px #00000026}.qa-window-btn:hover{filter:brightness(1.05);transform:translateY(-.5px);box-shadow:0 0 8px #ffffff4d,inset 0 1px #ffffffb3,inset 0 -1px #0000002e}.qa-window-btn:hover:after,.qa-window-btn:focus-visible:after{opacity:1}.qa-window-btn--close{background:radial-gradient(circle at 25% 25%,#ffffffbf,#ff5f57 70%);border-color:#c82d2da6}.qa-window-btn--reset{background:radial-gradient(circle at 25% 25%,#ffffffbf,#febb2e 70%);border-color:#d9770699}.qa-window-btn--collapse{background:radial-gradient(circle at 25% 25%,#ffffffbf,#28c840 70%);border-color:#16a34a99}.hidden-input{position:absolute;opacity:0;pointer-events:none}#qa-rpt{position:fixed;right:16px;top:16px;z-index:10000;width:min(280px,88vw);background:var(--qa-bg);color:var(--qa-text);border-radius:14px;box-shadow:0 10px 40px #8b5cf63b,0 0 0 1px #c084fc47;overflow:hidden;font:12px/1.5 system-ui,-apple-system,Segoe UI,Roboto,sans-serif;backdrop-filter:blur(16px)}#qa-rpt .hd{display:flex;align-items:center;gap:8px;padding:10px 12px;background:var(--qa-accent);border-bottom:1px solid var(--qa-border);cursor:move;user-select:none}#qa-rpt .title{background:linear-gradient(135deg,#a855f7,#c084fc);-webkit-background-clip:text;-webkit-text-fill-color:transparent;background-clip:text;font-size:12px;font-weight:800;letter-spacing:.3px}#qa-rpt .grow{flex:1}#qa-rpt .btn-ico{cursor:pointer;opacity:.75;padding:4px;border-radius:7px;transition:all .2s cubic-bezier(.4,0,.2,1);user-select:none;font-size:11px;background:#ffffff0d}#qa-rpt .btn-ico:hover{opacity:1;background:#c084fc40;transform:scale(1.1);box-shadow:0 0 12px #c084fc66}#qa-rpt .ft{display:flex;gap:6px;padding:10px 12px;background:var(--qa-accent);border-top:1px solid var(--qa-border);flex-direction:column}#qa-rpt .btn-inline-group{display:flex;gap:0}#qa-rpt .btn-inline-group .btn{margin:0}#qa-rpt .btn-inline-group .btn--with-addon{flex:1 1 auto;border-top-right-radius:0;border-bottom-right-radius:0;border-right:none}#qa-rpt .btn-inline-group .btn-icon-only{flex:0 0 auto;padding:0 12px;display:flex;align-items:center;justify-content:center;min-width:38px;font-size:16px;border-top-left-radius:0;border-bottom-left-radius:0;border-left:none}#qa-rpt .qa-sync-row{display:flex;align-items:center}#qa-rpt .qa-sync-controls{display:flex;width:100%}#qa-rpt .qa-sync-controls .btn{flex:1 1 auto;border-top-right-radius:0;border-bottom-right-radius:0;border-right:none}#qa-rpt .qa-sync-indicator{display:inline-flex;align-items:center;justify-content:center;min-width:38px;min-height:36px;padding:0 12px;border-radius:0 9px 9px 0;border:1px solid rgba(192,132,252,.35);margin-left:-1px;background:linear-gradient(135deg,#8b5cf61f,#c084fc14);color:var(--qa-text-dim);font-size:0;cursor:default;user-select:none;transition:border-color .25s cubic-bezier(.4,0,.2,1),box-shadow .25s cubic-bezier(.4,0,.2,1),background .25s cubic-bezier(.4,0,.2,1)}#qa-rpt .qa-sync-indicator i{font-size:18px;color:var(--qa-text-dim);transition:color .25s cubic-bezier(.4,0,.2,1)}#qa-rpt .qa-sync-indicator--active{border-color:#22c55e8c;background:linear-gradient(135deg,#22c55e47,#3b82f638);box-shadow:0 4px 14px #22c55e3d,0 0 0 2px #7dd3fc2e;color:#f0fdf4}#qa-rpt .qa-sync-indicator--active i{color:#86efac}#qa-rpt .qa-sync-indicator--unavailable{border-color:#ef444473;background:linear-gradient(135deg,#ef444433,#f8717124);color:#fee2e2}#qa-rpt .qa-sync-indicator--unavailable i{color:#fca5a5}#qa-rpt .btn{cursor:pointer;padding:8px 10px;border-radius:9px;background:linear-gradient(135deg,#8b5cf633,#c084fc26);border:1px solid rgba(192,132,252,.4);transition:all .25s cubic-bezier(.4,0,.2,1);font-weight:600;text-align:center;font-size:11px;color:var(--qa-text);box-shadow:0 2px 6px #8b5cf626}#qa-rpt .btn:hover{background:linear-gradient(135deg,#8b5cf659,#c084fc40);border-color:#c084fc99;box-shadow:0 4px 16px #8b5cf64d,0 0 0 3px #c084fc26;transform:translateY(-1px)}#qa-rpt .btn:disabled{cursor:not-allowed;opacity:.48;background:linear-gradient(135deg,#9474dd2e,#c084fc1f);border-color:#c084fc40;box-shadow:none;transform:none}#qa-rpt .btn:disabled:hover{box-shadow:none;transform:none}#qa-rpt .btn.qa-sync-active{background:linear-gradient(135deg,#22c55e59,#3b82f64d);border-color:#22c55ea6;box-shadow:0 6px 18px #22c55e47,0 0 0 2px #7dd3fc59;color:#f9fafb}#qa-rpt .btn.qa-sync-disabled{cursor:not-allowed;opacity:.48;background:linear-gradient(135deg,#9474dd2e,#c084fc1f);border-color:#c084fc40;box-shadow:none;transform:none}#qa-rpt .btn.qa-sync-disabled:hover{box-shadow:none;transform:none}#qa-status-container{position:fixed;right:20px;bottom:20px;display:flex;flex-direction:column;align-items:flex-end;gap:10px;z-index:10002;pointer-events:none}.qa-status-toast{background:var(--qa-surface-strong);color:var(--qa-text);border-radius:12px;padding:10px 14px;border:1px solid var(--qa-border);box-shadow:var(--qa-shadow-soft);font-size:12px;font-weight:600;min-width:220px;max-width:min(320px,80vw);opacity:0;transform:translateY(12px) scale(.96);transition:opacity .2s ease,transform .2s ease,filter .2s ease;backdrop-filter:blur(18px);pointer-events:auto;cursor:pointer;line-height:1.45;letter-spacing:.2px}.qa-status-toast--visible{opacity:1;transform:translateY(0) scale(1)}.qa-status-toast--leaving{opacity:0;transform:translateY(-6px) scale(.94)}.qa-status-toast:hover{filter:brightness(1.08)}.qa-tooltip{position:absolute;z-index:10020;background:var(--qa-surface-strong);color:var(--qa-text);border:1px solid var(--qa-border);border-radius:10px;padding:8px 10px;font-size:11px;line-height:1.4;max-width:240px;box-shadow:var(--qa-shadow-soft);pointer-events:none;opacity:0;transform:translateY(-4px);transition:opacity .15s ease,transform .15s ease;backdrop-filter:blur(14px)}.qa-tooltip--visible{opacity:1;transform:translateY(0)}.qa-tooltip:before,.qa-tooltip:after{content:"";position:absolute;left:50%;transform:translate(-50%);border-style:solid}.qa-tooltip:before{top:-7px;border-width:0 8px 8px 8px;border-color:transparent transparent rgba(192,132,252,.35) transparent}.qa-tooltip:after{top:-6px;border-width:0 7px 7px 7px;border-color:transparent transparent var(--qa-surface-strong) transparent}#qa-col-modal{position:fixed;left:50%;top:6%;transform:translate(-50%);width:min(860px,90vw);max-height:82vh;overflow:hidden;background:var(--qa-bg);color:var(--qa-text);border-radius:12px;box-shadow:0 20px 60px #8b5cf652,0 0 0 1px #c084fc59,inset 0 0 0 1px #c084fc1f;display:none;flex-direction:column;backdrop-filter:blur(16px);z-index:1500;--qa-scale: .92;font-size:clamp(11px,calc(13px * var(--qa-scale, 1)),13px);transition:box-shadow .2s cubic-bezier(.4,0,.2,1)}#qa-col-modal:hover{box-shadow:0 20px 60px #8b5cf652,0 0 0 1px #c084fc61,inset 0 0 10px #8b5cf638,inset 0 0 0 2px #c084fc52}#qa-col-modal .hd{display:flex;align-items:center;gap:10px;padding:9px 12px;background:var(--qa-accent);border-bottom:1px solid var(--qa-border);cursor:move;user-select:none}#qa-col-modal .title{background:linear-gradient(135deg,#c084fc,#c4b5fd);-webkit-background-clip:text;-webkit-text-fill-color:transparent;background-clip:text;font-weight:800;font-size:clamp(11px,calc(15px * var(--qa-scale, 1)),15px);letter-spacing:.4px;text-shadow:0 0 20px rgba(236,72,153,.3)}#qa-col-modal .grow{flex:1}#qa-col-modal .tools{padding:14px;background:linear-gradient(135deg,#8b5cf614,#ec48990a);border-bottom:1px solid var(--qa-border)}#qa-col-modal .section{margin-bottom:14px}#qa-col-modal .section:last-child{margin-bottom:0}#qa-col-modal .section-title{color:var(--qa-cyan);font-size:clamp(11px,calc(11px * var(--qa-scale, 1)),11px);font-weight:800;text-transform:uppercase;letter-spacing:.9px;margin-bottom:8px;text-shadow:0 0 9px rgba(192,132,252,.45)}#qa-col-modal .filter-row{display:flex;gap:10px;align-items:stretch}#qa-col-modal .filter-row label{flex:1;display:flex;flex-direction:column;gap:6px;color:var(--qa-text-dim);font-size:clamp(11px,calc(11px * var(--qa-scale, 1)),11px);font-weight:700;text-transform:uppercase;letter-spacing:.5px}#qa-col-modal .filter-row label span{opacity:.9;background:linear-gradient(135deg,#c084fc66,#ec48994d);padding:3px 7px;border-radius:6px;display:inline-block;width:fit-content}#qa-col-modal .pickers-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(180px,1fr));gap:10px;align-items:start}#qa-col-modal .picker-item{display:flex;flex-direction:column;gap:5px}#qa-col-modal .picker-header{display:flex;align-items:center;justify-content:space-between;gap:6px}#qa-col-modal .picker-item label{color:var(--qa-blue-light);font-size:clamp(11px,calc(10px * var(--qa-scale, 1)),11px);font-weight:700;text-transform:uppercase;letter-spacing:.6px}#qa-col-modal .picker-remove{cursor:pointer;opacity:.6;font-size:clamp(11px,calc(14px * var(--qa-scale, 1)),14px);padding:2px 6px;border-radius:5px;transition:all .2s cubic-bezier(.4,0,.2,1);background:#ef444426;line-height:1}#qa-col-modal .picker-remove:hover{opacity:1;background:#ef44444d;transform:scale(1.15);box-shadow:0 0 8px #ef444466}#qa-col-modal .actions-row{display:flex;gap:8px;flex-wrap:wrap;align-items:center;padding-top:2px}#qa-col-modal select,#qa-col-modal input[type=text]{background:var(--qa-surface-strong);color:#f1f5f9f2;border:2px solid rgba(192,132,252,.3);border-radius:10px;padding:8px 12px;font-size:clamp(11px,calc(12px * var(--qa-scale, 1)),12px);width:100%;transition:all .3s cubic-bezier(.4,0,.2,1);font-family:inherit;font-weight:500;box-shadow:0 4px 16px #8b5cf614,inset 0 1px #ffffff0a}#qa-col-modal select option{background:#2a163e;color:#f5e8ff;padding:8px 12px}#qa-col-modal select option:hover,#qa-col-modal select option:checked{background:#3a1d52;color:#f1ddff}#qa-col-modal select:focus,#qa-col-modal input[type=text]:focus{outline:none;border-color:#8b5cf6b3;box-shadow:0 0 0 3px #8b5cf626,0 8px 32px #8b5cf640,inset 0 1px #ffffff14,inset 0 0 20px #8b5cf61a;background:linear-gradient(135deg,#36185cf0,#1a0e3af5)}#qa-col-modal select:hover,#qa-col-modal input[type=text]:hover{border-color:#c084fc73;box-shadow:0 6px 24px #8b5cf61f,inset 0 1px #ffffff0d}#qa-col-filter,#qa-compare-filter{padding:10px 12px 10px 14px!important;background:linear-gradient(135deg,#311554d9,#1a0e3ade)!important;border:2px solid rgba(192,132,252,.25)!important;border-radius:11px!important;letter-spacing:.35px;font-size:clamp(12px,calc(14px * var(--qa-scale, 1)),14px)!important;font-weight:500;color:#f1f5f9f2!important;box-shadow:0 3px 14px #8b5cf614,inset 0 1px #ffffff0a!important;transition:all .3s cubic-bezier(.4,0,.2,1)!important;position:relative;height:38px;display:flex;align-items:center}#qa-col-filter:not(:placeholder-shown),#qa-compare-filter:not(:placeholder-shown){background:linear-gradient(135deg,#311554e6,#1a0e3aeb)!important;border-color:#8b5cf666!important;box-shadow:0 0 0 1px #8b5cf61a,0 4px 18px #8b5cf624,inset 0 1px #ffffff0f!important}#qa-col-filter:focus,#qa-compare-filter:focus{background:linear-gradient(135deg,#36185cf0,#1a0e3af5)!important;border-color:#8b5cf6b3!important;box-shadow:0 0 0 3px #8b5cf626,0 8px 28px #8b5cf63b,inset 0 1px #ffffff14,inset 0 0 20px #8b5cf61a!important;outline:none!important}#qa-col-filter:hover,#qa-compare-filter:hover{border-color:#c084fc73!important;box-shadow:0 0 0 1px #8b5cf61a,0 6px 20px #8b5cf61c,inset 0 1px #ffffff0d!important}#qa-col-filter::placeholder,#qa-compare-filter::placeholder{color:#c084fc8c;opacity:1;font-weight:400}#qa-col-filter:focus::placeholder,#qa-compare-filter:focus::placeholder{color:#c084fca6}#qa-col-modal .btn{cursor:pointer;padding:8px 12px;border-radius:9px;background:linear-gradient(135deg,#8b5cf633,#c084fc26);border:1px solid rgba(192,132,252,.4);white-space:nowrap;transition:all .25s cubic-bezier(.4,0,.2,1);font-weight:600;font-size:clamp(11px,calc(12px * var(--qa-scale, 1)),12px);font-family:inherit;color:var(--qa-text);box-shadow:0 2px 6px #8b5cf626}#qa-col-modal .btn:hover{background:linear-gradient(135deg,#8b5cf659,#c084fc40);border-color:#c084fc99;box-shadow:0 4px 14px #8b5cf647,0 0 0 3px #c084fc26;transform:translateY(-1px)}#qa-col-modal .btn-primary{background:linear-gradient(135deg,#8b5cf6,#a855f7);border-color:#a855f7;color:#fff;font-weight:700;box-shadow:0 4px 12px #8b5cf661}#qa-col-modal .btn-primary:hover{background:linear-gradient(135deg,#9333ea,#a855f7);box-shadow:0 5px 18px #8b5cf67a,0 0 0 3px #8b5cf640;transform:translateY(-2px)}#qa-col-modal .btn-copy{background:linear-gradient(135deg,#8b5cf6,#a855f7);border-color:#a855f7;color:#fff;font-weight:700;box-shadow:0 4px 12px #8b5cf661}#qa-col-modal .btn-copy:hover{background:linear-gradient(135deg,#8b5cf6,#a855f7);box-shadow:0 4px 12px #8b5cf661;transform:none;border-color:#a855f7}#qa-col-modal .stat{color:var(--qa-cyan);font-size:clamp(11px,calc(12px * var(--qa-scale, 1)),12px);font-weight:600;padding:7px 12px;background:linear-gradient(135deg,#c084fc2e,#c084fc1a);border-radius:8px;border:1px solid rgba(192,132,252,.3);box-shadow:0 2px 7px #c084fc2e}#qa-col-modal .mode-toggle{display:inline-flex;background:#34165ce0;border-radius:9px;border:1px solid rgba(192,132,252,.35);overflow:hidden;box-shadow:0 2px 7px #8b5cf61a}#qa-col-modal .mode-toggle button{padding:7px 14px;background:transparent;border:none;color:var(--qa-text-dim);font-size:clamp(11px,calc(11px * var(--qa-scale, 1)),11px);font-weight:700;cursor:pointer;transition:all .2s cubic-bezier(.4,0,.2,1);font-family:inherit;text-transform:uppercase;letter-spacing:.5px;border-right:1px solid rgba(192,132,252,.2)}#qa-col-modal .mode-toggle button:last-child{border-right:none}#qa-col-modal .mode-toggle button.active{background:linear-gradient(135deg,#8b5cf64d,#c084fc33);color:var(--qa-cyan);text-shadow:0 0 8px rgba(192,132,252,.5)}#qa-col-modal .mode-toggle button:hover:not(.active){background:#c084fc1a;color:var(--qa-text)}#qa-col-modal .body{padding:18px;overflow:auto;flex:1}#qa-col-modal pre.list,pre.list.json-viewer{background:linear-gradient(135deg,#210d3ff2,#120929e6);border:1px solid rgba(192,132,252,.3);border-radius:12px;padding:14px;white-space:pre-wrap;word-break:break-word;font-size:clamp(11px,calc(12px * var(--qa-scale, 1)),12px);line-height:1.6;font-family:Consolas,Monaco,Courier New,monospace;color:#e2e8f0;margin:0;box-shadow:0 4px 16px #8b5cf626}.body pre.list.json-viewer .json-key,.customize-content pre.list.json-viewer .json-key{color:#c084fc;font-weight:600}.body pre.list.json-viewer .json-string,.customize-content pre.list.json-viewer .json-string{color:#34d399}.body pre.list.json-viewer .json-number,.customize-content pre.list.json-viewer .json-number{color:#a855f7}.body pre.list.json-viewer .json-bool,.body pre.list.json-viewer .json-null,.customize-content pre.list.json-viewer .json-bool,.customize-content pre.list.json-viewer .json-null{color:#f87171;font-weight:600}#qa-col-modal table.data-table{width:100%;border-collapse:collapse;background:linear-gradient(135deg,#210d3ff2,#120929e6);border:1px solid rgba(192,132,252,.3);border-radius:12px;box-shadow:0 4px 16px #8b5cf626;overflow:hidden}#qa-col-modal table.data-table th{background:linear-gradient(135deg,#8b5cf640,#c084fc26);color:var(--qa-cyan);font-size:clamp(11px,calc(11px * var(--qa-scale, 1)),11px);font-weight:800;text-transform:uppercase;letter-spacing:.8px;padding:12px 14px;text-align:left;border-bottom:2px solid rgba(192,132,252,.4);position:sticky;top:0;z-index:10;text-shadow:0 0 8px rgba(192,132,252,.3)}#qa-col-modal table.data-table td{padding:10px 14px;font-size:clamp(11px,calc(12px * var(--qa-scale, 1)),12px);color:#e2e8f0;border-bottom:1px solid rgba(192,132,252,.15);font-family:Consolas,Monaco,Courier New,monospace;word-break:break-word}#qa-col-modal table.data-table tr:last-child td{border-bottom:none}#qa-col-modal table.data-table tr:hover td{background:#c084fc14}#qa-col-modal table.data-table td.null-value{color:var(--qa-text-dim);opacity:.6;font-style:italic}#qa-col-modal table.data-table td.object-value{color:var(--qa-purple);font-size:clamp(11px,calc(11px * var(--qa-scale, 1)),11px)}.qa-loader-overlay{position:absolute;inset:0;z-index:100;background:#0f172af2;display:flex;flex-direction:column;align-items:center;justify-content:center;backdrop-filter:blur(8px)}.qa-loader-spinner{width:60px;height:60px;border:4px solid rgba(192,132,252,.2);border-top:4px solid var(--qa-cyan);border-radius:50%;animation:qa-spin 1s linear infinite;box-shadow:0 0 20px #c084fc73}@keyframes qa-spin{0%{transform:rotate(0)}to{transform:rotate(360deg)}}.qa-loader-text{margin-top:20px;color:var(--qa-cyan);font-size:clamp(11px,calc(14px * var(--qa-scale, 1)),14px);font-weight:600;text-shadow:0 0 10px rgba(192,132,252,.5)}.qa-loader-progress{margin-top:10px;color:var(--qa-text-dim);font-size:clamp(11px,calc(12px * var(--qa-scale, 1)),12px)}.qa-loader-cancel{margin-top:20px;padding:10px 20px;background:linear-gradient(135deg,#ef44444d,#ef444433);border:1px solid rgba(239,68,68,.5);border-radius:10px;color:#fca5a5;font-size:clamp(11px,calc(12px * var(--qa-scale, 1)),12px);font-weight:600;cursor:pointer;transition:all .25s cubic-bezier(.4,0,.2,1)}.qa-loader-cancel:hover{background:linear-gradient(135deg,#ef444480,#ef44444d);border-color:#ef4444b3;box-shadow:0 4px 16px #ef44444d;transform:translateY(-1px)}#qa-filters-modal{position:fixed;left:50%;top:6%;transform:translate(-50%);width:min(760px,88vw);max-height:80vh;overflow:hidden;background:var(--qa-bg);color:var(--qa-text);border-radius:12px;box-shadow:0 20px 60px #8b5cf652,0 0 0 1px #c084fc59,inset 0 0 0 1px #c084fc1f;display:none;flex-direction:column;backdrop-filter:blur(16px);z-index:1500;--qa-scale: .92;font-size:clamp(11px,calc(13px * var(--qa-scale, 1)),13px);transition:box-shadow .2s cubic-bezier(.4,0,.2,1)}#qa-filters-modal:hover{box-shadow:0 20px 60px #8b5cf652,0 0 0 1px #c084fc61,inset 0 0 10px #8b5cf638,inset 0 0 0 2px #c084fc52}#qa-filters-modal .hd{display:flex;align-items:center;gap:10px;padding:9px 12px;background:var(--qa-accent);border-bottom:1px solid var(--qa-border);cursor:move;user-select:none}#qa-filters-modal .title{background:linear-gradient(135deg,#c084fc,#c4b5fd);-webkit-background-clip:text;-webkit-text-fill-color:transparent;background-clip:text;font-weight:800;font-size:clamp(11px,calc(15px * var(--qa-scale, 1)),15px);letter-spacing:.4px;text-shadow:0 0 20px rgba(236,72,153,.3)}#qa-filters-modal .grow{flex:1}#qa-filters-modal .filters-tools{padding:14px;background:linear-gradient(135deg,#8b5cf614,#ec48990a);border-bottom:1px solid var(--qa-border)}#qa-filters-modal .filters-actions{display:flex;gap:8px;flex-wrap:wrap;align-items:center}#qa-filters-modal .btn-action{cursor:pointer;padding:8px 12px;border-radius:9px;background:linear-gradient(135deg,#8b5cf633,#c084fc26);border:1px solid rgba(192,132,252,.4);white-space:nowrap;transition:all .25s cubic-bezier(.4,0,.2,1);font-weight:600;font-size:clamp(11px,calc(12px * var(--qa-scale, 1)),12px);font-family:inherit;color:var(--qa-text);box-shadow:0 2px 6px #8b5cf626;display:flex;align-items:center;gap:7px}#qa-filters-modal .btn-action .icon{font-size:clamp(12px,calc(13px * var(--qa-scale, 1)),13px)}#qa-filters-modal .btn-action:hover{background:linear-gradient(135deg,#8b5cf659,#c084fc40);border-color:#c084fc99;box-shadow:0 4px 16px #8b5cf64d,0 0 0 3px #c084fc26;transform:translateY(-1px)}#qa-filters-modal .btn-action.primary{background:linear-gradient(135deg,#8b5cf6,#a855f7);border-color:#a855f7;color:#fff;font-weight:700;box-shadow:0 4px 14px #8b5cf666}#qa-filters-modal .btn-action.primary:hover{background:linear-gradient(135deg,#9333ea,#a855f7);box-shadow:0 5px 20px #8b5cf680,0 0 0 3px #8b5cf640;transform:translateY(-2px)}#qa-filters-modal .body{padding:16px;overflow:auto;flex:1}#qa-filters-modal .filter-content{width:100%}#qa-filters-modal pre.list{background:linear-gradient(135deg,#210d3ff2,#120929e6);border:1px solid rgba(192,132,252,.3);border-radius:12px;padding:14px;white-space:pre-wrap;word-break:break-word;font-size:clamp(11px,calc(12px * var(--qa-scale, 1)),12px);line-height:1.6;font-family:Consolas,Monaco,Courier New,monospace;color:#e2e8f0;margin:0;box-shadow:0 4px 16px #8b5cf626}#qa-filters-modal .body::-webkit-scrollbar{width:10px}#qa-filters-modal .body::-webkit-scrollbar-track{background:#0000004d;border-radius:10px}#qa-filters-modal .body::-webkit-scrollbar-thumb{background:linear-gradient(135deg,#c084fc80,#8b5cf699);border-radius:10px;border:2px solid transparent;background-clip:padding-box;box-shadow:0 0 8px #8b5cf666}#qa-filters-modal .body::-webkit-scrollbar-thumb:hover{background:linear-gradient(135deg,#c084fcb3,#8b5cf6cc);background-clip:padding-box;box-shadow:0 0 12px #8b5cf699}#qa-customize-modal{position:fixed;left:50%;top:6%;transform:translate(-50%);width:min(760px,88vw);max-height:80vh;overflow:hidden;background:var(--qa-bg);color:var(--qa-text);border-radius:12px;box-shadow:0 20px 60px #8b5cf652,0 0 0 1px #c084fc59,inset 0 0 0 1px #c084fc1f;display:none;flex-direction:column;backdrop-filter:blur(16px);z-index:1500;--qa-scale: .92;font-size:clamp(11px,calc(13px * var(--qa-scale, 1)),13px);transition:box-shadow .2s cubic-bezier(.4,0,.2,1)}#qa-customize-modal:hover{box-shadow:0 20px 60px #8b5cf652,0 0 0 1px #c084fc61,inset 0 0 10px #8b5cf638,inset 0 0 0 2px #c084fc52}#qa-customize-modal .hd{display:flex;align-items:center;gap:10px;padding:9px 12px;background:var(--qa-accent);border-bottom:1px solid var(--qa-border);cursor:move;user-select:none}#qa-customize-modal .title{background:linear-gradient(135deg,#c084fc,#c4b5fd);-webkit-background-clip:text;-webkit-text-fill-color:transparent;background-clip:text;font-weight:800;font-size:clamp(11px,calc(15px * var(--qa-scale, 1)),15px);letter-spacing:.4px;text-shadow:0 0 20px rgba(236,72,153,.3)}#qa-customize-modal .grow{flex:1}#qa-customize-modal .customize-tools{padding:14px;background:linear-gradient(135deg,#8b5cf614,#ec48990a);border-bottom:1px solid var(--qa-border)}#qa-customize-modal .customize-actions{display:flex;gap:8px;flex-wrap:wrap;align-items:center}#qa-customize-modal .btn-action{cursor:pointer;padding:8px 12px;border-radius:9px;background:linear-gradient(135deg,#8b5cf633,#c084fc26);border:1px solid rgba(192,132,252,.4);white-space:nowrap;transition:all .25s cubic-bezier(.4,0,.2,1);font-weight:600;font-size:clamp(11px,calc(12px * var(--qa-scale, 1)),12px);font-family:inherit;color:var(--qa-text);box-shadow:0 2px 6px #8b5cf626;display:flex;align-items:center;gap:7px}#qa-customize-modal .btn-action .icon{font-size:clamp(12px,calc(13px * var(--qa-scale, 1)),13px)}#qa-customize-modal .btn-action:hover{background:linear-gradient(135deg,#8b5cf659,#c084fc40);border-color:#c084fc99;box-shadow:0 4px 16px #8b5cf64d,0 0 0 3px #c084fc26;transform:translateY(-1px)}#qa-customize-modal .btn-action.primary{background:linear-gradient(135deg,#8b5cf6,#a855f7);border-color:#a855f7;color:#fff;font-weight:700;box-shadow:0 4px 14px #8b5cf666}#qa-customize-modal .btn-action.primary:hover{background:linear-gradient(135deg,#9333ea,#a855f7);box-shadow:0 5px 20px #8b5cf680,0 0 0 3px #8b5cf640;transform:translateY(-2px)}#qa-customize-modal .body{padding:16px;overflow:auto;flex:1}#qa-customize-modal .customize-content{width:100%}#qa-customize-modal .body::-webkit-scrollbar{width:10px}#qa-customize-modal .body::-webkit-scrollbar-track{background:#0000004d;border-radius:10px}#qa-customize-modal .body::-webkit-scrollbar-thumb{background:linear-gradient(135deg,#c084fc80,#8b5cf699);border-radius:10px;border:2px solid transparent;background-clip:padding-box;box-shadow:0 0 8px #8b5cf666}#qa-customize-modal .body::-webkit-scrollbar-thumb:hover{background:linear-gradient(135deg,#c084fcb3,#8b5cf6cc);background-clip:padding-box;box-shadow:0 0 12px #8b5cf699}.qa-resize-handle{position:absolute;background:transparent;border:none;opacity:0;z-index:11}.qa-resize-handle.resize-n,.qa-resize-handle.resize-s{left:0;right:0;height:8px}.qa-resize-handle.resize-n{top:0;cursor:ns-resize}.qa-resize-handle.resize-s{bottom:0;cursor:ns-resize}.qa-resize-handle.resize-e,.qa-resize-handle.resize-w{top:0;bottom:0;width:8px}.qa-resize-handle.resize-e{right:0;cursor:ew-resize}.qa-resize-handle.resize-w{left:0;cursor:ew-resize}.qa-resize-handle.resize-ne,.qa-resize-handle.resize-nw,.qa-resize-handle.resize-se,.qa-resize-handle.resize-sw{width:10px;height:10px;z-index:12}.qa-resize-handle.resize-ne{top:0;right:0;cursor:nesw-resize}.qa-resize-handle.resize-nw{top:0;left:0;cursor:nwse-resize}.qa-resize-handle.resize-se{bottom:0;right:0;cursor:nwse-resize}.qa-resize-handle.resize-sw{bottom:0;left:0;cursor:nesw-resize}.qa-tab{position:fixed;right:0;z-index:10001;width:26px;min-height:88px;padding:6px 0;display:flex;flex-direction:column;align-items:center;justify-content:center;gap:6px;color:var(--qa-text);background:var(--qa-tab-bg);border-left:2px solid var(--qa-border);border-top:1px solid var(--qa-border-muted);border-bottom:1px solid var(--qa-border-muted);border-top-left-radius:8px;border-bottom-left-radius:8px;box-shadow:-6px 0 24px #8b5cf64d;cursor:grab;user-select:none;backdrop-filter:blur(12px);transition:background .25s cubic-bezier(.4,0,.2,1),box-shadow .25s cubic-bezier(.4,0,.2,1),border-left-color .25s cubic-bezier(.4,0,.2,1)}.qa-tab.qa-tab--dragging{cursor:grabbing;box-shadow:-12px 0 36px #8b5cf68c}.qa-tab:hover{background:var(--qa-tab-hover);box-shadow:-10px 0 36px #8b5cf680;border-left-color:var(--qa-cyan);border-left-width:3px}.qa-tab:active{border-left-color:var(--qa-blue)}.qa-tab .label{writing-mode:vertical-rl;text-orientation:mixed;font-weight:700;font-size:8px;letter-spacing:.8px;text-transform:uppercase;flex:1;overflow:hidden;text-overflow:ellipsis;color:var(--qa-cyan);text-shadow:0 0 10px rgba(192,132,252,.5)}.qa-tab-close{margin-top:auto;width:18px;height:18px;border-radius:50%;border:1px solid rgba(192,132,252,.4);background:#0f172a8c;color:var(--qa-text);font-size:10px;display:flex;align-items:center;justify-content:center;cursor:pointer;transition:transform .18s ease,box-shadow .18s ease,background .18s ease}.qa-tab-close:hover{background:#9459ffcc;box-shadow:0 0 12px #c084fc8c;transform:scale(1.05)}.qa-tab-close:focus{outline:none;box-shadow:0 0 0 2px #ffffff4d,0 0 12px #c084fc99}@keyframes qa-tab-pulse{0%{transform:translate(0)}50%{transform:translate(-6px)}to{transform:translate(0)}}.qa-tab.qa-tab-pulse{animation:qa-tab-pulse .45s ease}#qa-col-modal .body::-webkit-scrollbar{width:10px}#qa-col-modal .body::-webkit-scrollbar-track{background:#0000004d;border-radius:10px}#qa-col-modal .body::-webkit-scrollbar-thumb{background:linear-gradient(135deg,#c084fc80,#8b5cf699);border-radius:10px;border:2px solid transparent;background-clip:padding-box;box-shadow:0 0 8px #8b5cf666}#qa-col-modal .body::-webkit-scrollbar-thumb:hover{background:linear-gradient(135deg,#c084fcb3,#8b5cf6cc);background-clip:padding-box;box-shadow:0 0 12px #8b5cf699}#qa-compare-modal{position:fixed;left:50%;top:6%;transform:translate(-50%);width:min(860px,90vw);max-height:82vh;overflow:hidden;background:var(--qa-bg);color:var(--qa-text);border-radius:12px;box-shadow:0 20px 60px #8b5cf652,0 0 0 1px #c084fc59,inset 0 0 0 1px #c084fc1f;display:none;flex-direction:column;backdrop-filter:blur(16px);z-index:1500;--qa-scale: .92;font-size:clamp(11px,calc(13px * var(--qa-scale, 1)),13px);transition:box-shadow .2s cubic-bezier(.4,0,.2,1)}#qa-compare-modal:hover{box-shadow:0 20px 60px #8b5cf652,0 0 0 1px #c084fc61,inset 0 0 10px #8b5cf638,inset 0 0 0 2px #c084fc52}#qa-compare-modal .hd{display:flex;align-items:center;gap:10px;padding:9px 12px;background:var(--qa-accent);border-bottom:1px solid var(--qa-border);cursor:move;user-select:none}#qa-compare-modal .title{background:linear-gradient(135deg,#c084fc,#c4b5fd);-webkit-background-clip:text;-webkit-text-fill-color:transparent;background-clip:text;font-weight:800;font-size:clamp(11px,calc(15px * var(--qa-scale, 1)),15px);letter-spacing:.4px;text-shadow:0 0 20px rgba(236,72,153,.3)}#qa-compare-modal .grow{flex:1}#qa-compare-modal .tools{padding:16px;background:linear-gradient(135deg,#8b5cf614,#ec48990a);border-bottom:1px solid var(--qa-border)}#qa-compare-modal .section{margin-bottom:14px}#qa-compare-modal .section:last-child{margin-bottom:0}#qa-compare-modal .section-title{color:var(--qa-cyan);font-size:clamp(11px,calc(11px * var(--qa-scale, 1)),11px);font-weight:800;text-transform:uppercase;letter-spacing:.9px;margin-bottom:8px;text-shadow:0 0 9px rgba(192,132,252,.45)}#qa-compare-modal .info-box{padding:12px 16px;background:linear-gradient(135deg,#8b5cf62e,#ec48991f);border-radius:12px;border:1px solid rgba(192,132,252,.42);color:var(--qa-text);font-size:clamp(11px,calc(13px * var(--qa-scale, 1)),13px);line-height:1.7;box-shadow:inset 0 1px #ffffff0f,0 16px 36px #20123e6b;backdrop-filter:blur(18px)}.status-box{padding:14px 16px;border-radius:12px;border:1px solid var(--qa-border);background:linear-gradient(135deg,#7a2db347,#36185c52);color:var(--qa-text-muted);font-size:clamp(11px,calc(13px * var(--qa-scale, 1)),13px);line-height:1.6;box-shadow:0 10px 28px #8b5cf633;transition:all .25s cubic-bezier(.4,0,.2,1)}.status-box.is-ready{border-color:#22c55e73;background:linear-gradient(135deg,#22c55e38,#7a2db347);color:#bbf7d0;box-shadow:0 14px 38px #22c55e59}.status-box.is-waiting{border-color:#c084fc40;background:linear-gradient(135deg,#7a2db338,#210d3f47);color:var(--qa-text-muted);box-shadow:0 10px 26px #8b5cf62e}#qa-compare-modal .info-box i{margin:0 2px}#qa-compare-modal .filter-row{display:flex;gap:10px;align-items:stretch}#qa-compare-modal .filter-row label{flex:1;display:flex;flex-direction:column;gap:6px;color:var(--qa-text-dim);font-size:clamp(11px,calc(11px * var(--qa-scale, 1)),11px);font-weight:700;text-transform:uppercase;letter-spacing:.5px}#qa-compare-modal .filter-row label span{opacity:.9;background:linear-gradient(135deg,#c084fc66,#ec48994d);padding:4px 8px;border-radius:6px;display:inline-block;width:fit-content}#qa-compare-modal select,#qa-compare-modal input[type=text]{background:var(--qa-surface-strong);color:#f1f5f9f2;border:2px solid rgba(192,132,252,.3);border-radius:12px;padding:10px 14px;font-size:clamp(12px,calc(13px * var(--qa-scale, 1)),13px);width:100%;transition:all .3s cubic-bezier(.4,0,.2,1);font-family:inherit;font-weight:500;box-shadow:0 4px 16px #8b5cf614,inset 0 1px #ffffff0a}#qa-compare-modal select:focus,#qa-compare-modal input[type=text]:focus{outline:none;border-color:#8b5cf6b3;box-shadow:0 0 0 3px #8b5cf626,0 8px 32px #8b5cf640,inset 0 1px #ffffff14,inset 0 0 20px #8b5cf61a;background:linear-gradient(135deg,#36185cf0,#1a0e3af5)}#qa-compare-modal select:hover,#qa-compare-modal input[type=text]:hover{border-color:#c084fc73;box-shadow:0 6px 24px #8b5cf61f,inset 0 1px #ffffff0d}#qa-compare-modal .actions-row{display:flex;gap:8px;flex-wrap:wrap;align-items:center;padding-top:2px}#qa-compare-modal .diff-toggle{display:inline-flex;align-items:center;gap:8px;padding:9px 14px;border-radius:8px;border:1px solid rgba(192,132,252,.3);background:linear-gradient(135deg,#8b5cf61f,#c084fc14);color:var(--qa-text-dim);font-size:clamp(11px,calc(11px * var(--qa-scale, 1)),11px);font-weight:600;cursor:pointer;user-select:none;box-shadow:0 2px 6px #8b5cf61f;transition:all .25s cubic-bezier(.4,0,.2,1)}#qa-compare-modal label{margin:0}#qa-compare-modal .diff-toggle:hover{border-color:#c084fc80;background:linear-gradient(135deg,#8b5cf62e,#c084fc1f)}#qa-compare-modal .diff-toggle i{font-size:18px;color:var(--qa-text-dim);transition:color .25s cubic-bezier(.4,0,.2,1)}#qa-compare-modal .diff-toggle i.fa-toggle-on{color:var(--qa-blue)}#qa-compare-modal .diff-toggle span{color:var(--qa-text-dim);font-size:clamp(11px,calc(11px * var(--qa-scale, 1)),11px)}#qa-compare-modal select{background:linear-gradient(135deg,#2b1147e6,#160c30eb);color:var(--qa-text);border:1px solid rgba(192,132,252,.35);border-radius:9px;padding:8px 11px;font-size:clamp(11px,calc(12px * var(--qa-scale, 1)),12px);width:100%;transition:all .25s cubic-bezier(.4,0,.2,1);font-family:inherit;box-shadow:0 2px 7px #8b5cf61a}#qa-compare-modal select option{background:#2a163e;color:#f5e8ff;padding:8px 12px}#qa-compare-modal select option:hover,#qa-compare-modal select option:checked{background:#3a1d52;color:#f1ddff}#qa-compare-modal select:focus{outline:none;border-color:var(--qa-blue-bright);box-shadow:0 0 0 3px #c084fc38,0 4px 12px #8b5cf640;background:linear-gradient(135deg,#2d124bf2,#180d34f5)}#qa-compare-modal select:hover{border-color:#c084fc80;box-shadow:0 4px 12px #8b5cf626}#qa-compare-modal .btn{cursor:pointer;padding:8px 12px;border-radius:9px;background:linear-gradient(135deg,#8b5cf633,#c084fc26);border:1px solid rgba(192,132,252,.4);white-space:nowrap;transition:all .25s cubic-bezier(.4,0,.2,1);font-weight:600;font-size:clamp(11px,calc(12px * var(--qa-scale, 1)),12px);font-family:inherit;color:var(--qa-text);box-shadow:0 2px 6px #8b5cf626}#qa-compare-modal .btn.disabled,#qa-compare-modal .btn:disabled{opacity:.5;cursor:not-allowed;pointer-events:none;box-shadow:none;filter:grayscale(.2)}#qa-compare-modal .btn:hover{background:linear-gradient(135deg,#8b5cf659,#c084fc40);border-color:#c084fc99;box-shadow:0 4px 16px #8b5cf64d,0 0 0 3px #c084fc26;transform:translateY(-1px)}#qa-compare-modal .btn-primary{background:linear-gradient(135deg,#8b5cf6,#a855f7);border-color:#a855f7;color:#fff;font-weight:700;box-shadow:0 4px 14px #8b5cf666}#qa-compare-modal .btn-primary:hover{background:linear-gradient(135deg,#9333ea,#a855f7);box-shadow:0 5px 20px #8b5cf680,0 0 0 3px #8b5cf640;transform:translateY(-2px)}#qa-compare-modal .stat{color:var(--qa-cyan);font-size:clamp(11px,calc(12px * var(--qa-scale, 1)),12px);font-weight:600;padding:7px 12px;background:linear-gradient(135deg,#c084fc2e,#c084fc1a);border-radius:8px;border:1px solid rgba(192,132,252,.3);box-shadow:0 2px 7px #c084fc2e}#qa-compare-modal .body{padding:16px;overflow:auto;flex:1}#qa-compare-modal pre.list{background:linear-gradient(135deg,#210d3ff2,#120929e6);border:1px solid rgba(192,132,252,.28);border-radius:10px;padding:12px;white-space:pre-wrap;word-break:break-word;font-size:clamp(11px,calc(12px * var(--qa-scale, 1)),12px);line-height:1.6;font-family:Consolas,Monaco,Courier New,monospace;color:#e2e8f0;margin:0;box-shadow:0 4px 16px #8b5cf626}#qa-compare-modal table.data-table{width:100%;border-collapse:collapse;background:linear-gradient(135deg,#210d3ff2,#120929e6);border:1px solid rgba(192,132,252,.28);border-radius:10px;box-shadow:0 3px 14px #8b5cf624;overflow:hidden}#qa-compare-modal table.data-table th{background:linear-gradient(135deg,#8b5cf640,#c084fc26);color:var(--qa-cyan);font-size:clamp(11px,calc(11px * var(--qa-scale, 1)),11px);font-weight:800;text-transform:uppercase;letter-spacing:.7px;padding:10px 12px;text-align:left;border-bottom:2px solid rgba(192,132,252,.4);position:sticky;top:0;z-index:10;text-shadow:0 0 8px rgba(192,132,252,.3)}#qa-compare-modal table.data-table td{padding:8px 12px;font-size:clamp(11px,calc(12px * var(--qa-scale, 1)),12px);color:#e2e8f0;border-bottom:1px solid rgba(192,132,252,.15);font-family:Consolas,Monaco,Courier New,monospace;word-break:break-word}#qa-compare-modal table.data-table tr:last-child td{border-bottom:none}#qa-compare-modal table.data-table tr:hover td{background:#c084fc14}#qa-compare-modal table.data-table td.null-value{color:var(--qa-text-dim);opacity:.6;font-style:italic}#qa-compare-modal table.compare-table tbody tr:nth-child(2n) td{background:#a855f714}#qa-compare-modal table.compare-table tbody tr td:first-child{border-right:1px solid rgba(192,132,252,.18)}#qa-compare-modal table.compare-table td{font-family:Inter,Segoe UI,Roboto,sans-serif;letter-spacing:.2px}#qa-compare-modal .body::-webkit-scrollbar{width:10px}#qa-compare-modal .body::-webkit-scrollbar-track{background:#0000004d;border-radius:10px}#qa-compare-modal .body::-webkit-scrollbar-thumb{background:linear-gradient(135deg,#c084fc80,#8b5cf699);border-radius:10px;border:2px solid transparent;background-clip:padding-box;box-shadow:0 0 8px #8b5cf666}#qa-compare-modal .body::-webkit-scrollbar-thumb:hover{background:linear-gradient(135deg,#c084fcb3,#8b5cf6cc);background-clip:padding-box;box-shadow:0 0 12px #8b5cf699}pre.json-customize{background:linear-gradient(135deg,#210d3ff2,#120929e6);padding:14px;border-radius:8px;overflow:auto;max-height:100%;font-family:Consolas,Monaco,Courier New,monospace;font-size:11px;line-height:1.6;color:#e2e8f0;border:1px solid rgba(192,132,252,.3);margin:0;word-break:break-word;white-space:pre-wrap}pre.json-customize .json-key{color:#c084fc;font-weight:600}pre.json-customize .json-string{color:#34d399}pre.json-customize .json-number{color:#a855f7}pre.json-customize .json-bool,pre.json-customize .json-null{color:#f87171;font-weight:600}.qa-json-modal{position:fixed;top:50%;left:50%;transform:translate(-50%,-50%);background:var(--qa-bg);border:1px solid var(--qa-border);border-radius:14px;padding:20px;z-index:20000;width:90%;max-width:500px;box-shadow:0 20px 60px #0000004d;font-family:inherit}.qa-json-modal-title{margin-bottom:12px;font-weight:600;color:var(--qa-text)}.qa-json-modal textarea{width:100%;height:200px;padding:12px;background:var(--qa-bg-secondary, rgba(15, 23, 42, .5));border:1px solid var(--qa-border);border-radius:8px;font-family:Consolas,Monaco,Courier New,monospace;font-size:12px;color:var(--qa-text);resize:vertical;box-sizing:border-box}.qa-json-modal-buttons{display:flex;gap:10px;margin-top:16px}.qa-json-modal button{flex:1;padding:10px;border-radius:8px;font-weight:600;cursor:pointer;transition:all .25s;border:none}.qa-json-modal .btn-ok{background:linear-gradient(135deg,#8b5cf6,#a855f7);border:1px solid #a855f7;color:#fff}.qa-json-modal .btn-ok:hover{box-shadow:0 8px 24px #8b5cf666;transform:translateY(-2px)}.qa-json-modal .btn-cancel{background:#c084fc33;border:1px solid rgba(192,132,252,.4);color:var(--qa-text)}.qa-json-modal .btn-cancel:hover{background:#c084fc4d;border-color:#c084fc80}
`;R();se();ce();R();te();we();function at(e,t={}){if(!e)return null;let{message:a="Loading data...",progress:o="Preparing...",cancellable:r=!1,cancelLabel:n="Cancel",onCancel:i}=t,c=document.createElement("div");c.className="qa-loader-overlay",c.innerHTML=`<div class="qa-loader-spinner"></div><div class="qa-loader-text"></div><div class="qa-loader-progress"></div><button class="qa-loader-cancel">${n}</button>`;let p=c.querySelector(".qa-loader-text"),m=c.querySelector(".qa-loader-progress"),l=c.querySelector(".qa-loader-cancel");return p&&(p.textContent=a),m&&(m.textContent=o),l&&(r?l.addEventListener("click",()=>{typeof i=="function"&&i()}):l.remove()),e.appendChild(c),{element:c,setMessage(d){p&&(p.textContent=d)},setProgress(d){m&&(m.textContent=d)},remove(){c.remove()}}}R();function Oa(e){return Number.isFinite(e)}function ot(e=s.lastPayload){if(!e||typeof e!="object")return null;let t=e.totalRows??e.recordsFiltered??e.recordsTotal;return Oa(t)?t:null}function nr(e){return JSON.stringify({column:e,direction:"desc"})}function Ma(e,t){if(!e||!t)return;let a=e.has("order[column]")&&e.has("order[direction]");if(e.has("order[0][column]")){e.set("order[0][column]",t),e.has("order[0][dir]")&&e.set("order[0][dir]","desc"),e.has("order[0][direction]")&&e.set("order[0][direction]","desc");return}if(a){e.set("order[column]",t),e.set("order[direction]","desc");return}e.set("order",nr(t))}function sr(e){return typeof e=="function"&&e()}function ir(e){return new Promise(t=>setTimeout(t,e))}async function rt(e,t={}){if(!e)throw new Error("Missing table request info");let{columnName:a="",pageSize:o=200,shouldCancel:r,onProgress:n,requestDelay:i=100}=t,{url:c,requestData:p}=e,m=new URLSearchParams(p);m.set("start","0"),m.set("length",String(o)),Ma(m,a);let l=()=>$.ajax({url:c,method:"POST",data:m.toString(),contentType:"application/x-www-form-urlencoded; charset=UTF-8",dataType:"json",headers:{"X-Requested-With":"XMLHttpRequest"}}),d=await l(),f=d.recordsFiltered??d.recordsTotal??d.totalRows??0,b=Oa(f)?f:0,h=Array.isArray(d.data)?[...d.data]:[];typeof n=="function"&&n({loaded:h.length,totalRows:b,isFirstBatch:!0});let g=h.length;for(;h.length<b;){if(sr(r)){let S=new Error("Cancelled");throw S.name="FetchCancelledError",S}m.set("start",String(g)),m.set("length",String(o)),Ma(m,a);let x=await l(),w=Array.isArray(x.data)?x.data:[];if(w.length===0)break;h=h.concat(w),g+=o,typeof n=="function"&&n({loaded:h.length,totalRows:b}),i>0&&await ir(i)}return{rows:h,totalRows:b,firstResponse:d}}se();Ge();var cr="qa-columns-modal",Ee=new M({id:"qa-col-modal",layoutId:cr,minWidth:520,minHeight:320});function Z(){let e=document.getElementById("qa-load-all");if(!e)return;let t=!!(s.lastRequestInfo&&s.lastPayload),a="Load full table data",o=ot(s.lastPayload),r=o!=null&&o>5e3;e.disabled=!t||r,e.textContent=o!=null?`${a} (${o})`:a,r?e.title=Oe:e.removeAttribute("title")}function dr(){if(document.getElementById("qa-col-modal"))return;let e=document.createElement("div");e.id="qa-col-modal",e.className="card qa-modal qa-modal-visible",e.innerHTML='<div class="hd" id="qa-col-drag"><span class="title">Last table response</span> <span class="grow"></span><div class="qa-window-controls"><button type="button" class="qa-window-btn qa-window-btn--close" id="qa-col-close" title="Close" aria-label="Close" data-icon="\xD7"></button> <button type="button" class="qa-window-btn qa-window-btn--reset" id="qa-col-reset" title="Reset layout" aria-label="Reset layout" data-icon="\u21BA"></button> <button type="button" class="qa-window-btn qa-window-btn--collapse" id="qa-col-collapse" title="Collapse" aria-label="Collapse" data-icon="\u2013"></button></div></div><div class="tools"><div class="section"><div class="section-title"><i class="fa fa-search"></i> Filtering</div><div class="filter-row"><label><span><i class="fa fa-search"></i> Substring search</span> <input id="qa-col-filter" placeholder="Type to filter..."></label></div></div><div class="section"><div class="section-title">\u{1F4CA} Column selection</div><div class="pickers-grid" id="qa-col-pickers"></div></div><div class="section"><div class="section-title">\u26A1 Actions</div><div class="actions-row"><button class="btn btn-primary" id="qa-load-all" disabled>Load full table data</button> <button class="btn" id="qa-col-add">\u2795 Add column</button><div class="mode-toggle"><button class="active" data-mode="json">\u{1F4C4} JSON</button> <button data-mode="table">\u{1F4CA} Table</button></div><button class="btn btn-copy" id="qa-col-copy">\u{1F4CB} Copy state JSON</button> <button class="btn" id="qa-col-csv"><i class="fa fa-save"></i> Generate CSV</button> <span class="stat" id="qa-col-stat"></span></div></div></div><div class="body"></div>',document.body.appendChild(e),document.getElementById("qa-col-close")?.addEventListener("click",()=>Ha()),document.getElementById("qa-col-reset")?.addEventListener("click",()=>{Ee.resetLayout(),Z()}),document.getElementById("qa-col-collapse")?.addEventListener("click",()=>{document.getElementById("qa-col-modal")&&(Ee.saveCurrentLayout(),I("qa-col-modal","Last table response",()=>{C("qa-col-modal"),Da(),Z()}),Ha(!0))}),document.getElementById("qa-col-add")?.addEventListener("click",()=>Ra()),document.getElementById("qa-col-filter")?.addEventListener("input",P),document.getElementById("qa-col-copy")?.addEventListener("click",ur),document.getElementById("qa-col-csv")?.addEventListener("click",fr),document.getElementById("qa-load-all")?.addEventListener("click",pr),document.querySelectorAll(".mode-toggle button").forEach(o=>{o.addEventListener("click",()=>{s.displayMode=o.dataset.mode||"json",document.querySelectorAll(".mode-toggle button").forEach(r=>r.classList.remove("active")),o.classList.add("active"),P()})}),Ra();let t=document.getElementById("qa-col-modal"),a=document.getElementById("qa-col-drag");Ee.attach(t,{dragHandle:a})}function Na(){if(dr(),C("qa-col-modal"),!s.lastPayload){let e=je();e&&(s.lastPayload=e)}Pt(),P(),Da(),Z()}function _a(){$a()&&(Pt(),P(),Z())}function pr(){if(!s.lastRequestInfo){u("\u26A0\uFE0F No request info available");return}if(s.isLoadingAll){u("\u26A0\uFE0F Full load already in progress");return}s.isLoadingAll=!0,s.cancelLoadingAll=!1;let e=document.getElementById("qa-col-modal");if(!e)return;let t=at(e,{cancellable:!0,onCancel:()=>{s.cancelLoadingAll=!0,u("\u23F3 Cancelling...")}});(async()=>{let o=_()[0]||"";try{u("\u{1F504} Loading full dataset...");let{rows:r,totalRows:n,firstResponse:i}=await rt(s.lastRequestInfo,{columnName:o,shouldCancel:()=>s.cancelLoadingAll,onProgress:({loaded:c,totalRows:p})=>{t?.setProgress(`${c} / ${p}`)}});if(s.cancelLoadingAll){u("\u26A0\uFE0F Loading cancelled");return}s.lastPayload={...i,data:r,recordsTotal:n,recordsFiltered:n},Re(s.lastPayload),tt(s.lastPayload),Pt(),P(),u(`\u2705 Loaded ${r.length} rows`)}catch(r){if(r&&r.name==="FetchCancelledError")u("\u26A0\uFE0F Loading cancelled");else{console.error("[QA Helper] Load all error:",r);let n=r?.message||r?.statusText||r?.responseText||"Unknown error";u(`\u274C Error: ${n}`),alert(`Failed to load data: ${n}`)}}finally{t?.remove(),s.isLoadingAll=!1,s.cancelLoadingAll=!1}})()}function ze(){return Array.from(document.querySelectorAll("#qa-col-pickers select"))}function Ra(){let e=document.getElementById("qa-col-pickers");if(!e)return;let t=ze();if(t.length>=8)return;let a=document.createElement("div");a.className="picker-item",a.innerHTML=`<div class="picker-header"><label>Column ${t.length+1}</label> <span class="picker-remove" title="Remove">\u2715</span></div><select></select>`,e.appendChild(a);let o=a.querySelector("select");Pa(o),a.querySelector(".picker-remove")?.addEventListener("click",()=>{a.remove(),ja(),P()}),o?.addEventListener("change",P),ja(),P()}function ja(){ze().forEach((t,a)=>{let o=t.closest(".picker-item")?.querySelector("label");o&&(o.textContent=`Column ${a+1}`)})}function Pt(){ze().forEach(e=>Pa(e))}function Pa(e){if(!e)return;e.innerHTML="";let t=s.lastPayload||je(),a=Array.isArray(t?.data)?t.data:[],o=a.length?Object.keys(a[0]):[],r=new Set(ze().filter(i=>i!==e).map(i=>i.value).filter(Boolean)),n=document.createElement("option");if(n.value="",n.textContent=o.length?"-- select column --":"-- no data --",e.appendChild(n),o.sort((i,c)=>i.localeCompare(c,"en",{sensitivity:"base"})).forEach(i=>{let c=document.createElement("option");c.value=i,c.textContent=i,r.has(i)&&(c.disabled=!0),e.appendChild(c)}),!e.value){let i=Array.from(e.options).find(c=>c.value&&!c.disabled);i&&(e.value=i.value)}}function _(){return ze().map(e=>e.value).filter(Boolean)}function Dt(){let e=s.lastPayload||je(),t=Array.isArray(e?.data)?e.data:[],a=_(),r=(document.getElementById("qa-col-filter")?.value||"").toLowerCase();if(!a.length)return{mode:"empty",data:[],total:0,unique:0};let n=[];for(let l of t){if(!r){n.push(l);continue}a.some(f=>{let b=l?.[f];return typeof b=="object"&&b!==null&&(b=JSON.stringify(b)),(b==null?"":String(b).toLowerCase()).includes(r)})&&n.push(l)}let i=a[0],c=n.map(l=>{let d=l?.[i];return typeof d=="object"&&d!==null?JSON.stringify(d):d==null?"":String(d)}),p=new Set(c).size;if(a.length===1)return{mode:"single",data:c,total:c.length,unique:p};let m=n.map(l=>{let d={};for(let f of a){let b=l?.[f];d[f]=typeof b=="object"&&b!==null?b:b??null}return d});return{mode:"multi",data:m,total:m.length,unique:p}}function P(){let e=document.getElementById("qa-col-stat"),t=document.getElementById("qa-col-copy"),a=document.querySelector("#qa-col-modal .body"),o=document.querySelector("#qa-col-modal .mode-toggle");if(!e||!t||!a||!o)return;let{mode:r,data:n,total:i,unique:c}=Dt();if(o.querySelectorAll("button").forEach(p=>{p.classList.toggle("active",p.dataset.mode===s.displayMode)}),r==="single"){if(o.hidden=!1,t.innerHTML=s.displayMode==="table"?"\u{1F4CB} Copy values":"\u{1F4CB} Copy state JSON",s.displayMode==="table"){let m=_()[0],l='<table class="data-table"><thead><tr>';l+=`<th>${m}</th>`,l+="</tr></thead><tbody>",n.forEach(d=>{l+="<tr>",d==null||d===""?l+='<td class="null-value">\u2014</td>':l+=`<td>${d}</td>`,l+="</tr>"}),l+="</tbody></table>",a.innerHTML=l}else{let m=_()[0],l=n.map(d=>({[m]:d}));a.innerHTML=Q(l)}e.textContent=`\u{1F4CA} Rows: ${i} \u2022 Unique: ${c}`}else if(r==="multi"){if(o.hidden=!1,t.innerHTML="\u{1F4CB} Copy state JSON",s.displayMode==="table"){let p=_(),m='<table class="data-table"><thead><tr>';p.forEach(l=>{m+=`<th>${l}</th>`}),m+="</tr></thead><tbody>",n.forEach(l=>{m+="<tr>",p.forEach(d=>{let f=l[d];f==null?m+='<td class="null-value">\u2014</td>':typeof f=="object"?m+=`<td class="object-value">${JSON.stringify(f)}</td>`:m+=`<td>${String(f)}</td>`}),m+="</tr>"}),m+="</tbody></table>",a.innerHTML=m}else a.innerHTML=Q(n);e.textContent=`\u{1F4E6} Objects: ${i} \u2022 Unique: ${c}`}else o.hidden=!0,t.innerHTML="\u{1F4CB} Copy",a.innerHTML='<pre class="list">(no data)</pre>',e.textContent=""}function ur(){let{mode:e,data:t}=Dt();if(e==="single"){let o=_()[0];if(s.displayMode==="json"){let r=(t||[]).map(n=>({[o]:n}));GM_setClipboard(JSON.stringify(r,null,2),"text"),u("\u2705 JSON copied")}else GM_setClipboard((t||[]).join(`
`),"text"),u("\u2705 List copied")}else e==="multi"?(GM_setClipboard(JSON.stringify(t||[],null,2),"text"),u("\u2705 JSON copied")):u("\u26A0\uFE0F No data available")}function fr(){let{mode:e,data:t}=Dt();if(e==="empty"||!t||t.length===0){u("\u26A0\uFE0F Nothing to export");return}let a="";if(e==="single")a=_()[0]+`
`+t.map(Nt).join(`
`);else{let i=_();a=i.map(Nt).join(",")+`
`,t.forEach(c=>{let p=i.map(m=>{let l=c[m];return l==null?"":typeof l=="object"?JSON.stringify(l):String(l)});a+=p.map(Nt).join(",")+`
`})}let o=new Blob(["\uFEFF"+a],{type:"text/csv;charset=utf-8;"}),r=document.createElement("a"),n=URL.createObjectURL(o);r.href=n,r.download=`qa-export-${Date.now()}.csv`,r.hidden=!0,document.body.appendChild(r),r.click(),document.body.removeChild(r),u("\u2705 CSV exported")}function Nt(e){if(e==null)return'""';let t=String(e);return t.includes(",")||t.includes('"')||t.includes(`
`)||t.includes("\r")?'"'+t.replace(/"/g,'""')+'"':t}function Da(){let e=document.getElementById("qa-col-modal");e&&(e.style.display="",e.classList.add("qa-modal-visible"),Ee.applyLayout(),Ee.focus(),Z())}function Ha(e=!1){let t=document.getElementById("qa-col-modal");t&&t.classList.remove("qa-modal-visible")}function $a(){return!!document.getElementById("qa-col-modal")}window.addEventListener("qaPayloadUpdated",()=>{($a()||document.getElementById("qa-load-all"))&&Z()});ce();R();te();we();se();var mr="qa-compare-modal",Le=new M({id:"qa-compare-modal",layoutId:mr,minWidth:520,minHeight:320,baseWidth:860});function br(){if(document.getElementById("qa-compare-modal"))return;let e=document.createElement("div");e.id="qa-compare-modal",e.className="card",e.innerHTML='<div class="hd" id="qa-compare-drag"><span class="title">Column Filter</span> <span class="grow"></span><div class="qa-window-controls"><button type="button" class="qa-window-btn qa-window-btn--close" id="qa-compare-close" title="Close" aria-label="Close" data-icon="\xD7"></button> <button type="button" class="qa-window-btn qa-window-btn--reset" id="qa-compare-reset" title="Reset layout" aria-label="Reset layout" data-icon="\u21BA"></button> <button type="button" class="qa-window-btn qa-window-btn--collapse" id="qa-compare-collapse" title="Collapse" aria-label="Collapse" data-icon="\u2013"></button></div></div><div class="tools"><div class="section"><div class="section-title"><i class="fa fa-search"></i> Filtering</div><div class="filter-row"><label><span><i class="fa fa-search"></i> Substring search</span> <input id="qa-compare-filter" placeholder="Type to filter..."></label></div></div><div class="section"><div class="section-title">\u{1F4CB} How to use</div><div class="info-box">1. Open the needed column filter in the table (click the button <i class="fa fa-filter" style="color:#656c71"></i>)<br>2. Wait until dropdown data loads<br>3. Close the dropdown (the request will be intercepted automatically)<br>4. Click "Load full table data" below</div></div><div class="section"><div class="section-title">\u{1F3AF} Interception status</div><div id="qa-compare-column-info" class="status-box">Waiting for dropdown selection\u2026</div></div><div class="section"><div class="section-title">\u26A1 Actions</div><div class="actions-row"><button class="btn btn-primary" id="qa-compare-load-all" disabled>Load full table data</button> <button class="btn" id="qa-compare-export-csv" disabled><i class="fa fa-save"></i> Export CSV</button> <label class="diff-toggle"><input type="checkbox" id="qa-compare-only-diff" class="hidden-input"> <i class="fa fa-toggle-off" id="qa-compare-toggle-icon"></i> <span>Only differences</span></label> <span class="stat" id="qa-compare-stat"></span></div></div></div><div class="body"></div>',document.body.appendChild(e),document.getElementById("qa-compare-close")?.addEventListener("click",()=>Qa()),document.getElementById("qa-compare-reset")?.addEventListener("click",()=>{Le.resetLayout(),D()}),document.getElementById("qa-compare-collapse")?.addEventListener("click",()=>{document.getElementById("qa-compare-modal")&&(Le.saveCurrentLayout(),I("qa-compare-modal","Column Filter",()=>{C("qa-compare-modal"),Za(),D()}),Qa(!0))}),document.getElementById("qa-compare-load-all")?.addEventListener("click",gr),document.getElementById("qa-compare-export-csv")?.addEventListener("click",hr);let t=document.getElementById("qa-compare-filter");t&&t.addEventListener("input",i=>{s.compareFilterText=(i.target?.value??"").trim(),Te()});let a=document.getElementById("qa-compare-only-diff"),o=document.getElementById("qa-compare-toggle-icon");document.querySelector(".diff-toggle")?.addEventListener("click",i=>{i.preventDefault(),a instanceof HTMLInputElement&&(a.checked=!a.checked,s.compareShowOnlyDiff=!!a.checked,o&&(o.className=a.checked?"fa fa-toggle-on":"fa fa-toggle-off"),Te())});let n=document.getElementById("qa-compare-modal");Le.attach(n,{dragHandle:"qa-compare-drag"})}function Ga(){br(),C("qa-compare-modal");try{typeof window.columnsFilter<"u"&&window.columnsFilter&&(s.columnsFilterConfig=window.columnsFilter)}catch(o){console.error("[QA Helper] Error getting columnsFilter config:",o)}let e=document.getElementById("qa-compare-column"),t=s.lastDropdownRequest?.search_column||s.compareSelectedColumn||"";if(e){e.innerHTML='<option value="">-- select column --</option>';let o=Array.isArray(s.lastPayload?.data)?s.lastPayload.data:[],r=o.length?Object.keys(o[0]):[];r.length===0?e.innerHTML='<option value="">-- no table data --</option>':[...r].sort((i,c)=>i.localeCompare(c,"en",{sensitivity:"base"})).forEach(i=>{let c=document.createElement("option");c.value=i,c.textContent=i,e.appendChild(c)}),e.removeEventListener("change",Ja),e.addEventListener("change",Ja),t&&(e.value=t)}s.compareTableData=[],s.compareDropdownData=[],s.compareSelectedColumn=t,s.compareShowOnlyDiff=!1;let a=document.getElementById("qa-compare-only-diff");a instanceof HTMLInputElement&&(a.checked=!1),Te(),D(),Za()}function Va(e){let t=new URLSearchParams(e);if(!(t.has("dropdown_search")||t.has("dropdown_search[0][column]")))return;s.lastDropdownRequest={url:s.lastRequestInfo?.url||window.location.href,requestData:e};let o=t.get("search_column");if(o){s.lastDropdownRequest.search_column=o,s.compareSelectedColumn=o;let r=document.getElementById("qa-compare-column");r&&(r.value=o)}console.log("[QA Helper] Dropdown request intercepted for column:",o),D()}function D(){let e=document.getElementById("qa-compare-column-info"),t=document.getElementById("qa-compare-load-all");if(!e||!t)return;let a="Load full table data",o=ot(s.lastPayload);t.textContent=o!=null?`${a} (${o})`:a;let r=o!=null&&o>5e3;r?t.title=Oe:t.removeAttribute("title");let n=!!s.lastDropdownRequest,i=!!(s.lastRequestInfo&&s.lastPayload);if(n&&i){let c=s.lastDropdownRequest.search_column||"unknown";e.classList.remove("is-waiting"),e.classList.add("is-ready"),e.innerHTML=`\u2705 Intercepted dropdown column: <code>${$t(c)}</code>`,t.disabled=r}else e.classList.remove("is-ready"),e.classList.add("is-waiting"),n?i?e.textContent="Waiting for intercepted data\u2026":e.textContent="Waiting for table response\u2026":e.textContent="Waiting for dropdown selection\u2026",t.disabled=!0}function Ja(){let e=document.getElementById("qa-compare-column");s.compareSelectedColumn=e?e.value:"",s.compareTableData=[],s.compareDropdownData=[],s.compareShowOnlyDiff=!1;let t=document.getElementById("qa-compare-only-diff");t instanceof HTMLInputElement&&(t.checked=!1),Te()}async function gr(){if(!s.lastDropdownRequest){u("\u26A0\uFE0F Open the dropdown filter in the table first");return}if(!s.lastRequestInfo){u("\u26A0\uFE0F Missing table request info");return}let e=s.compareSelectedColumn||s.lastDropdownRequest.search_column||"";if(!e){u("\u26A0\uFE0F Unable to determine column for comparison");return}s.compareSelectedColumn=e,s.compareFilterText="";let t=document.getElementById("qa-compare-filter");t&&(t.value="");let a=document.getElementById("qa-compare-modal");if(!a)return;let o=document.getElementById("qa-compare-column");o&&o.value!==e&&(o.value=e);try{typeof window.columnsFilter<"u"&&window.columnsFilter&&(s.columnsFilterConfig=window.columnsFilter)}catch(n){console.error("[QA Helper] Error getting columnsFilter config:",n)}let r=at(a);try{r?.setProgress("Step 1/2: Loading table data...");let{rows:n}=await rt(s.lastRequestInfo,{columnName:e,onProgress:({loaded:g,totalRows:x})=>{r?.setProgress(`Step 1/2: Table ${g} / ${x}`)}}),i=Ua(s.compareSelectedColumn),c=Wa(xr(s.compareSelectedColumn,i,n));c.sort((g,x)=>x.label.localeCompare(g.label,"en",{sensitivity:"base",numeric:!0})),s.compareTableData=c,r?.setProgress("Step 2/2: Loading dropdown data...");try{typeof window.columnsFilter<"u"&&window.columnsFilter&&(s.columnsFilterConfig=window.columnsFilter)}catch{console.warn("[QA Helper] columnsFilter config not found")}let p=s.lastDropdownRequest.url,m=s.lastDropdownRequest.requestData;i=Ua(s.compareSelectedColumn);let l=200,d=[],f=0,b=!0;for(;b;){let g=m;g=g.replace(/([&?])start=\d+/,`$1start=${f}`),g=g.replace(/([&?])length=\d+/,`$1length=${l}`);let w=(await $.ajax({url:p,method:"POST",data:g,contentType:"application/x-www-form-urlencoded; charset=UTF-8",dataType:"json",headers:{"X-Requested-With":"XMLHttpRequest"}})).data||[];if(w.length===0)break;let S=yr(s.compareSelectedColumn,i,w);d=[...d,...S],f+=w.length,b=w.length===l,r?.setProgress(`Step 2/2: Dropdown ${d.length} / ?`),await new Promise(v=>setTimeout(v,100))}let h=Wa(d.map(g=>({key:g.value||g.label,label:g.label||g.value||""})));h.sort((g,x)=>x.label.localeCompare(g.label,"en",{sensitivity:"base",numeric:!0})),s.compareDropdownData=h,Te(),u(`\u2705 Loaded: table ${s.compareTableData.length}, dropdown ${s.compareDropdownData.length}`)}catch(n){console.error("[QA Helper] Compare load error:",n),u(`\u274C Error: ${n.message}`)}finally{r?.remove()}}function Te(){let e=document.querySelector("#qa-compare-modal .body"),t=document.getElementById("qa-compare-stat"),a=document.getElementById("qa-compare-export-csv");if(!e||!t)return;if(!s.compareSelectedColumn){a&&(a.disabled=!0,a.classList.add("disabled")),e.innerHTML='<pre class="list">Select a column to compare</pre>',t.textContent="";return}if(s.compareTableData.length===0&&s.compareDropdownData.length===0){a&&(a.disabled=!0,a.classList.add("disabled")),e.innerHTML='<pre class="list">Click "Load full table data" to fetch records</pre>',t.textContent="";return}let o=Xa();if(a){let i=o.length>0;a.disabled=!i,a.classList.toggle("disabled",!i)}let r=s.compareShowOnlyDiff?o.filter(i=>nt(i.tableLabel)!==nt(i.dropdownLabel)):o;if(s.compareFilterText){let i=s.compareFilterText.toLowerCase();r=r.filter(c=>c.tableLabel.toLowerCase().includes(i)||c.dropdownLabel.toLowerCase().includes(i))}if(r.length===0){let i=s.compareFilterText?"No results for this filter":s.compareShowOnlyDiff?"All values match \u{1F389}":"No data to display";e.innerHTML=`<pre class="list">${i}</pre>`,t.textContent=`\u{1F4CA} ${s.compareTableData.length} | \u{1F53D} ${s.compareDropdownData.length}`;return}let n='<table class="data-table compare-table"><thead><tr>';n+=`<th>\u{1F4CA} Table (${s.compareTableData.length})</th>`,n+=`<th>\u{1F53D} Dropdown (${s.compareDropdownData.length})</th>`,n+="</tr></thead><tbody>";for(let i of r)n+="<tr>",n+=i.tableLabel===""?'<td class="null-value">\u2014</td>':`<td>${$t(i.tableLabel)}</td>`,n+=i.dropdownLabel===""?'<td class="null-value">\u2014</td>':`<td>${$t(i.dropdownLabel)}</td>`,n+="</tr>";n+="</tbody></table>",e.innerHTML=n,t.textContent=`\u{1F4CA} ${s.compareTableData.length} | \u{1F53D} ${s.compareDropdownData.length}`}function Xa(){let e=new Map(s.compareTableData.map(o=>[o.key,o.label])),t=new Map(s.compareDropdownData.map(o=>[o.key,o.label]));return Array.from(new Set([...e.keys(),...t.keys()])).map(o=>{let r=e.get(o)||"",n=t.get(o)||"";return{key:o,tableLabel:r,dropdownLabel:n,sortLabel:r||n||o}}).sort((o,r)=>r.sortLabel.localeCompare(o.sortLabel,"en",{sensitivity:"base",numeric:!0}))}function hr(){if(!s.compareSelectedColumn){u("\u26A0\uFE0F Select a column first");return}let e=Xa();if(e.length===0){u("\u26A0\uFE0F Nothing to export");return}let t=s.compareShowOnlyDiff?e.filter(i=>nt(i.tableLabel)!==nt(i.dropdownLabel)):e;if(s.compareFilterText){let i=s.compareFilterText.toLowerCase();t=t.filter(c=>c.tableLabel.toLowerCase().includes(i)||c.dropdownLabel.toLowerCase().includes(i))}if(t.length===0){u("\u26A0\uFE0F Nothing to export");return}let a=["Table","Dropdown"].map(Ya).join(",")+`
`;t.forEach(i=>{let c=[i.tableLabel||"",i.dropdownLabel||""];a+=c.map(Ya).join(",")+`
`});let o=new Blob(["\uFEFF"+a],{type:"text/csv;charset=utf-8;"}),r=document.createElement("a"),n=URL.createObjectURL(o);r.href=n,r.download=`qa-compare-${s.compareSelectedColumn}-${Date.now()}.csv`,r.hidden=!0,document.body.appendChild(r),r.click(),document.body.removeChild(r),setTimeout(()=>URL.revokeObjectURL(n),1e3),u("\u2705 CSV exported")}function Ya(e){if(e==null)return'""';let t=String(e);return t.includes(",")||t.includes('"')||t.includes(`
`)||t.includes("\r")?'"'+t.replace(/"/g,'""')+'"':t}function xr(e,t,a){let o=t||{idField:e,textField:e};return a.map(r=>{let n=o.textField?ee(r,o.textField):ee(r,e),i=Ka(n==null?"":String(n)),c=o.idField?ee(r,o.idField):ee(r,e),p=c==null?"":String(c);if(p==="0"&&!i)return null;let m=o.idField&&o.textField&&o.idField!==o.textField&&p;if(p){let b=m?`(${p}) ${i||p}`:i||p;return{key:p,label:b}}let l=ee(r,e),d=l==null||typeof l=="object"?"":String(l),f=d||i;return f?{key:f,label:i||d}:null}).filter(Boolean)}function Wa(e){let t=new Map;for(let a of e){if(!a)continue;let o=a.key??a.label??"",r=a.label??"",n=String(o).trim(),i=String(r).trim(),c=n||i;c&&(t.has(c)||t.set(c,{key:c,label:i||c}))}return Array.from(t.values())}function nt(e){return String(e??"").trim()}function Ua(e){if(!s.columnsFilterConfig||!s.columnsFilterConfig.idNameColumns)return{idField:e,textField:e,keyForPayload:e};let t=s.columnsFilterConfig.idNameColumns;if(t[e]){let a=String(t[e]),o=e;if(a.indexOf(".")!==-1&&e.indexOf(".")===-1){let n=a.split(".").slice(0,-1).join(".");o=n?n+".id":e}let r=e.replace(/\.id$/,"");return{idField:o,textField:a,keyForPayload:r}}return{idField:e,textField:e,keyForPayload:e}}function yr(e,t,a){let o=t||{idField:e,textField:e};return a.map(r=>{let n=o.textField?ee(r,o.textField):r[e]==null?"":r[e],i=Ka(n==null?"":String(n)),c=o.idField?ee(r,o.idField):r[e]==null?"":r[e],p=String(c??"");if(p==="0")return{value:"0",label:"Empty",_serverEmpty:!0};let m=o.idField!==o.textField&&p;if(p)return{value:p,label:m?`(${p}) ${i}`:i};let l=r[e],d=l==null||typeof l=="object"?"":String(l);return d===""?{value:"0",label:"Empty",_serverEmpty:!0}:{value:d,label:i}}).filter(r=>!r._serverEmpty)}function ee(e,t){return t?t.split(".").reduce((a,o)=>{if(a==null)return null;if(Array.isArray(a)){let r=Number(o);return Number.isNaN(r)?a[0]?.[o]:a[r]}return a?.[o]},e):null}function Ka(e){if(e==null)return"";let t=document.createElement("div");return t.innerHTML=e,t.textContent||t.innerText||""}function $t(e){return String(e).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;")}function Za(){let e=document.getElementById("qa-compare-modal");e&&(e.style.display="",e.classList.add("qa-modal-visible"),Le.applyLayout(),Le.focus(),D())}function Qa(e=!1){let t=document.getElementById("qa-compare-modal");t&&t.classList.remove("qa-modal-visible")}window.addEventListener("qaPayloadUpdated",()=>{D()});Lt();Bt();function eo(){let e=function(){let a=/\/admin_panel\/reports\/(aggregated|smartlink)(\/|$)/i;function o(l){return typeof l=="string"?l:l&&typeof l=="object"&&typeof l.url=="string"?l.url:""}function r(l){if(!l)return"GET";try{return String(l).toUpperCase()}catch(d){return console.warn("[QA Helper] Failed to normalize method",d),"GET"}}function n(l){if(!l)return"";if(typeof l=="string")return l;if(typeof URLSearchParams<"u"&&l instanceof URLSearchParams)return l.toString();if(typeof FormData<"u"&&l instanceof FormData){let d=new URLSearchParams;return l.forEach((f,b)=>{let h="";if(typeof f=="string")h=f;else try{h=String(f)}catch(g){console.warn("[QA Helper] Failed to stringify FormData value",g),h=""}d.append(b,h)}),d.toString()}try{return String(l)}catch(d){console.warn("[QA Helper] Failed to normalize request body",d)}return""}function i(l,d){try{let f=typeof l=="string"?l:"";return d&&d.toUpperCase()==="POST"&&a.test(f)}catch{return!1}}let c=window.fetch;window.fetch=async function(l,d){let f=r(d&&d.method||typeof l=="object"&&l&&l.method||"GET"),b=o(l),h=i(b,f),g="";h&&d&&d.body&&(g=n(d.body));let x=await c.apply(this,arguments);if(h)try{let w=x.clone();if((w.headers.get("content-type")||"").includes("application/json")){let v=await w.json(),J=typeof l=="string"?l:l&&l.url||"";window.dispatchEvent(new CustomEvent("qaReportResponse",{detail:{url:J,method:f,payload:v,requestData:g}}))}}catch(w){console.error("[QA Helper] fetch intercept error",w)}return x};let p=window.XMLHttpRequest;function m(){let l=new p,d=l.open,f=l.send,b="GET",h="",g="";return l.open=function(x,w){return b=r(x||"GET"),h=w||"",d.apply(l,arguments)},l.send=function(x){return g=n(x),f.apply(l,arguments)},l.addEventListener("loadend",function(){if(i(h,b))try{if((l.getResponseHeader("content-type")||"").includes("application/json")){let w=JSON.parse(l.responseText);window.dispatchEvent(new CustomEvent("qaReportResponse",{detail:{url:h,method:b,payload:w,requestData:g}}))}}catch(x){console.error("[QA Helper] XHR intercept error",x)}}),l}window.XMLHttpRequest=m},t=document.createElement("script");t.textContent=`(${e.toString()})();`,document.documentElement.appendChild(t),t.remove()}xt();GM_addStyle(Wt);Ut();Ba({onOpenColumns:Na,onOpenCompare:Ga,onOpenFilters:Et,onOpenCustomize:At});eo();window.addEventListener("qaReportResponse",e=>{let{url:t,method:a,payload:o,requestData:r}=e.detail||{},n=typeof r=="string"?r:"";if(n.includes("dropdown_search")){Va(n);return}if(s.lastPayload=o||null,n&&t&&(s.lastRequestInfo={url:t,method:a,requestData:n},ua(s.lastRequestInfo)),Re(s.lastPayload),t&&a){let i=t.split("?")[0];u(`${a} ${i}`.slice(-60))}o&&typeof o=="object"&&(tt(o),_a(),zt(),Ft(),D())});})();
